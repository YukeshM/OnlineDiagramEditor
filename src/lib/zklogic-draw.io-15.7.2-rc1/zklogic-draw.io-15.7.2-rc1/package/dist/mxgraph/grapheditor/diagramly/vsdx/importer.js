var com,__extends=this&&this.__extends||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);function r(){this.constructor=t}t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)};!function(t){var e,n,r;e=t.mxgraph||(t.mxgraph={}),n=e.io||(e.io={}),r=function(){function e(t){this.RESPONSE_END="</mxfile>",this.RESPONSE_DIAGRAM_START="",this.RESPONSE_DIAGRAM_END="</diagram>",this.RESPONSE_HEADER='<?xml version="1.0" encoding="UTF-8"?><mxfile>',this.vertexMap={},this.edgeShapeMap={},this.vertexShapeMap={},this.parentsMap={},this.layersMap={},this.debugPaths=!1,this.vsdxModel=null,this.editorUi=t,this.shapeIndexShift=0}return e.vsdxPlaceholder_$LI$=function(){if(null==e.vsdxPlaceholder){var t="dmlzaW8=";e.vsdxPlaceholder=window.atob?atob(t):Base64.decode(t,!0)}return e.vsdxPlaceholder},e.parsererrorNS_$LI$=function(){return e.parsererrorNS=mxConstants.NS_XHTML,e.parsererrorNS},e.parseXml=function(t){try{var n=mxUtils.parseXml(t);return n.getElementsByTagNameNS(e.parsererrorNS,"parsererror").length>0?null:n}catch(t){return null}},e.decodeUTF16LE=function(t){for(var e="",n=0;n<t.length;n+=2)e+=String.fromCharCode(t.charCodeAt(n)|t.charCodeAt(n+1)<<8);return e},e.prototype.scaleGraph=function(t,e){if(1!==e){var n=t.getModel();for(var r in n.cells){var i=n.cells[r],s=n.getGeometry(i);if(null!=s&&(this.scaleRect(s,e),this.scaleRect(s.alternateBounds,e),n.isEdge(i))){this.scalePoint(s.sourcePoint,e),this.scalePoint(s.targetPoint,e),this.scalePoint(s.offset,e);var a=s.points;if(null!=a)for(var o=0;o<a.length;o++){var l=a[o];this.scalePoint(l,e)}}}}},e.incorrectXMLReqExp=[{regExp:/\&(?!amp;|lt;|gt;|quot;|#)/g,repl:"&amp;"}],e.prototype.decodeVsdx=function(n,r,i,s){var a=this,o={},l={},u=(new Date,0),h=0,g=function(){if(h==u){new Date;try{!function(){for(var n,i,s=e.vsdxPlaceholder+"/document.xml",u=(n=o)[i=s]?n[i]:null,h=u.firstChild;null!=h&&1!=h.nodeType;)h=h.nextSibling;if(null==h||1!=h.nodeType)return null;a.importNodes(u,h,s,o),a.vsdxModel=new t.mxgraph.io.vsdx.mxVsdxModel(u,o,l);var g=a.vsdxModel.getPages(),c={str:a.RESPONSE_HEADER,toString:function(){return this.str}},x=function(t){return null==t.entries&&(t.entries=[]),t.entries}(g),m=function(t,e){var n=x[t].getValue(),r=p.createMxGraph();r.getModel().beginUpdate(),p.importPage(n,r,r.getDefaultParent(),!0),p.scaleGraph(r,n.getPageScale()/n.getDrawingScale()),r.getModel().endUpdate(),p.postImportPage(n,r,(function(){var i;p.sanitiseGraph(r),(i=c).str=i.str.concat(a.RESPONSE_DIAGRAM_START),function(t){t.str=t.str.concat(a.processPage(r,n))}(c),function(t){t.str=t.str.concat(a.RESPONSE_DIAGRAM_END)}(c),t<x.length-1?m(t+1,e):e()}))},p=a;function d(){var t;(t=c).str=t.str.concat(a.RESPONSE_END),new Date,r&&r(c.str)}x.length>0?m(0,d):d()}()}catch(t){console.log(t),null!=s?s(t):r("")}}};JSZip.loadAsync(n).then((function(t){0==Object.keys(t.files).length?null!=s&&s():(new Date,t.forEach((function(t,n){var r,i,s,c,x=n.name,m=x.toLowerCase(),p=m.length;if(m.indexOf(".xml")==p-4||m.indexOf(".rels")==p-5)u++,n.async("string").then((function(t){if(0!==t.length){65279==t.charCodeAt(0)&&(t=t.substring(1));var n=e.parseXml(t);if(null==n)if(0===t.charCodeAt(1)&&0===t.charCodeAt(3)&&0===t.charCodeAt(5))n=e.parseXml(e.decodeUTF16LE(t));else{for(var r=0;r<e.incorrectXMLReqExp.length;r++)e.incorrectXMLReqExp[r].regExp.test(t)&&(t=t.replace(e.incorrectXMLReqExp[r].regExp,e.incorrectXMLReqExp[r].repl));n=e.parseXml(t)}null!=n&&(n.vsdxFileName=x,o[x]=n)}h++,g()}));else if(0===m.indexOf(e.vsdxPlaceholder+"/media"))if(u++,i=".emf",s=(r=m).length-i.length,-1!==(c=r.indexOf(i,s))&&c===s){var d=function(){h++,g()};JSZip.support.blob&&window.EMF_CONVERT_URL?n.async("blob").then((function(t){var e=new FormData;e.append("img",t,m),e.append("inputformat","emf"),e.append("outputformat","png");var n=new XMLHttpRequest;n.open("POST",EMF_CONVERT_URL),n.responseType="blob",a.editorUi.addRemoteServiceSecurityCheck(n),n.onreadystatechange=mxUtils.bind(this,(function(){if(4==n.readyState)if(n.status>=200&&n.status<=299)try{var t=new FileReader;t.readAsDataURL(n.response),t.onloadend=function(){var e=t.result.indexOf(",")+1;l[x]=t.result.substr(e),d()}}catch(t){console.log(t),d()}else d()})),n.send(e)})):d()}else!function(t,e){var n=t.length-e.length,r=t.indexOf(e,n);return-1!==r&&r===n}(m,".bmp")?n.async("base64").then((function(t){l[x]=t,h++,g()})):JSZip.support.uint8array&&n.async("uint8array").then((function(t){var e=new BmpDecoder(t),n=document.createElement("canvas");n.width=e.width,n.height=e.height,n.getContext("2d").putImageData(e.imageData,0,0);var r=n.toDataURL("image/jpeg");l[x]=r.substr(23),h++,g()}))})))}),(function(t){null!=s&&s(t)}))},e.prototype.createMxGraph=function(){var t=new Graph;return t.setExtendParents(!1),t.setExtendParentsOnAdd(!1),t.setConstrainChildren(!1),t.setHtmlLabels(!0),t.getModel().maintainEdgeParent=!1,t},e.prototype.processPage=function(t,e){var n=(new mxCodec).encode(t.getModel());n.setAttribute("style","default-style2");var r=mxUtils.getXml(n),i="";return null!=e&&(i+='<diagram name="'+mxUtils.htmlEntities(e.getPageName())+(e.isBackground()?" (Background)":"")+'" id="'+mxUtils.htmlEntities(e.getPageNameU()).replace(/\s/g,"_")+'">'),i+Graph.compress(r)},e.prototype.scalePoint=function(t,e){return null!=t&&(t.x=t.x*e,t.y=t.y*e),t},e.prototype.scaleRect=function(t,e){return null!=t&&(t.x=t.x*e,t.y=t.y*e,t.height=t.height*e,t.width=t.width*e),t},e.prototype.importNodes=function(t,e,n,r){var i=n.lastIndexOf("/"),s=n;if(-1!==i){var a,o,l=(a=r)[o=(s=n.substring(0,i))+"/_rels/"+n.substring(i+1,n.length)+".rels"]?a[o]:null;if(null!=l){for(var u=l.getElementsByTagName("Relationship"),h={},g=0;g<u.length;g++){var c=u.item(g),x=c.getAttribute("Id"),m=c.getAttribute("Target");h[x]=m}var p=e.getElementsByTagName("Rel");for(g=0;g<p.length;g++){var d=p.item(g),v=function(t,e){return t[e]?t[e]:null}(h,d.getAttribute("r:id"));if(null!=(m=s+"/"+v)){var y=function(t,e){return t[e]?t[e]:null}(r,m);if(null!=y){for(var f=d.parentNode,_=y.firstChild;null!=_&&1!=_.nodeType;)_=_.nextSibling;if(null!=_&&1==_.nodeType)for(var S=_.firstChild;null!=S;){if(null!=S&&1==S.nodeType){var C=f.appendChild(t.importNode(S,!0)),I=m;this.importNodes(t,C,I,r)}S=S.nextSibling}}}}}}},e.prototype.importPage=function(t,e,n,r){var i=t.getBackPage();if(null!=i){e.getModel().setValue(e.getDefaultParent(),t.getPageName());var s=new mxCell(i.getPageName());e.addCell(s,e.getModel().getRoot(),0,null,null),this.importPage(i,e,e.getDefaultParent())}var a=t.getLayers();this.layersMap[0]=e.getDefaultParent();var o={},l=0,u=null,h=t.getShapes();try{for(var g=0;null!=h.entries&&g<h.entries.length;g++)null!=(c=h.entries[g].getValue().layerMember)&&(null==u?(o[c]=l,u=c):u!=c&&null==o[c]&&(l++,o[c]=l,u=c))}catch(t){console.log("VSDX Import: Failed to detect layers order")}for(g=0;g<a.length;g++){var c=a[g],x=null!=o[g]?o[g]:g;if(0==x)var m=e.getDefaultParent();else m=new mxCell,e.addCell(m,e.model.root,x);m.setVisible(1==c.Visible),1==c.Lock&&m.setStyle("locked=1;"),m.setValue(c.Name),this.layersMap[g]=m}for(var p,d,v,y=(null==(v=h).entries&&(v.entries=[]),p=v.entries,d=0,{next:function(){return d<p.length?p[d++]:null},hasNext:function(){return d<p.length}}),f=t.getPageDimensions().y,_=t.getId();y.hasNext();){var S=(L=y.next()).getValue(),C=this.layersMap[S.layerMember];this.addShape(e,S,C||n,_,f)}for(var I=function(t){var e=0;return{next:function(){return e<t.length?t[e++]:null},hasNext:function(){return e<t.length}}}(function(t){return null==t.entries&&(t.entries=[]),t.entries}(t.getConnects()));I.hasNext();){var L=I.next(),A=this.addConnectedEdge(e,L.getValue(),_,f);null!=A&&function(t,e){null==t.entries&&(t.entries=[]);for(var n=0;n<t.entries.length;n++)if(null!=t.entries[n].key.equals&&t.entries[n].key.equals(e)||t.entries[n].key===e)return t.entries.splice(n,1)[0]}(this.edgeShapeMap,A)}for(var E=function(t){var e=0;return{next:function(){return e<t.length?t[e++]:null},hasNext:function(){return e<t.length}}}(function(t){return null==t.entries&&(t.entries=[]),t.entries}(this.edgeShapeMap));E.hasNext();){var M=E.next();M.getKey().getPageNumber()===_&&this.addUnconnectedEdge(e,function(t,e){null==t.entries&&(t.entries=[]);for(var n=0;n<t.entries.length;n++)if(null!=t.entries[n].key.equals&&t.entries[n].key.equals(e)||t.entries[n].key===e)return t.entries[n].value;return null}(this.parentsMap,M.getKey()),M.getValue(),f)}return r||this.sanitiseGraph(e),f},e.prototype.postImportPage=function(e,n,r){try{for(var i=this,s=[],a=e.getShapes().entries||[],o=0;o<a.length;o++){var l=a[o].value||{};l.toBeCroppedImg&&s.push(l)}s.length>0?function n(r,a){function o(){r<s.length-1?n(r+1,a):a()}var l=s[r],u=l.toBeCroppedImg,h=function(t,e){null==t.entries&&(t.entries=[]);for(var n=0;n<t.entries.length;n++)if(null!=t.entries[n].key.equals&&t.entries[n].key.equals(e)||t.entries[n].key===e)return t.entries[n].value;return null}(i.vertexMap,new t.mxgraph.io.vsdx.ShapePageId(e.Id,l.Id)),g=new Image;g.onload=function(){var t=u.iData,e=u.iType;try{var n=g.width/u.imgWidth,r=g.height/u.imgHeight,i=-u.imgOffsetX*n,s=(u.imgHeight-u.height+u.imgOffsetY)*r,a=document.createElement("canvas");a.width=u.width*n,a.height=u.height*r;var l=a.getContext("2d");l.fillStyle="#FFFFFF",l.fillRect(0,0,a.width,a.height),l.drawImage(g,i,s,a.width,a.height,0,0,a.width,a.height),t=a.toDataURL("image/jpeg").substr(23),e="jpg"}catch(t){console.log(t)}h.style+=";image=data:image/"+e+","+t,o()},g.src="data:image/"+u.iType+";base64,"+u.iData,g.onerror=function(){h.style+=";image=data:image/"+u.iType+","+u.iData,o()}}(0,r):r()}catch(t){console.log(t),r()}},e.prototype.addShape=function(e,n,r,i,s){n.parentHeight=s;var a,o,l=t.mxgraph.io.vsdx.VsdxShape.getType(n.getShape());if(null!=l&&(a=l,o=t.mxgraph.io.vsdx.mxVsdxConstants.TYPE_SHAPE,(a&&a.equals?a.equals(o):a===o)||function(t,e){return t&&t.equals?t.equals(e):t===e}(l,t.mxgraph.io.vsdx.mxVsdxConstants.TYPE_GROUP)||function(t,e){return t&&t.equals?t.equals(e):t===e}(l,t.mxgraph.io.vsdx.mxVsdxConstants.FOREIGN))){var u=n.getId();if(n.isVertex()){var h;h=n.isGroup()?this.addGroup(e,n,r,i,s):this.addVertex(e,n,r,i,s),function(t,e,n){null==t.entries&&(t.entries=[]);for(var r=0;r<t.entries.length;r++)if(null!=t.entries[r].key.equals&&t.entries[r].key.equals(e)||t.entries[r].key===e)return void(t.entries[r].value=n);t.entries.push({key:e,value:n,getKey:function(){return this.key},getValue:function(){return this.value}})}(this.vertexShapeMap,new t.mxgraph.io.vsdx.ShapePageId(i,u),n);var g=n.getHyperlink();g.extLink?e.setLinkForCell(h,g.extLink):g.pageLink&&e.setLinkForCell(h,"data:page/id,"+g.pageLink.replace(/\s/g,"_"));for(var c=n.getProperties(),x=0;x<c.length;x++)try{e.setAttributeForCell(h,c[x].key,c[x].val)}catch(t){console.log('Attribute: "',c[x].key,'" with value "',c[x].val,'" not allowed in HTML')}return h}n.setShapeIndex(e.getModel().getChildCount(r)),function(t,e,n){null==t.entries&&(t.entries=[]);for(var r=0;r<t.entries.length;r++)if(null!=t.entries[r].key.equals&&t.entries[r].key.equals(e)||t.entries[r].key===e)return void(t.entries[r].value=n);t.entries.push({key:e,value:n,getKey:function(){return this.key},getValue:function(){return this.value}})}(this.edgeShapeMap,new t.mxgraph.io.vsdx.ShapePageId(i,u),n),function(t,e,n){null==t.entries&&(t.entries=[]);for(var r=0;r<t.entries.length;r++)if(null!=t.entries[r].key.equals&&t.entries[r].key.equals(e)||t.entries[r].key===e)return void(t.entries[r].value=n);t.entries.push({key:e,value:n,getKey:function(){return this.key},getValue:function(){return this.value}})}(this.parentsMap,new t.mxgraph.io.vsdx.ShapePageId(i,u),r)}return null},e.prototype.addGroup=function(e,n,r,i,s){var a=n.getDimensions(),o=n.getMaster(),l=n.getStyleFromShape(),u=n.getGeomList();u.isNoFill()&&(l[mxConstants.STYLE_FILLCOLOR]="none",l[mxConstants.STYLE_GRADIENTCOLOR]="none"),u.isNoLine()&&(l[mxConstants.STYLE_STROKECOLOR]="none"),l.html="1",l[mxConstants.STYLE_WHITE_SPACE]="wrap";var h,g=t.mxgraph.io.vsdx.mxVsdxUtils.getStyleString(l,"="),c=null,x=n.getChildShapes(),m=null!=x&&(null==(h=x).entries&&(h.entries=[]),h.entries.length>0),p=n.isDisplacedLabel()||n.isRotatedLabel()||m,d=n.getOriginPoint(s,!0);if(p)c=e.insertVertex(r,null,null,Math.floor(Math.round(100*d.x)/100),Math.floor(Math.round(100*d.y)/100),Math.floor(Math.round(100*a.x)/100),Math.floor(Math.round(100*a.y)/100),g);else{var v=n.getTextLabel();c=e.insertVertex(r,null,v,Math.floor(Math.round(100*d.x)/100),Math.floor(Math.round(100*d.y)/100),Math.floor(Math.round(100*a.x)/100),Math.floor(Math.round(100*a.y)/100),g)}for(var y,f,_=function(t){var e=0;return{next:function(){return e<t.length?t[e++]:null},hasNext:function(){return e<t.length}}}(function(t){return null==t.entries&&(t.entries=[]),t.entries}(x));_.hasNext();){var S=_.next().getValue(),C=S.getId();if(S.isVertex()){var I=t.mxgraph.io.vsdx.VsdxShape.getType(S.getShape());null!=I&&(y=I,f=t.mxgraph.io.vsdx.mxVsdxConstants.TYPE_SHAPE,(y&&y.equals?y.equals(f):y===f)||function(t,e){return t&&t.equals?t.equals(e):t===e}(I,t.mxgraph.io.vsdx.mxVsdxConstants.TYPE_GROUP)||function(t,e){return t&&t.equals?t.equals(e):t===e}(I,t.mxgraph.io.vsdx.mxVsdxConstants.FOREIGN))&&S.isVertex()&&(S.propagateRotation(n.getRotation()),S.isGroup()?this.addGroup(e,S,c,i,a.y):this.addVertex(e,S,c,i,a.y)),null==o&&function(t,e,n){null==t.entries&&(t.entries=[]);for(var r=0;r<t.entries.length;r++)if(null!=t.entries[r].key.equals&&t.entries[r].key.equals(e)||t.entries[r].key===e)return void(t.entries[r].value=n);t.entries.push({key:e,value:n,getKey:function(){return this.key},getValue:function(){return this.value}})}(this.vertexShapeMap,new t.mxgraph.io.vsdx.ShapePageId(i,C),S)}else null==o?(function(t,e,n){null==t.entries&&(t.entries=[]);for(var r=0;r<t.entries.length;r++)if(null!=t.entries[r].key.equals&&t.entries[r].key.equals(e)||t.entries[r].key===e)return void(t.entries[r].value=n);t.entries.push({key:e,value:n,getKey:function(){return this.key},getValue:function(){return this.value}})}(this.edgeShapeMap,new t.mxgraph.io.vsdx.ShapePageId(i,C),S),function(t,e,n){null==t.entries&&(t.entries=[]);for(var r=0;r<t.entries.length;r++)if(null!=t.entries[r].key.equals&&t.entries[r].key.equals(e)||t.entries[r].key===e)return void(t.entries[r].value=n);t.entries.push({key:e,value:n,getKey:function(){return this.key},getValue:function(){return this.value}})}(this.parentsMap,new t.mxgraph.io.vsdx.ShapePageId(i,C),c)):this.addUnconnectedEdge(e,c,S,s)}p&&n.createLabelSubShape(e,c);var L=n.getRotation();if(0!==L)for(var A=c.getGeometry(),E=A.width/2,M=A.height/2,T=0;T<c.getChildCount();T++){var N=c.getChildAt(T);t.mxgraph.online.Utils.rotatedGeometry(N.getGeometry(),L,E,M)}return function(t,e,n){null==t.entries&&(t.entries=[]);for(var r=0;r<t.entries.length;r++)if(null!=t.entries[r].key.equals&&t.entries[r].key.equals(e)||t.entries[r].key===e)return void(t.entries[r].value=n);t.entries.push({key:e,value:n,getKey:function(){return this.key},getValue:function(){return this.value}})}(this.vertexMap,new t.mxgraph.io.vsdx.ShapePageId(i,n.getId()),c),c},e.rotatedEdgePoint=function(t,e,n,r){e=function(t){return t*Math.PI/180}(e);var i=Math.cos(e),s=Math.sin(e),a=t.x-n,o=t.y-r,l=a*i-o*s,u=o*i+a*s;t.x=Math.round(l+n),t.y=Math.round(u+r)},e.prototype.addVertex=function(e,n,r,i,s){var a="",o=n.isDisplacedLabel()||n.isRotatedLabel();o||(a=n.getTextLabel());var l=n.getDimensions(),u=n.getStyleFromShape();u.html="1";var h=u.hasOwnProperty(mxConstants.STYLE_SHAPE)||u.hasOwnProperty("stencil");u.hasOwnProperty(mxConstants.STYLE_FILLCOLOR)&&h||(u[mxConstants.STYLE_FILLCOLOR]="none"),h||(u[mxConstants.STYLE_STROKECOLOR]="none"),u.hasOwnProperty(mxConstants.STYLE_GRADIENTCOLOR)&&h||(u[mxConstants.STYLE_GRADIENTCOLOR]="none"),u[mxConstants.STYLE_WHITE_SPACE]="wrap";var g=n.getOriginPoint(s,!0);if(h||null!=a){var c,x=t.mxgraph.io.vsdx.mxVsdxUtils.getStyleString(u,"=");return c=o?e.insertVertex(r,null,null,Math.floor(Math.round(100*g.x)/100),Math.floor(Math.round(100*g.y)/100),Math.floor(Math.round(100*l.x)/100),Math.floor(Math.round(100*l.y)/100),x):e.insertVertex(r,null,a,Math.floor(Math.round(100*g.x)/100),Math.floor(Math.round(100*g.y)/100),Math.floor(Math.round(100*l.x)/100),Math.floor(Math.round(100*l.y)/100),x),function(t,e,n){null==t.entries&&(t.entries=[]);for(var r=0;r<t.entries.length;r++)if(null!=t.entries[r].key.equals&&t.entries[r].key.equals(e)||t.entries[r].key===e)return void(t.entries[r].value=n);t.entries.push({key:e,value:n,getKey:function(){return this.key},getValue:function(){return this.value}})}(this.vertexMap,new t.mxgraph.io.vsdx.ShapePageId(i,n.getId()),c),n.setLabelOffset(c,x),o&&n.createLabelSubShape(e,c),c}return null},e.calculateAbsolutePoint=function(t){for(var e=0,n=0;null!=t;){var r=t.geometry;null!=r&&(e+=r.x,n+=r.y),t=t.parent}return new mxPoint(e,n)},e.prototype.processEdgeGeo=function(e,n){try{for(var r=e.geomList.geomList[0].rows,i=0;i<r.length;i++)if(r[i]instanceof t.mxgraph.io.vsdx.geometry.ArcTo){n.style+="jumpStyle=arc;";break}for(i=0;i<r.length;i++)r[i],t.mxgraph.io.vsdx.geometry.NURBSTo}catch(t){}},e.prototype.addConnectedEdge=function(n,r,i,s){var a=r.getFromSheet(),o=new t.mxgraph.io.vsdx.ShapePageId(i,a),l=function(t,e){null==t.entries&&(t.entries=[]);for(var n=0;n<t.entries.length;n++)if(null!=t.entries[n].key.equals&&t.entries[n].key.equals(e)||t.entries[n].key===e)return t.entries[n].value;return null}(this.edgeShapeMap,o);if(null==l)return null;var u=function(t,e){null==t.entries&&(t.entries=[]);for(var n=0;n<t.entries.length;n++)if(null!=t.entries[n].key.equals&&t.entries[n].key.equals(e)||t.entries[n].key===e)return t.entries[n].value;return null}(this.parentsMap,new t.mxgraph.io.vsdx.ShapePageId(i,l.getId())),h=s;if(null!=u){var g=n.getModel().getGeometry(u);null!=g&&(h=g.height)}var c=l.getStartXY(h),x=l.getEndXY(h),m=l.getRoutingPoints(h,c,l.getRotation());this.rotateChildEdge(n.getModel(),u,c,x,m);var p=null,d=r.getSourceToSheet(),v=null!=d?function(t,e){null==t.entries&&(t.entries=[]);for(var n=0;n<t.entries.length;n++)if(null!=t.entries[n].key.equals&&t.entries[n].key.equals(e)||t.entries[n].key===e)return t.entries[n].value;return null}(this.vertexMap,new t.mxgraph.io.vsdx.ShapePageId(i,d)):null,y=!0;if(null==v||0==v.geometry.width||0==v.geometry.height)v=n.insertVertex(u,null,null,Math.floor(Math.round(100*c.x)/100),Math.floor(Math.round(100*c.y)/100),0,0);else if(v.style&&-1==v.style.indexOf(";rotation=")){var f=e.calculateAbsolutePoint(v),_=e.calculateAbsolutePoint(u),S=v.geometry;p=new mxPoint((_.x+c.x-f.x)/S.width,(_.y+c.y-f.y)/S.height)}else y=!1;var C=null,I=r.getTargetToSheet(),L=null!=I?function(t,e){null==t.entries&&(t.entries=[]);for(var n=0;n<t.entries.length;n++)if(null!=t.entries[n].key.equals&&t.entries[n].key.equals(e)||t.entries[n].key===e)return t.entries[n].value;return null}(this.vertexMap,new t.mxgraph.io.vsdx.ShapePageId(i,I)):null,A=!0;if(null==L||0==L.geometry.width||0==L.geometry.height)L=n.insertVertex(u,null,null,Math.floor(Math.round(100*x.x)/100),Math.floor(Math.round(100*x.y)/100),0,0);else if(L.style&&-1==L.style.indexOf(";rotation=")){var E=e.calculateAbsolutePoint(L),M=e.calculateAbsolutePoint(u),T=L.geometry;C=new mxPoint((M.x+x.x-E.x)/T.width,(M.y+x.y-E.y)/T.height)}else A=!1;var N,D=l.getStyleFromEdgeShape(h),$=l.getRotation();if(0!==$){N=n.insertEdge(u,null,null,v,L,t.mxgraph.io.vsdx.mxVsdxUtils.getStyleString(D,"="));var V=l.createLabelSubShape(n,N);if(null!=V){V.setStyle(V.getStyle()+";rotation="+($>60&&$<240?($+180)%360:$));var O=V.getGeometry();O.x=0,O.y=0,O.relative=!0,O.offset=new mxPoint(-O.width/2,-O.height/2)}}else{N=n.insertEdge(u,null,l.getTextLabel(),v,L,t.mxgraph.io.vsdx.mxVsdxUtils.getStyleString(D,"="));var k=l.getLblEdgeOffset(n.getView(),m);N.getGeometry().offset=k,null!=p&&n.setConnectionConstraint(N,v,!0,new mxConnectionConstraint(p,!1)),y&&m.shift(),null!=C&&n.setConnectionConstraint(N,L,!1,new mxConnectionConstraint(C,!1)),A&&m.pop()}var R,b,w=n.getModel().getGeometry(N);if(v.parent!=L.parent&&null!=u&&1!=u.id&&1==v.parent.id){var j=0,P=0,F=u;do{var q=F.geometry;null!=q&&(j+=q.x,P+=q.y),F=F.parent}while(null!=F);N.parent=v.parent;for(var z=0;z<m.length;z++)m[z].x+=j,m[z].y+=P}if(w.points=m,D.hasOwnProperty("curved")&&((R=(b=D).curved?b.curved:null)&&R.equals?R.equals("1"):"1"===R)){w=n.getModel().getGeometry(N);var U=l.getControlPoints(h);w.points=U}return this.processEdgeGeo(l,N),o},e.prototype.addUnconnectedEdge=function(e,n,r,i){var s=i;if(null!=n){var a=e.getModel().getGeometry(n);null!=a&&(s=a.height)}var o,l=r.getStartXY(s),u=r.getEndXY(s),h=r.getStyleFromEdgeShape(s),g=r.getRoutingPoints(s,l,r.getRotation()),c=r.getRotation();if(0!==c){0===r.getShapeIndex()?o=e.insertEdge(n,null,null,null,null,t.mxgraph.io.vsdx.mxVsdxUtils.getStyleString(h,"=")):(o=e.createEdge(n,null,null,null,null,t.mxgraph.io.vsdx.mxVsdxUtils.getStyleString(h,"=")),o=e.addEdge(o,n,null,null,r.getShapeIndex()+this.shapeIndexShift++));var x=r.createLabelSubShape(e,o);if(null!=x){x.setStyle(x.getStyle()+";rotation="+(c>60&&c<240?(c+180)%360:c));var m=x.getGeometry();m.x=0,m.y=0,m.relative=!0,m.offset=new mxPoint(-m.width/2,-m.height/2)}}else{0===r.getShapeIndex()?o=e.insertEdge(n,null,r.getTextLabel(),null,null,t.mxgraph.io.vsdx.mxVsdxUtils.getStyleString(h,"=")):(o=e.createEdge(n,null,r.getTextLabel(),null,null,t.mxgraph.io.vsdx.mxVsdxUtils.getStyleString(h,"=")),o=e.addEdge(o,n,null,null,r.getShapeIndex()+this.shapeIndexShift++));var p=r.getLblEdgeOffset(e.getView(),g);o.getGeometry().offset=p}this.rotateChildEdge(e.getModel(),n,l,u,g);var d,v,y=e.getModel().getGeometry(o);if(g.pop(),g.shift(),y.points=g,y.setTerminalPoint(l,!0),y.setTerminalPoint(u,!1),h.hasOwnProperty("curved")&&((d=(v=h).curved?v.curved:null)&&d.equals?d.equals("1"):"1"===d)){y=e.getModel().getGeometry(o);var f=r.getControlPoints(s);y.points=f}return this.processEdgeGeo(r,o),o},e.prototype.rotateChildEdge=function(t,n,r,i,s){if(null!=n){var a=t.getGeometry(n),o=t.getStyle(n);if(null!=a&&null!=o){var l=o.indexOf("rotation=");if(l>-1){var u=parseFloat(o.substring(l+9,o.indexOf(";",l))),h=a.width/2,g=a.height/2;e.rotatedEdgePoint(r,u,h,g),e.rotatedEdgePoint(i,u,h,g);for(var c=0;c<s.length;c++){var x=s[c];e.rotatedEdgePoint(x,u,h,g)}}}}},e.prototype.sanitiseGraph=function(t){var e=t.getModel().getRoot();this.sanitiseCell(t,e)},e.prototype.sanitiseCell=function(t,e){for(var n=t.getModel(),r=n.getChildCount(e),i=[],s=0;s<r;s++){var a=n.getChildAt(e,s);this.sanitiseCell(t,a)&&i.push(a)}for(var o=0;o<i.length;o++){var l=i[o];n.remove(l)}var u=e.geometry;null!=u&&(u.height<0&&(u.height=Math.abs(u.height),u.y-=u.height,e.style+=";flipV=1;"),u.width<0&&(u.width=Math.abs(u.width),u.x-=u.width,e.style+=";flipH=1;")),r>0&&(r=n.getChildCount(e));var h=new String(n.getValue(e)).toString(),g=n.getStyle(e);return!(0!==r||!n.isVertex(e)||null!=n.getValue(e)&&0!==h.length||null==g||-1==g.indexOf(mxConstants.STYLE_FILLCOLOR+"=none")||-1==g.indexOf(mxConstants.STYLE_STROKECOLOR+"=none")||-1!=g.indexOf("image="))},e}(),n.mxVsdxCodec=r,r.__class="com.mxgraph.io.mxVsdxCodec"}(com||(com={})),function(t){var e,n,r;e=t.mxgraph||(t.mxgraph={}),n=e.io||(e.io={}),r=function(e){function n(t){var n=e.call(this)||this;return n.RESPONSE_END="",n.RESPONSE_DIAGRAM_START="",n.RESPONSE_DIAGRAM_END="",n.RESPONSE_HEADER="",n.editorUi=t,n}return __extends(n,e),n.prototype.decodeVssx=function(n,r,i,s){var a=this,o={str:"<mxlibrary>[",toString:function(){return this.str}};this.decodeVsdx(n,(function(n){var i;(i=o).str=i.str.concat(n);var l,u,h,g=a.vsdxModel.getMasterShapes(),c=(l=function(t){var e=[];null==t.entries&&(t.entries=[]);for(var n=0;n<t.entries.length;n++)e.push(t.entries[n].value);return e}(a.vsdxModel.getPages()),u=0,{next:function(){return u<l.length?l[u++]:null},hasNext:function(){return u<l.length}}).next();if(null!=g){for(var x={str:"",toString:function(){return this.str}},m=0===n.length?"":",",p=(h=g,Object.keys(h).map((function(t){return h[t]}))),d=function(n){var r,i=p[n],s=v.createMxGraph(),a=1;if(null!=i.pageSheet){var o=1,l=1,u=i.pageSheet.DrawingScale;null!=u&&(o=parseFloat(u.getAttribute("V"))||1);var h=i.pageSheet.PageScale;null!=h&&(l=parseFloat(h.getAttribute("V"))||1),a=l/o}for(var d=!1,y=0;null!=i.firstLevelShapes&&y<i.firstLevelShapes.length;y++){var f=i.firstLevelShapes[y].getShape(),_=new t.mxgraph.io.vsdx.VsdxShape(c,f,!c.isEdge(f),g,null,v.vsdxModel),S=null;if(_.isVertex()){v.edgeShapeMap.entries=[],v.parentsMap.entries=[],S=v.addShape(s,_,s.getDefaultParent(),0,1169);for(var C=(null==(r=v.edgeShapeMap).entries&&(r.entries=[]),r.entries),I=0;I<C.length;I++){var L=C[I],A=function(t,e){null==t.entries&&(t.entries=[]);for(var n=0;n<t.entries.length;n++)if(null!=t.entries[n].key.equals&&t.entries[n].key.equals(e)||t.entries[n].key===e)return t.entries[n].value;return null}(v.parentsMap,L.getKey());v.addUnconnectedEdge(s,A,L.getValue(),1169)}}else S=v.addUnconnectedEdge(s,null,_,1169);d|=null!=S}if(d){v.scaleGraph(s,a);var E=v.normalizeGraph(s);if(v.sanitiseGraph(s),0===s.getModel().getChildCount(s.getDefaultParent()))return"continue";!function(t){t.str=t.str.concat(m)}(x),function(t){t.str=t.str.concat('{"xml":"')}(x);var M=e.prototype.processPage.call(v,s,null);!function(t){t.str=t.str.concat(M)}(x),function(t){t.str=t.str.concat('","w":')}(x),function(t){t.str=t.str.concat(E.width)}(x),function(t){t.str=t.str.concat(',"h":')}(x),function(t){t.str=t.str.concat(E.height)}(x),function(t){t.str=t.str.concat(',"title":')}(x);var T=i.getName();null==T&&(T=""),T=mxUtils.htmlEntities(JSON.stringify(T)),function(t){t.str=t.str.concat(T)}(x),function(t){t.str=t.str.concat("}")}(x),m=","}},v=a,y=0;y<p.length;y++)d(y);!function(t){t.str=t.str.concat(x)}(o)}if(function(t){t.str=t.str.concat("]</mxlibrary>")}(o),r)try{r(o.str)}catch(t){null!=s?s(t):r("")}}),i)},n.prototype.normalizeGeo=function(t){var e=t.getGeometry();e.x=0,e.y=0;var n=e.sourcePoint;if(t.isEdge()&&null!=n){this.transPoint(e.targetPoint,n),this.transPoint(e.offset,n);var r=e.points;if(null!=r)for(var i=0;i<r.length;i++){var s=r[i];this.transPoint(s,n)}this.transPoint(n,n)}return e},n.prototype.normalizeGraph=function(t){var e,n,r,i;function s(t){null!=t&&(null==e?(e=t.x,n=t.y,r=t.x+(t.width||0),i=t.y+(t.height||0)):(e=Math.min(t.x,e),n=Math.min(t.y,n),r=Math.max(t.x+(t.width||0),r),i=Math.max(t.y+(t.height||0),i)))}for(var a in t.model.cells)if(null!=(g=(h=t.model.cells[a]).geometry)&&1==h.parent.id)if(h.vertex)s(g);else{s(g.sourcePoint),s(g.targetPoint);for(var o=g.points,l=0;null!=o&&l<o.length;l++)s(o[l])}var u={x:e,y:n};for(var a in t.model.cells){var h,g;if(null!=(g=(h=t.model.cells[a]).geometry)&&1==h.parent.id&&(g.x-=e,g.y-=n,h.isEdge()))for(this.transPoint(g.sourcePoint,u),this.transPoint(g.targetPoint,u),this.transPoint(g.offset,u),o=g.points,l=0;null!=o&&l<o.length;l++)this.transPoint(o[l],u)}return{width:r-e,height:i-n}},n.prototype.transPoint=function(t,e){null!=t&&(t.x=t.x-e.x,t.y=t.y-e.y)},n.prototype.processPage=function(n,r){var i,s=n.getModel(),a={str:"",toString:function(){return this.str}},o="",l=this;for(var u in s.cells){var h=s.cells[u];if(n.getDefaultParent()===s.getParent(h)){(i=a).str=i.str.concat(o),function(t){t.str=t.str.concat('{"xml":"')}(a);var g=l.createMxGraph();if(g.addCell(h),l.sanitiseGraph(g),0===g.getModel().getChildCount(g.getDefaultParent()))return"continue";var c=l.normalizeGeo(h),x=e.prototype.processPage.call(l,g,null);!function(t){t.str=t.str.concat(x)}(a),function(t){t.str=t.str.concat('","w":')}(a),function(t){t.str=t.str.concat(c.width)}(a),function(t){t.str=t.str.concat(',"h":')}(a),function(t){t.str=t.str.concat(c.height)}(a),function(t){t.str=t.str.concat(',"title":"')}(a);var m=s.getStyle(h),p="";if(null!=m){var d=m.indexOf(t.mxgraph.io.vsdx.mxVsdxConstants.VSDX_ID);if(d>=0){d+=t.mxgraph.io.vsdx.mxVsdxConstants.VSDX_ID.length+1,u=parseInt(m.substring(d,m.indexOf(";",d)));var v=function(t,e){null==t.entries&&(t.entries=[]);for(var n=0;n<t.entries.length;n++)if(null!=t.entries[n].key.equals&&t.entries[n].key.equals(e)||t.entries[n].key===e)return t.entries[n].value;return null}(l.vertexShapeMap,new t.mxgraph.io.vsdx.ShapePageId(r.getId(),u));null!=v&&(p=v.getName())}}!function(t){t.str=t.str.concat(p)}(a),function(t){t.str=t.str.concat('"}')}(a),o=","}}return a.str.length>0?this.RESPONSE_DIAGRAM_START=",":this.RESPONSE_DIAGRAM_START="",a.str},n}(t.mxgraph.io.mxVsdxCodec),n.mxVssxCodec=r,r.__class="com.mxgraph.io.mxVssxCodec"}(com||(com={})),function(t){var e,n,r,i,s;e=t.mxgraph||(t.mxgraph={}),n=e.io||(e.io={}),r=n.vsdx||(n.vsdx={}),i=r.geometry||(r.geometry={}),s=function(){function t(t,e,n){this.x=null,this.y=null,this.a=null,this.b=null,this.c=null,this.d=null,this.formulaA=null,this.formulaE=null,this.index=0,this.index=t,this.x=e,this.y=n}return t.prototype.getX=function(){return this.x},t.prototype.getY=function(){return this.y},t.prototype.getA=function(){return this.a},t.prototype.getB=function(){return this.b},t.prototype.getC=function(){return this.c},t.prototype.getD=function(){return this.d},t.prototype.getFormulaA=function(){return this.formulaA},t.prototype.getFormulaE=function(){return this.formulaE},t.prototype.getIndex=function(){return this.index},t}(),i.Row=s,s.__class="com.mxgraph.io.vsdx.geometry.Row"}(com||(com={})),function(t){var e,n,r,i,s;e=t.mxgraph||(t.mxgraph={}),n=e.io||(e.io={}),r=n.vsdx||(n.vsdx={}),i=r.geometry||(r.geometry={}),s=function(){function e(){}return e.getIndex=function(t){try{return parseInt(t.getAttribute("IX"))||1}catch(t){return 1}},e.getDoubleVal=function(t){try{if(null!=t&&0!==t.length){var e=parseFloat(t);if(isFinite(e))return e}}catch(t){}return null},e.getRowObj=function(n,r){var i,s=n.getAttribute("T"),a=e.getIndex(n);if(!((i=n.getAttribute("Del"))&&i.equals?i.equals("1"):"1"===i)){var o=null;a<=r.length&&(o=r[a-1]);var l=null,u=null,h=null,g=null,c=null,x=null,m=null,p=null;null!=o&&(l=o.x,u=o.y,h=o.getA(),g=o.getB(),c=o.getC(),x=o.getD(),p=o.getFormulaA(),m=o.getFormulaE());for(var d=t.mxgraph.io.vsdx.mxVsdxUtils.getDirectChildElements(n),v=0;v<d.length;v++){var y=d[v],f=y.getAttribute("N"),_=y.getAttribute("V");switch(f){case"X":l=e.getDoubleVal(_);break;case"Y":u=e.getDoubleVal(_);break;case"A":h=e.getDoubleVal(_),p=y.getAttribute("V");break;case"B":g=e.getDoubleVal(_);break;case"C":c=e.getDoubleVal(_);break;case"D":x=e.getDoubleVal(_);break;case"E":m=_}}switch(s){case"MoveTo":return new t.mxgraph.io.vsdx.geometry.MoveTo(a,l,u);case"LineTo":return new t.mxgraph.io.vsdx.geometry.LineTo(a,l,u);case"ArcTo":return new t.mxgraph.io.vsdx.geometry.ArcTo(a,l,u,h);case"Ellipse":return new t.mxgraph.io.vsdx.geometry.Ellipse(a,l,u,h,g,c,x);case"EllipticalArcTo":return new t.mxgraph.io.vsdx.geometry.EllipticalArcTo(a,l,u,h,g,c,x);case"InfiniteLine":return new t.mxgraph.io.vsdx.geometry.InfiniteLine(a,l,u,h,g);case"NURBSTo":return new t.mxgraph.io.vsdx.geometry.NURBSTo(a,l,u,h,g,c,x,m);case"PolylineTo":return new t.mxgraph.io.vsdx.geometry.PolylineTo(a,l,u,p);case"RelCubBezTo":return new t.mxgraph.io.vsdx.geometry.RelCubBezTo(a,l,u,h,g,c,x);case"RelEllipticalArcTo":return new t.mxgraph.io.vsdx.geometry.RelEllipticalArcTo(a,l,u,h,g,c,x);case"RelLineTo":return new t.mxgraph.io.vsdx.geometry.RelLineTo(a,l,u);case"RelMoveTo":return new t.mxgraph.io.vsdx.geometry.RelMoveTo(a,l,u);case"RelQuadBezTo":return new t.mxgraph.io.vsdx.geometry.RelQuadBezTo(a,l,u,h,g);case"SplineKnot":return new t.mxgraph.io.vsdx.geometry.SplineKnot(a,l,u,h);case"SplineStart":return new t.mxgraph.io.vsdx.geometry.SplineStart(a,l,u,h,g,c,x)}}return new t.mxgraph.io.vsdx.geometry.DelRow(a)},e}(),i.RowFactory=s,s.__class="com.mxgraph.io.vsdx.geometry.RowFactory"}(com||(com={})),function(t){var e,n,r,i;e=t.mxgraph||(t.mxgraph={}),n=e.io||(e.io={}),r=n.vsdx||(n.vsdx={}),(i=function(){function e(){this.colorElementMap={},this.fontElementMap={}}return e.__static_initialize=function(){e.__static_initialized||(e.__static_initialized=!0,e.__static_initializer_0())},e.defaultColors_$LI$=function(){return e.__static_initialize(),null==e.defaultColors&&(e.defaultColors={}),e.defaultColors},e.__static_initializer_0=function(){e.defaultColors_$LI$()[0]="#000000",e.defaultColors_$LI$()[1]="#FFFFFF",e.defaultColors_$LI$()[2]="#FF0000",e.defaultColors_$LI$()[3]="#00FF00",e.defaultColors_$LI$()[4]="#0000FF",e.defaultColors_$LI$()[5]="#FFFF00",e.defaultColors_$LI$()[6]="#FF00FF",e.defaultColors_$LI$()[7]="#00FFFF",e.defaultColors_$LI$()[8]="#800000",e.defaultColors_$LI$()[9]="#008000",e.defaultColors_$LI$()[10]="#000080",e.defaultColors_$LI$()[11]="#808000",e.defaultColors_$LI$()[12]="#800080",e.defaultColors_$LI$()[13]="#008080",e.defaultColors_$LI$()[14]="#C0C0C0",e.defaultColors_$LI$()[15]="#E6E6E6",e.defaultColors_$LI$()[16]="#CDCDCD",e.defaultColors_$LI$()[17]="#B3B3B3",e.defaultColors_$LI$()[18]="#9A9A9A",e.defaultColors_$LI$()[19]="#808080",e.defaultColors_$LI$()[20]="#666666",e.defaultColors_$LI$()[21]="#4D4D4D",e.defaultColors_$LI$()[22]="#333333",e.defaultColors_$LI$()[23]="#1A1A1A"},e.prototype.initialise=function(e,n){if(null!=e){var r=e.getElementsByTagName(t.mxgraph.io.vsdx.mxVsdxConstants.COLORS);if(r.length>0)for(var i=r.item(0).getElementsByTagName(t.mxgraph.io.vsdx.mxVsdxConstants.COLOR_ENTRY),s=i.length,a=0;a<s;a++){var o=i.item(a),l=o.getAttribute(t.mxgraph.io.vsdx.mxVsdxConstants.INDEX),u=o.getAttribute(t.mxgraph.io.vsdx.mxVsdxConstants.RGB);this.colorElementMap[l]=u}var h=e.getElementsByTagName(t.mxgraph.io.vsdx.mxVsdxConstants.FACE_NAMES);if(h.length>0){var g=h.item(0).getElementsByTagName(t.mxgraph.io.vsdx.mxVsdxConstants.FACE_NAME),c=g.length;for(a=0;a<c;a++){var x=g.item(a),m=x.getAttribute(t.mxgraph.io.vsdx.mxVsdxConstants.ID),p=x.getAttribute(t.mxgraph.io.vsdx.mxVsdxConstants.FONT_NAME);this.fontElementMap[m]=p}}}},e.prototype.getColor=function(t){var n,r,i=(n=this.colorElementMap)[r=t]?n[r]:null;return null==i&&(i=function(t,e){return t[e]?t[e]:null}(e.defaultColors_$LI$(),t),null==i)?"":i},e.prototype.getFont=function(t){var e,n,r=(e=this.fontElementMap)[n=t]?e[n]:null;return null==r?"":r},e}()).__static_initialized=!1,r.mxPropertiesManager=i,i.__class="com.mxgraph.io.vsdx.mxPropertiesManager"}(com||(com={})),function(t){var e,n,r,i;e=t.mxgraph||(t.mxgraph={}),n=e.io||(e.io={}),r=n.vsdx||(n.vsdx={}),i=function(){function e(e){this.fromSheet=null,this.sourceToSheet=null,this.sourceToPart=-1,this.targetToSheet=null,this.targetToPart=-1,this.fromCell=null,this.endShape=null;var n=e.getAttribute(t.mxgraph.io.vsdx.mxVsdxConstants.FROM_SHEET);this.fromSheet=null!=n&&0!==n.length?parseFloat(n):-1;var r=e.getAttribute(t.mxgraph.io.vsdx.mxVsdxConstants.FROM_CELL);this.addFromCell(e,r)}return e.prototype.addFromCell=function(e,n){var r,i,s=e.getAttribute(t.mxgraph.io.vsdx.mxVsdxConstants.TO_SHEET),a=!0;null!=n&&(r=n,i=t.mxgraph.io.vsdx.mxVsdxConstants.BEGIN_X,r&&r.equals?r.equals(i):r===i)?(this.sourceToSheet=null!=s&&0!==s.length?parseFloat(s):-1,a=!0):null!=n&&function(t,e){return t&&t.equals?t.equals(e):t===e}(n,t.mxgraph.io.vsdx.mxVsdxConstants.END_X)?(this.targetToSheet=null!=s&&0!==s.length?parseFloat(s):-1,a=!1):null==this.sourceToSheet?(this.sourceToSheet=null!=s&&0!==s.length?parseFloat(s):-1,a=!0):null==this.targetToSheet&&(this.targetToSheet=null!=s&&0!==s.length?parseFloat(s):-1,a=!1),this.findToPart(e,a)},e.prototype.findToPart=function(e,n){var r=e.getAttribute(t.mxgraph.io.vsdx.mxVsdxConstants.TO_PART),i=null!=r&&0!==r.length?parseFloat(r):-1;n?this.sourceToPart=i:this.targetToPart=i},e.prototype.getFromSheet=function(){return this.fromSheet},e.prototype.getSourceToSheet=function(){return this.sourceToSheet},e.prototype.getTargetToSheet=function(){return this.targetToSheet},e.prototype.getSourceToPart=function(){return this.sourceToPart},e.prototype.getTargetToPart=function(){return this.targetToPart},e.prototype.addConnect=function(e){this.endShape=e;var n=e.getAttribute(t.mxgraph.io.vsdx.mxVsdxConstants.FROM_CELL);this.addFromCell(e,n)},e}(),r.mxVsdxConnect=i,i.__class="com.mxgraph.io.vsdx.mxVsdxConnect"}(com||(com={})),function(t){var e,n,r,i;e=t.mxgraph||(t.mxgraph={}),n=e.io||(e.io={}),r=n.vsdx||(n.vsdx={}),(i=function(){function t(){}return t.SET_VALUES_$LI$=function(){return null==t.SET_VALUES&&(t.SET_VALUES=["a","b"]),t.SET_VALUES},t.MY_SET_$LI$=function(){return null==t.MY_SET&&(t.MY_SET=t.SET_VALUES_$LI$().slice(0).slice(0)),t.MY_SET},t}()).ANGLE="Angle",i.ARC_TO="ArcTo",i.BACKGROUND="Background",i.BACK_PAGE="BackPage",i.BEGIN_ARROW="BeginArrow",i.BEGIN_ARROW_SIZE="BeginArrowSize",i.BEGIN_X="BeginX",i.BEGIN_Y="BeginY",i.BOTTOM_MARGIN="BottomMargin",i.BULLET="Bullet",i.CASE="Case",i.CHARACTER="Character",i.COLOR="Color",i.COLOR_ENTRY="ColorEntry",i.COLORS="Colors",i.COLOR_TRANS="ColorTrans",i.CONNECT="Connect",i.CONNECTS="Connects",i.CONNECTION="Connection",i.CONTROL="Control",i.DELETED="Del",i.DOCUMENT_SHEET="DocumentSheet",i.ELLIPSE="Ellipse",i.ELLIPTICAL_ARC_TO="EllipticalArcTo",i.END_ARROW="EndArrow",i.END_ARROW_SIZE="EndArrowSize",i.END_X="EndX",i.END_Y="EndY",i.FACE_NAME="FaceName",i.FACE_NAMES="FaceNames",i.FALSE="0",i.FILL="Fill",i.FILL_BKGND="FillBkgnd",i.FILL_BKGND_TRANS="FillBkgndTrans",i.FILL_FOREGND="FillForegnd",i.FILL_FOREGND_TRANS="FillForegndTrans",i.FILL_PATTERN="FillPattern",i.FILL_STYLE="FillStyle",i.FILL_GRADIENT_ENABLED="FillGradientEnabled",i.FLAGS="Flags",i.FLIP_X="FlipX",i.FLIP_Y="FlipY",i.FONT="Font",i.FONT_NAME="Name",i.FOREIGN="Foreign",i.FROM_CELL="FromCell",i.FROM_SHEET="FromSheet",i.GEOM="Geom",i.HEIGHT="Height",i.HORIZONTAL_ALIGN="HorzAlign",i.ID="ID",i.INDENT_FIRST="IndFirst",i.INDENT_LEFT="IndLeft",i.INDENT_RIGHT="IndRight",i.INDEX="IX",i.LEFT_MARGIN="LeftMargin",i.LETTER_SPACE="Letterspace",i.LINE="Line",i.LINE_COLOR="LineColor",i.LINE_COLOR_TRANS="LineColorTrans",i.LINE_PATTERN="LinePattern",i.LINE_STYLE="LineStyle",i.LINE_TO="LineTo",i.LINE_WEIGHT="LineWeight",i.LOC_PIN_X="LocPinX",i.LOC_PIN_Y="LocPinY",i.MASTER="Master",i.MASTER_SHAPE="MasterShape",i.MASTERS="Masters",i.MOVE_TO="MoveTo",i.NAME="Name",i.NAME_U="NameU",i.NO_LINE="NoLine",i.NURBS_TO="NURBSTo",i.PAGE="Page",i.PAGE_HEIGHT="PageHeight",i.PAGE_WIDTH="PageWidth",i.PAGES="Pages",i.PARAGRAPH="Paragraph",i.PIN_X="PinX",i.PIN_Y="PinY",i.POS="Pos",i.RGB="RGB",i.RIGHT_MARGIN="RightMargin",i.ROUNDING="Rounding",i.RTL_TEXT="RTLText",i.SIZE="Size",i.SHAPE="Shape",i.SHAPES="Shapes",i.SHAPE_SHDW_SHOW="ShapeShdwShow",i.SHDW_PATTERN="ShdwPattern",i.SPACE_AFTER="SpAfter",i.SPACE_BEFORE="SpBefore",i.SPACE_LINE="SpLine",i.STRIKETHRU="Strikethru",i.STYLE="Style",i.STYLE_SHEET="StyleSheet",i.STYLE_SHEETS="StyleSheets",i.TEXT="Text",i.TEXT_BKGND="TextBkgnd",i.TEXT_BLOCK="TextBlock",i.TEXT_STYLE="TextStyle",i.TO_PART="ToPart",i.TO_SHEET="ToSheet",i.TOP_MARGIN="TopMargin",i.TRUE="1",i.TXT_ANGLE="TxtAngle",i.TXT_HEIGHT="TxtHeight",i.TXT_LOC_PIN_X="TxtLocPinX",i.TXT_LOC_PIN_Y="TxtLocPinY",i.TXT_PIN_X="TxtPinX",i.TXT_PIN_Y="TxtPinY",i.TXT_WIDTH="TxtWidth",i.TYPE="Type",i.TYPE_GROUP="Group",i.TYPE_SHAPE="Shape",i.UNIQUE_ID="UniqueID",i.VERTICAL_ALIGN="VerticalAlign",i.WIDTH="Width",i.X_CON="XCon",i.X_DYN="XDyn",i.X="X",i.Y_CON="YCon",i.Y_DYN="YDyn",i.Y="Y",i.HIDE_TEXT="HideText",i.VSDX_ID="vsdxID",i.CONNECT_TO_PART_WHOLE_SHAPE=3,r.mxVsdxConstants=i,i.__class="com.mxgraph.io.vsdx.mxVsdxConstants"}(com||(com={})),function(t){var e,n,r,i;e=t.mxgraph||(t.mxgraph={}),n=e.io||(e.io={}),r=n.vsdx||(n.vsdx={}),i=function(){function e(t,e){var n=this;if(this.noFill=!1,this.noLine=!1,this.noShow=!1,this.noSnap=!1,this.noQuickDrag=!1,this.rows=null,(null!=t&&1==t.nodeType||null===t)&&(null!=e&&e instanceof Array||null===e))Array.prototype.slice.call(arguments),this.index=0,this.noFill=!1,this.noLine=!1,this.noShow=!1,this.noSnap=!1,this.noQuickDrag=!1,this.rows=null,this.index=0,n.index=n.getIndex$org_w3c_dom_Element(t),null!=e&&n.index<e.length&&n.inheritGeo(e[n.index]),n.processGeoElem(t);else{if((null==t||1!=t.nodeType)&&null!==t||void 0!==e)throw new Error("invalid overload");Array.prototype.slice.call(arguments),this.index=0,this.noFill=!1,this.noLine=!1,this.noShow=!1,this.noSnap=!1,this.noQuickDrag=!1,this.rows=null,this.index=0,n.index=n.getIndex$org_w3c_dom_Element(t),n.processGeoElem(t)}}return e.prototype.getIndex$org_w3c_dom_Element=function(t){try{return parseInt(t.getAttribute("IX"))||0}catch(t){return 0}},e.prototype.getIndex=function(t){if(null!=t&&1==t.nodeType||null===t)return this.getIndex$org_w3c_dom_Element(t);if(void 0===t)return this.getIndex$();throw new Error("invalid overload")},e.prototype.processGeoElem=function(n){var r,i=t.mxgraph.io.vsdx.mxVsdxUtils.getDirectChildNamedElements(n,"Cell"),s=t.mxgraph.io.vsdx.mxVsdxUtils.getDirectChildNamedElements(n,"Row");if(null==this.rows){this.rows=[];for(var a=0;a<s.length;a++)this.rows.push(null)}for(var o=0;o<i.length;o++){var l=i[o],u=l.getAttribute("N"),h=l.getAttribute("V");switch(u){case"NoFill":this.noFill=(r=h,"1".equals?"1".equals(r):"1"===r);break;case"NoLine":this.noLine=function(t,e){return"1".equals?"1".equals(e):"1"===e}(0,h);break;case"NoShow":this.noShow=function(t,e){return"1".equals?"1".equals(e):"1"===e}(0,h);break;case"NoSnap":this.noSnap=function(t,e){return"1".equals?"1".equals(e):"1"===e}(0,h);break;case"NoQuickDrag":this.noQuickDrag=function(t,e){return"1".equals?"1".equals(e):"1"===e}(0,h)}}for(var g,c,x=this.rows.length,m=!1,p=0;p<s.length;p++){var d=s[p],v=t.mxgraph.io.vsdx.geometry.RowFactory.getRowObj(d,this.rows);v.getIndex()>x?(this.rows.push(v),m=!0):this.rows[v.getIndex()-1]=v}m&&(g=this.rows,(c=new e.mxVsdxGeometry$0(this)).compare?g.sort((function(t,e){return c.compare(t,e)})):g.sort(c))},e.prototype.inheritGeo=function(t){var e,n;this.noFill=t.noFill,this.noLine=t.noLine,this.noShow=t.noShow,this.noSnap=t.noSnap,this.noQuickDrag=t.noQuickDrag,this.rows=[],e=this.rows,n=t.rows,e.push.apply(e,n)},e.prototype.getIndex$=function(){return this.index},e.prototype.isNoFill=function(){return this.noFill},e.prototype.isNoLine=function(){return this.noLine},e.prototype.isNoShow=function(){return this.noShow},e.prototype.isNoSnap=function(){return this.noSnap},e.prototype.isNoQuickDrag=function(){return this.noQuickDrag},e.prototype.getRows=function(){return this.rows},e.prototype.getPathXML=function(t,e){if(this.noShow)return"";for(var n={str:"",toString:function(){return this.str}},r=function(r){var s,a=i.rows[r];(s=n).str=s.str.concat(null!=a?a.handle(t,e):"")},i=this,s=0;s<this.rows.length;s++)r(s);return n.str},e}(),r.mxVsdxGeometry=i,i.__class="com.mxgraph.io.vsdx.mxVsdxGeometry",function(t){var e=function(){function t(t){this.__parent=t}return t.prototype.compare=function(t,e){return(null!=t?t.getIndex():0)-(null!=e?e.getIndex():0)},t}();t.mxVsdxGeometry$0=e,e.__interfaces=["java.util.Comparator"]}(i=r.mxVsdxGeometry||(r.mxVsdxGeometry={}))}(com||(com={})),function(t){var e,n,r,i;e=t.mxgraph||(t.mxgraph={}),n=e.io||(e.io={}),r=n.vsdx||(n.vsdx={}),i=function(){function e(t){var e,n;this.geomList=[],this.parentGeomList=null,this.sortNeeded=!1,null!=t&&(this.parentGeomList=t.geomList,e=this.geomList,n=t.geomList,e.push.apply(e,n))}return e.prototype.addGeometry=function(e){var n=new t.mxgraph.io.vsdx.mxVsdxGeometry(e,this.parentGeomList);n.getIndex()<this.geomList.length?this.geomList[n.getIndex()]=n:(this.geomList.push(n),this.sortNeeded=!0)},e.prototype.sort=function(){var t,n;this.sortNeeded&&(t=this.geomList,(n=new e.mxVsdxGeometryList$0(this)).compare?t.sort((function(t,e){return n.compare(t,e)})):t.sort(n),this.sortNeeded=!1)},e.prototype.isNoShow=function(){for(var t=0;t<this.geomList.length;t++)if(!this.geomList[t].isNoShow())return!1;return!0},e.prototype.isNoFill=function(){for(var t=0;t<this.geomList.length;t++){var e=this.geomList[t];if(!e.isNoShow()&&!e.isNoFill())return!1}return!0},e.prototype.isNoLine=function(){for(var t=0;t<this.geomList.length;t++){var e=this.geomList[t];if(!e.isNoShow()&&!e.isNoLine())return!1}return!0},e.prototype.hasGeom=function(){return!(0==this.geomList.length)},e.prototype.getGeoCount=function(){for(var t=0,e=0;e<this.geomList.length;e++)this.geomList[e].isNoShow()||t++;return t},e.prototype.rotatedPoint=function(t,e,n){var r=t.x*e-t.y*n,i=t.y*e+t.x*n;t.x=r,t.y=i},e.prototype.getRoutingPoints=function(e,n,r){this.sort();var i=[];i.push(n.clone());for(var s=0,a=0,o=0;o<this.geomList.length;o++){var l=this.geomList[o];if(!l.isNoShow())for(var u=l.getRows(),h=0;h<u.length;h++){var g=u[h];if(0==h&&null!=g&&g instanceof t.mxgraph.io.vsdx.geometry.MoveTo)s=null!=g.x?g.x:0,a=null!=g.y?g.y:0;else if(null!=g&&g instanceof t.mxgraph.io.vsdx.geometry.LineTo){var c=null!=g.x?g.x:0,x=null!=g.y?g.y:0,m=new mxPoint(c,x);0!==r&&(r=function(t){return t*Math.PI/180}(360-r),this.rotatedPoint(m,Math.cos(r),Math.sin(r))),c=(m.x-s)*t.mxgraph.io.vsdx.mxVsdxUtils.conversionFactor_$LI$(),c+=n.x,x=(m.y-a)*t.mxgraph.io.vsdx.mxVsdxUtils.conversionFactor_$LI$()*-1,x+=n.y,c=Math.round(100*c)/100,x=Math.round(100*x)/100,m.x=c,m.y=x,i.push(m)}}}return i},e.prototype.getShapeXML=function(t){var e,n=new mxPoint(0,0),r={str:'<shape strokewidth="inherit"><foreground>',toString:function(){return this.str}},i=r.str.length,s=-1;return s=this.processGeo(t,n,r,s,!0),s=this.processGeo(t,n,r,s,!1),r.str.length===i?"":(this.closePath(r,s),(e=r).str=e.str.concat("</foreground></shape>"),r.str)},e.prototype.processGeo=function(e,n,r,i,s){var a=e.getRounding(),o="";a>0&&(o=' rounded="1" arcSize="'+a*t.mxgraph.io.vsdx.mxVsdxUtils.conversionFactor+'" ');for(var l=function(t){var a=u.geomList[t];if(s===a.isNoFill())return"continue";var l,h=a.getPathXML(n,e);if(0!==h.length){var g=u.getGeoStyle(a);-1===i?((l=r).str=l.str.concat("<path"+o+">"),function(t){t.str=t.str.concat(h)}(r)):i!==g?(u.closePath(r,i),function(t){t.str=t.str.concat("<path"+o+">")}(r),function(t){t.str=t.str.concat(h)}(r)):function(t){t.str=t.str.concat(h)}(r),i=g}},u=this,h=0;h<this.geomList.length;h++)l(h);return i},e.prototype.getGeoStyle=function(t){var e=0;return t.isNoLine()||t.isNoFill()?t.isNoFill()?t.isNoLine()||(e=3):e=2:e=1,e},e.prototype.closePath=function(t,e){var n;(n=t).str=n.str.concat("</path>"),1===e?function(t){t.str=t.str.concat("<fillstroke/>")}(t):2===e?function(t){t.str=t.str.concat("<fill/>")}(t):3===e&&function(t){t.str=t.str.concat("<stroke/>")}(t)},e}(),r.mxVsdxGeometryList=i,i.__class="com.mxgraph.io.vsdx.mxVsdxGeometryList",function(t){var e=function(){function t(t){this.__parent=t}return t.prototype.compare=function(t,e){return t.getIndex()-e.getIndex()},t}();t.mxVsdxGeometryList$0=e,e.__interfaces=["java.util.Comparator"]}(i=r.mxVsdxGeometryList||(r.mxVsdxGeometryList={}))}(com||(com={})),function(t){var e,n,r,i;e=t.mxgraph||(t.mxgraph={}),n=e.io||(e.io={}),r=n.vsdx||(n.vsdx={}),i=function(){function e(e,n){this.Id=null,this.masterShape=null,this.childShapes={},this.master=null,this.master=e,this.Id=e.getAttribute(t.mxgraph.io.vsdx.mxVsdxConstants.ID)||"",this.processMasterShapes(n)}return e.prototype.processMasterShapes=function(e){for(var n,r,i,s,a,o=this.master.firstChild;null!=o;){if(null!=o&&1==o.nodeType&&((a=o.nodeName)&&a.equals?a.equals("Rel"):"Rel"===a)){var l=e.getRelationship(o.getAttribute("r:id"),t.mxgraph.io.mxVsdxCodec.vsdxPlaceholder+"/masters/_rels/masters.xml.rels"),u=l.getAttribute("Target"),h=l.getAttribute("Type"),g=null;if(null!=h&&(r="master",i=(n=h).length-r.length,-1!==(s=n.indexOf(r,i))&&s===i)&&(g=e.getXmlDoc(t.mxgraph.io.mxVsdxCodec.vsdxPlaceholder+"/masters/"+u)),null!=g)for(var c=g.firstChild;null!=c;){if(null!=c&&1==c.nodeType&&function(t,e){return t&&t.equals?t.equals(e):t===e}(c.nodeName,"MasterContents")){this.processMasterShape(c,e);break}c=c.nextSibling}}else if(1==o.nodeType&&"PageSheet"==o.nodeName){this.pageSheet={};for(var x=t.mxgraph.io.vsdx.mxVsdxUtils.getDirectChildNamedElements(o,"Cell"),m=0;m<x.length;m++)this.pageSheet[x[m].getAttribute("N")]=x[m]}o=o.nextSibling}},e.prototype.processMasterShape=function(e,n,r){r||(this.firstLevelShapes=[]);for(var i,s,a=e.firstChild;null!=a;){if(null!=a&&1==a.nodeType&&(s="Shapes",(i=a.nodeName)&&i.equals?i.equals(s):i===s))for(var o=a.firstChild;null!=o;){if(null!=o&&1==o.nodeType&&function(t,e){return t&&t.equals?t.equals(e):t===e}(o.nodeName,"Shape")){var l=o,u=l.getAttribute("ID"),h=new t.mxgraph.io.vsdx.Shape(l,n);this.masterShape=null==this.masterShape?h:this.masterShape,this.childShapes[u]=h,r||this.firstLevelShapes.push(h),this.processMasterShape(l,n,!0)}o=o.nextSibling}else if(null!=a&&1==a.nodeType&&"Connects"==a.nodeName){this.connects={};for(var g=a.firstChild;null!=g;){if(null!=g&&1==g.nodeType&&"Connect"==g.nodeName){var c=g,x=new t.mxgraph.io.vsdx.mxVsdxConnect(c);this.connects[x.getFromSheet()]=x}g=g.nextSibling}}a=a.nextSibling}},e.prototype.getMasterShape=function(){return this.masterShape},e.prototype.getSubShape=function(t){return(e=this.childShapes)[n=t]?e[n]:null;var e,n},e.prototype.getNameU=function(){return this.master.getAttribute("NameU")||""},e.prototype.getName=function(){return this.master.getAttribute("Name")||""},e.prototype.getUniqueID=function(){var t="";return this.master.hasAttribute("UniqueID")&&(t=this.master.getAttribute("UniqueID")),t},e.prototype.getId=function(){return this.Id},e.prototype.getMasterElement=function(){return this.master},e}(),r.mxVsdxMaster=i,i.__class="com.mxgraph.io.vsdx.mxVsdxMaster"}(com||(com={})),function(t){var e,n,r,i;e=t.mxgraph||(t.mxgraph={}),n=e.io||(e.io={}),r=n.vsdx||(n.vsdx={}),i=function(){function e(e,n,r){this.xmlDocs=null,this.media=null,this.pages=null,this.masters={},this.stylesheets={},this.themes={},this.rootElement=null,this.pm=null,this.xmlDocs=n,this.media=r;for(var i,s,a=e.firstChild;null!=a;){if(null!=a&&1==a.nodeType&&(i=a.tagName.toLowerCase(),s=t.mxgraph.io.mxVsdxCodec.vsdxPlaceholder+"document",i&&i.equals?i.equals(s):i===s)){this.rootElement=a;break}a=a.nextSibling}this.pm=new t.mxgraph.io.vsdx.mxPropertiesManager,this.pm.initialise(this.rootElement,this),this.initStylesheets(),this.initThemes(),this.initMasters(),this.initPages()}return e.prototype.initThemes=function(){if(null!=this.xmlDocs)for(var e=!0,n=1;e;){var r=t.mxgraph.io.mxVsdxCodec.vsdxPlaceholder+"/theme/theme"+n+".xml",i=(h=this.xmlDocs)[g=r]?h[g]:null;if(null!=i){for(var s=i.firstChild;null!=s;){if(null!=s&&1==s.nodeType&&(u="a:theme",(l=s.tagName)&&l.equals?l.equals(u):l===u)){var a=new t.mxgraph.io.vsdx.mxVsdxTheme(s);a.getThemeIndex()<0&&a.processTheme();var o=function(t,e){null==t.entries&&(t.entries=[]);for(var n=0;n<t.entries.length;n++)if(null!=t.entries[n].key.equals&&t.entries[n].key.equals(e)||t.entries[n].key===e)return t.entries[n].value;return null}(this.themes,a.getThemeIndex());null!=o&&o.isPure()||function(t,e,n){null==t.entries&&(t.entries=[]);for(var r=0;r<t.entries.length;r++)if(null!=t.entries[r].key.equals&&t.entries[r].key.equals(e)||t.entries[r].key===e)return void(t.entries[r].value=n);t.entries.push({key:e,value:n,getKey:function(){return this.key},getValue:function(){return this.value}})}(this.themes,a.getThemeIndex(),a);break}s=s.nextSibling}n++}else e=!1}var l,u,h,g},e.prototype.initStylesheets=function(){var e=this.rootElement.getElementsByTagName(t.mxgraph.io.vsdx.mxVsdxConstants.STYLE_SHEETS);if(e.length>0)for(var n=e.item(0).getElementsByTagName(t.mxgraph.io.vsdx.mxVsdxConstants.STYLE_SHEET),r=n.length,i=0;i<r;i++){var s=(u=n.item(i)).getAttribute(t.mxgraph.io.vsdx.mxVsdxConstants.ID),a=new t.mxgraph.io.vsdx.Style(u,this);this.stylesheets[s]=a}for(var o,l=function(t){var e=0;return{next:function(){return e<t.length?t[e++]:null},hasNext:function(){return e<t.length}}}((o=this.stylesheets,Object.keys(o).map((function(t){return o[t]}))));l.hasNext();){var u;(u=l.next()).stylesheetRefs(this)}},e.prototype.initMasters=function(){if(null!=this.xmlDocs){var e=t.mxgraph.io.mxVsdxCodec.vsdxPlaceholder+"/masters/masters.xml",n=(u=this.xmlDocs)[h=e]?u[h]:null;if(null!=n)for(var r=n.firstChild;null!=r;){if(null!=r&&1==r.nodeType&&(o=r.tagName,l=t.mxgraph.io.vsdx.mxVsdxConstants.MASTERS,o&&o.equals?o.equals(l):o===l)){for(var i=r.firstChild;null!=i;){if(null!=i&&1==i.nodeType&&function(t,e){return t&&t.equals?t.equals(e):t===e}(i.tagName,"Master")){var s=i,a=new t.mxgraph.io.vsdx.mxVsdxMaster(s,this);this.masters[a.getId()]=a}i=i.nextSibling}break}r=r.nextSibling}}var o,l,u,h},e.prototype.initPages=function(){if(null!=this.xmlDocs){var e=t.mxgraph.io.mxVsdxCodec.vsdxPlaceholder+"/pages/pages.xml",n=(d=this.xmlDocs)[v=e]?d[v]:null;if(null!=n)for(var r=n.firstChild;null!=r;){if(null!=r&&1==r.nodeType&&(m=r.tagName,p=t.mxgraph.io.vsdx.mxVsdxConstants.PAGES,m&&m.equals?m.equals(p):m===p)){var i=r.getElementsByTagName(t.mxgraph.io.vsdx.mxVsdxConstants.PAGE);if(null!=i&&i.length>0){this.pages={};for(var s={},a=i.length,o=0;o<a;o++){var l=i.item(o);(g=this.createPage(l)).isBackground()&&function(t,e,n){null==t.entries&&(t.entries=[]);for(var r=0;r<t.entries.length;r++)if(null!=t.entries[r].key.equals&&t.entries[r].key.equals(e)||t.entries[r].key===e)return void(t.entries[r].value=n);t.entries.push({key:e,value:n,getKey:function(){return this.key},getValue:function(){return this.value}})}(s,g.getId(),g),function(t,e,n){null==t.entries&&(t.entries=[]);for(var r=0;r<t.entries.length;r++)if(null!=t.entries[r].key.equals&&t.entries[r].key.equals(e)||t.entries[r].key===e)return void(t.entries[r].value=n);t.entries.push({key:e,value:n,getKey:function(){return this.key},getValue:function(){return this.value}})}(this.pages,g.getId(),g)}for(var u=function(t){return null==t.entries&&(t.entries=[]),t.entries}(this.pages),h=0;h<u.length;h++){var g,c=(g=u[h].getValue()).getBackPageId();if(null!=c){var x=function(t,e){null==t.entries&&(t.entries=[]);for(var n=0;n<t.entries.length;n++)if(null!=t.entries[n].key.equals&&t.entries[n].key.equals(e)||t.entries[n].key===e)return t.entries[n].value;return null}(s,c);g.setBackPage(x)}}}break}r=r.nextSibling}}var m,p,d,v},e.prototype.getPages=function(){return this.pages},e.prototype.getThemes=function(){return this.themes},e.prototype.getRelationship=function(t,e){var n,r,i=(n=this.xmlDocs)[r=e]?n[r]:null;if(null==i||null==t||0===t.length)return null;for(var s,a,o=i.getElementsByTagName("Relationship"),l=0;l<o.length;l++){var u=o.item(l);if(a=t,(s=u.getAttribute("Id"))&&s.equals?s.equals(a):s===a)return u}return null},e.prototype.getMaster=function(t){return(e=this.masters)[n=t]?e[n]:null;var e,n},e.prototype.createPage=function(e){return new t.mxgraph.io.vsdx.mxVsdxPage(e,this)},e.prototype.getPropertiesManager=function(){return this.pm},e.prototype.setPropertiesManager=function(t){this.pm=t},e.prototype.getMasterShapes=function(){return this.masters},e.prototype.setMasterShapes=function(t){this.masters=t},e.prototype.getStylesheet=function(t){return(e=this.stylesheets)[n=t]?e[n]:null;var e,n},e.prototype.getXmlDoc=function(t){return(e=this.xmlDocs)[n=t]?e[n]:null;var e,n},e.prototype.getMedia=function(t){return(e=this.media)[n=t]?e[n]:null;var e,n},e}(),r.mxVsdxModel=i,i.__class="com.mxgraph.io.vsdx.mxVsdxModel"}(com||(com={})),function(t){var e,n,r,i;e=t.mxgraph||(t.mxgraph={}),n=e.io||(e.io={}),r=n.vsdx||(n.vsdx={}),i=function(){function e(e,n){this.Id=null,this.pageName=null,this.__isBackground=!1,this.backPageId=null,this.backPage=null,this.pageElement=null,this.pageSheet=null,this.model=null,this.shapes={},this.connects={},this.cellElements={},this.model=n,this.pageElement=e,this.layers=[];var r,i,s=e.getAttribute(t.mxgraph.io.vsdx.mxVsdxConstants.BACKGROUND);this.__isBackground=!(null==s||(r=s,i=t.mxgraph.io.vsdx.mxVsdxConstants.TRUE,!(r&&r.equals?r.equals(i):r===i)));var a=e.getAttribute(t.mxgraph.io.vsdx.mxVsdxConstants.BACK_PAGE);null!=a&&a.length>0&&(this.backPageId=parseFloat(a)),this.Id=parseFloat(e.getAttribute(t.mxgraph.io.vsdx.mxVsdxConstants.ID)),this.pageName=e.getAttribute(t.mxgraph.io.vsdx.mxVsdxConstants.NAME)||"",this.pageNameU=e.getAttribute(t.mxgraph.io.vsdx.mxVsdxConstants.NAME_U)||this.pageName;var o=t.mxgraph.io.vsdx.mxVsdxUtils.getDirectChildNamedElements(e,"PageSheet");if(o.length>0){for(var l=o[0],u=t.mxgraph.io.vsdx.mxVsdxUtils.getDirectChildNamedElements(l,"Cell"),h=0;h<u.length;h++){var g=u[h],c=g.getAttribute("N");this.cellElements[c]=g}for(var x=t.mxgraph.io.vsdx.mxVsdxUtils.getDirectChildNamedElements(l,"Section"),m=0;m<x.length;m++){var p=x[m];if("Layer"==(c=p.getAttribute("N")))for(var d=t.mxgraph.io.vsdx.mxVsdxUtils.getDirectChildNamedElements(p,"Row"),v=0;v<d.length;v++){for(var y=t.mxgraph.io.vsdx.mxVsdxUtils.getDirectChildNamedElements(d[v],"Cell"),f={},_=0;_<y.length;_++)f[y[_].getAttribute("N")]=y[_].getAttribute("V");this.layers[parseInt(d[v].getAttribute("IX"))]=f}}}this.parseNodes(e,n,"pages")}return e.prototype.parseNodes=function(e,n,r){for(var i,s=e.firstChild;null!=s;){if(null!=s&&1==s.nodeType){var a=s,o=a.nodeName;if((i=o)&&i.equals?i.equals("Rel"):"Rel"===i)this.resolveRel(a,n,r);else if(function(t,e){return t&&t.equals?t.equals(e):t===e}(o,"Shapes"))this.shapes=this.parseShapes(a,null,!1);else if(function(t,e){return t&&t.equals?t.equals(e):t===e}(o,"Connects"))for(var l=a.getElementsByTagName(t.mxgraph.io.vsdx.mxVsdxConstants.CONNECT),u=null!=l&&l.length>0?l.item(0):null;null!=u;){if(null!=u&&1==u.nodeType){var h=u,g=new t.mxgraph.io.vsdx.mxVsdxConnect(h),c=g.getFromSheet(),x=null!=c&&c>-1?function(t,e){null==t.entries&&(t.entries=[]);for(var n=0;n<t.entries.length;n++)if(null!=t.entries[n].key.equals&&t.entries[n].key.equals(e)||t.entries[n].key===e)return t.entries[n].value;return null}(this.connects,c):null;null!=x?x.addConnect(h):function(t,e,n){null==t.entries&&(t.entries=[]);for(var r=0;r<t.entries.length;r++)if(null!=t.entries[r].key.equals&&t.entries[r].key.equals(e)||t.entries[r].key===e)return void(t.entries[r].value=n);t.entries.push({key:e,value:n,getKey:function(){return this.key},getValue:function(){return this.value}})}(this.connects,g.getFromSheet(),g)}u=u.nextSibling}else(function(t,e){return t&&t.equals?t.equals(e):t===e})(o,"PageSheet")&&(this.pageSheet=a)}s=s.nextSibling}},e.prototype.resolveRel=function(e,n,r){var i,s,a,o,l,u,h=n.getRelationship(e.getAttribute("r:id"),t.mxgraph.io.mxVsdxCodec.vsdxPlaceholder+"/pages/_rels/"+r+".xml.rels"),g=h.getAttribute("Target"),c=h.getAttribute("Type");if(o="page",l=(a=new String(c).toString()).length-o.length,-1!==(u=a.indexOf(o,l))&&u===l){var x=null;if(null!=c&&function(t,e){var n=t.length-e.length,r=t.indexOf(e,n);return-1!==r&&r===n}(c,"page")&&(x=n.getXmlDoc(t.mxgraph.io.mxVsdxCodec.vsdxPlaceholder+"/pages/"+g)),null!=x)for(var m=x.firstChild;null!=m;){if(null!=m&&1==m.nodeType&&(s="PageContents",(i=m.tagName)&&i.equals?i.equals(s):i===s)){var p=g.indexOf(".");-1!==p&&this.parseNodes(m,n,g.substring(0,p));break}m=m.nextSibling}}},e.prototype.parseShapes=function(e,n,r){for(var i,s={},a=e.getElementsByTagName(t.mxgraph.io.vsdx.mxVsdxConstants.SHAPE),o=null!=a&&a.length>0?a.item(0):null;null!=o;){if(null!=o&&1==o.nodeType){var l=o,u=n;null==u&&(null==(g=l.getAttribute(t.mxgraph.io.vsdx.mxVsdxConstants.MASTER))||((i=g)&&i.equals?i.equals(""):""===i)||(u=this.model.getMaster(g)));var h=this.isEdge(l);if(!h&&null!=u){var g=l.getAttribute(t.mxgraph.io.vsdx.mxVsdxConstants.MASTER_SHAPE),c=u.getMasterElement();if(null!=g&&!function(t,e){return t&&t.equals?t.equals(""):""===t}(g)){var x=u.getSubShape(g);c=null!=x?x.getShape():c}h=this.isEdge(c)}var m=this.createCell(l,!h,u);!function(t,e,n){null==t.entries&&(t.entries=[]);for(var r=0;r<t.entries.length;r++)if(null!=t.entries[r].key.equals&&t.entries[r].key.equals(e)||t.entries[r].key===e)return void(t.entries[r].value=n);t.entries.push({key:e,value:n,getKey:function(){return this.key},getValue:function(){return this.value}})}(s,m.getId(),m)}o=o.nextSibling}return s},e.prototype.createCell=function(e,n,r){return new t.mxgraph.io.vsdx.VsdxShape(this,e,n,this.model.getMasterShapes(),r,this.model)},e.prototype.isEdge=function(t){if(null!=t){var e=t.childNodes;if(null!=e)for(var n=e.item(0);null!=n;){if(null!=n&&1==n.nodeType){var r=n;if(a="Cell",(s=r.nodeName)&&s.equals?s.equals(a):s===a){var i=r.getAttribute("N");if(function(t,e){return t&&t.equals?t.equals(e):t===e}(i,"BeginX")||function(t,e){return t&&t.equals?t.equals(e):t===e}(i,"BeginY")||function(t,e){return t&&t.equals?t.equals(e):t===e}(i,"EndY")||function(t,e){return t&&t.equals?t.equals(e):t===e}(i,"EndX"))return!0}}n=n.nextSibling}}var s,a;return!1},e.prototype.getPageDimensions=function(){var e,n=0,r=0,i=(e=this.cellElements).PageHeight?e.PageHeight:null,s=function(t,e){return t[e]?t[e]:null}(this.cellElements,"PageWidth");return null!=i&&(n=parseFloat(i.getAttribute("V"))*t.mxgraph.io.vsdx.mxVsdxUtils.conversionFactor_$LI$(),n=Math.round(100*n)/100),null!=s&&(r=parseFloat(s.getAttribute("V"))*t.mxgraph.io.vsdx.mxVsdxUtils.conversionFactor_$LI$(),r=Math.round(100*r)/100),new mxPoint(r,n)},e.prototype.getDrawingScale=function(){var e,n=(e=this.cellElements).DrawingScale?e.DrawingScale:null;return null!=n?parseFloat(n.getAttribute("V"))*t.mxgraph.io.vsdx.mxVsdxUtils.conversionFactor_$LI$():1},e.prototype.getPageScale=function(){var e,n=(e=this.cellElements).PageScale?e.PageScale:null;return null!=n?parseFloat(n.getAttribute("V"))*t.mxgraph.io.vsdx.mxVsdxUtils.conversionFactor_$LI$():1},e.prototype.getCellValue=function(t){var e,n,r=(e=this.cellElements)[n=t]?e[n]:null;return null!=r?r.getAttribute("V")||"":null},e.prototype.getCellIntValue=function(t,e){var n=this.getCellValue(t);return null!=n?parseInt(n):e},e.prototype.getId=function(){return this.Id},e.prototype.getPageName=function(){return this.pageName},e.prototype.getPageNameU=function(){return this.pageNameU},e.prototype.getShapes=function(){return this.shapes},e.prototype.getLayers=function(){return this.layers},e.prototype.getConnects=function(){return this.connects},e.prototype.isBackground=function(){return this.__isBackground},e.prototype.getBackPageId=function(){return this.backPageId},e.prototype.setBackPage=function(t){this.backPage=t},e.prototype.getBackPage=function(){return this.backPage},e}(),r.mxVsdxPage=i,i.__class="com.mxgraph.io.vsdx.mxVsdxPage"}(com||(com={})),function(t){var e,n,r,i;e=t.mxgraph||(t.mxgraph={}),n=e.io||(e.io={}),r=n.vsdx||(n.vsdx={}),(i=function(){function e(n){var r;this.themeIndex=-1,this.themeVariant=0,this.baseColors={},this.variantsColors=(r=function(t){if(0!=t.length){for(var e=[],n=0;n<t[0];n++)e.push(r(t.slice(1)));return e}})([4,7]),this.isMonotoneVariant=new Array(4),this.defaultClr=new t.mxgraph.io.vsdx.theme.Color(255,255,255),this.defaultLineClr=new t.mxgraph.io.vsdx.theme.Color(0,0,0),this.defaultLineStyle=new t.mxgraph.io.vsdx.theme.LineStyle,this.fillStyles=[],this.connFillStyles=[],this.lineStyles=[],this.connLineStyles=[],this.lineStylesExt=[],this.connLineStylesExt=[],this.connFontColors=[],this.connFontStyles=[],this.fontColors=[],this.fontStyles=[],this.variantEmbellishment=[0,0,0,0],this.variantFillIdx=function(t){var e=function(t){if(0==t.length)return 0;for(var n=[],r=0;r<t[0];r++)n.push(e(t.slice(1)));return n};return e([4,4])}(),this.variantLineIdx=function(t){var e=function(t){if(0==t.length)return 0;for(var n=[],r=0;r<t[0];r++)n.push(e(t.slice(1)));return n};return e([4,4])}(),this.variantEffectIdx=function(t){var e=function(t){if(0==t.length)return 0;for(var n=[],r=0;r<t[0];r++)n.push(e(t.slice(1)));return n};return e([4,4])}(),this.variantFontIdx=function(t){var e=function(t){if(0==t.length)return 0;for(var n=[],r=0;r<t[0];r++)n.push(e(t.slice(1)));return n};return e([4,4])}(),this.isProcessed=!1,this.__isPure=!0,this.theme=null,this.bkgndColor=null,this.name=null,this.theme=n,this.name=n.getAttribute("name")||"";var i,s,a=(i=e.themesIds_$LI$())[s=this.name]?i[s]:null;null!=a&&(this.themeIndex=a)}return e.__static_initialize=function(){e.__static_initialized||(e.__static_initialized=!0,e.__static_initializer_0(),e.__static_initializer_1())},e.themesIds_$LI$=function(){return e.__static_initialize(),null==e.themesIds&&(e.themesIds={}),e.themesIds},e.__static_initializer_0=function(){e.themesIds_$LI$().Office=33,e.themesIds_$LI$().Linear=34,e.themesIds_$LI$().Zephyr=35,e.themesIds_$LI$().Integral=36,e.themesIds_$LI$().Simple=37,e.themesIds_$LI$().Whisp=38,e.themesIds_$LI$().Daybreak=39,e.themesIds_$LI$().Parallel=40,e.themesIds_$LI$().Sequence=41,e.themesIds_$LI$().Slice=42,e.themesIds_$LI$().Ion=43,e.themesIds_$LI$().Retrospect=44,e.themesIds_$LI$().Organic=45,e.themesIds_$LI$().Bubble=46,e.themesIds_$LI$().Clouds=47,e.themesIds_$LI$().Gemstone=48,e.themesIds_$LI$().Lines=49,e.themesIds_$LI$().Facet=50,e.themesIds_$LI$().Prominence=51,e.themesIds_$LI$().Smoke=52,e.themesIds_$LI$().Radiance=53,e.themesIds_$LI$().Shade=54,e.themesIds_$LI$().Pencil=55,e.themesIds_$LI$().Pen=56,e.themesIds_$LI$().Marker=57,e.themesIds_$LI$().Whiteboard=58},e.colorIds_$LI$=function(){return e.__static_initialize(),null==e.colorIds&&(e.colorIds={}),e.colorIds},e.__static_initializer_1=function(){!function(t,e,n){null==t.entries&&(t.entries=[]);for(var r=0;r<t.entries.length;r++)if(null!=t.entries[r].key.equals&&t.entries[r].key.equals(0)||0===t.entries[r].key)return void(t.entries[r].value="dk1");t.entries.push({key:0,value:"dk1",getKey:function(){return this.key},getValue:function(){return this.value}})}(e.colorIds_$LI$()),function(t,e,n){null==t.entries&&(t.entries=[]);for(var r=0;r<t.entries.length;r++)if(null!=t.entries[r].key.equals&&t.entries[r].key.equals(1)||1===t.entries[r].key)return void(t.entries[r].value="lt1");t.entries.push({key:1,value:"lt1",getKey:function(){return this.key},getValue:function(){return this.value}})}(e.colorIds_$LI$()),function(t,e,n){null==t.entries&&(t.entries=[]);for(var r=0;r<t.entries.length;r++)if(null!=t.entries[r].key.equals&&t.entries[r].key.equals(2)||2===t.entries[r].key)return void(t.entries[r].value=n);t.entries.push({key:2,value:n,getKey:function(){return this.key},getValue:function(){return this.value}})}(e.colorIds_$LI$(),0,"accent1"),function(t,e,n){null==t.entries&&(t.entries=[]);for(var r=0;r<t.entries.length;r++)if(null!=t.entries[r].key.equals&&t.entries[r].key.equals(3)||3===t.entries[r].key)return void(t.entries[r].value=n);t.entries.push({key:3,value:n,getKey:function(){return this.key},getValue:function(){return this.value}})}(e.colorIds_$LI$(),0,"accent2"),function(t,e,n){null==t.entries&&(t.entries=[]);for(var r=0;r<t.entries.length;r++)if(null!=t.entries[r].key.equals&&t.entries[r].key.equals(4)||4===t.entries[r].key)return void(t.entries[r].value=n);t.entries.push({key:4,value:n,getKey:function(){return this.key},getValue:function(){return this.value}})}(e.colorIds_$LI$(),0,"accent3"),function(t,e,n){null==t.entries&&(t.entries=[]);for(var r=0;r<t.entries.length;r++)if(null!=t.entries[r].key.equals&&t.entries[r].key.equals(5)||5===t.entries[r].key)return void(t.entries[r].value=n);t.entries.push({key:5,value:n,getKey:function(){return this.key},getValue:function(){return this.value}})}(e.colorIds_$LI$(),0,"accent4"),function(t,e,n){null==t.entries&&(t.entries=[]);for(var r=0;r<t.entries.length;r++)if(null!=t.entries[r].key.equals&&t.entries[r].key.equals(6)||6===t.entries[r].key)return void(t.entries[r].value=n);t.entries.push({key:6,value:n,getKey:function(){return this.key},getValue:function(){return this.value}})}(e.colorIds_$LI$(),0,"accent5"),function(t,e,n){null==t.entries&&(t.entries=[]);for(var r=0;r<t.entries.length;r++)if(null!=t.entries[r].key.equals&&t.entries[r].key.equals(7)||7===t.entries[r].key)return void(t.entries[r].value=n);t.entries.push({key:7,value:n,getKey:function(){return this.key},getValue:function(){return this.value}})}(e.colorIds_$LI$(),0,"accent6")},e.prototype.getThemeIndex=function(){return this.themeIndex},e.prototype.setVariant=function(t){this.themeVariant=t},e.prototype.isPure=function(){return this.__isPure},e.prototype.processTheme=function(){if(!this.isProcessed){try{for(var t=this.theme.firstChild;null!=t;){if(null!=t&&1==t.nodeType&&(i=t.nodeName,s="a:themeElements",i&&i.equals?i.equals(s):i===s))for(var e=t.firstChild;null!=e;){if(null!=e&&1==e.nodeType){var n=e,r=n.nodeName;!function(t,e){return t&&t.equals?t.equals(e):t===e}(r,"a:clrScheme")?function(t,e){return t&&t.equals?t.equals(e):t===e}(r,"a:fontScheme")?(function(t,e){return t&&t.equals?t.equals(e):t===e}(this.name,n.getAttribute("name"))||(this.__isPure=!1),this.processFonts(n)):function(t,e){return t&&t.equals?t.equals(e):t===e}(r,"a:fmtScheme")?(function(t,e){return t&&t.equals?t.equals(e):t===e}(this.name,n.getAttribute("name"))||(this.__isPure=!1),this.processFormats(n)):function(t,e){return t&&t.equals?t.equals(e):t===e}(r,"a:extLst")&&this.processExtras(n):(function(t,e){return t&&t.equals?t.equals(e):t===e}(this.name,n.getAttribute("name"))||(this.__isPure=!1),this.processColors(n))}e=e.nextSibling}t=t.nextSibling}}catch(t){console.error(t.message,t)}var i,s;this.isProcessed=!0}},e.prototype.processExtras=function(e){for(var n,r,i=t.mxgraph.io.vsdx.mxVsdxUtils.getDirectChildElements(e),s=0;s<i.length;s++){var a=i[s],o=t.mxgraph.io.vsdx.mxVsdxUtils.getDirectFirstChildElement(a);switch(o.nodeName){case"vt:fmtConnectorScheme":n=this.name,r=o.getAttribute("name"),(n&&n.equals?n.equals(r):n===r)||(this.__isPure=!1);for(var l=t.mxgraph.io.vsdx.mxVsdxUtils.getDirectChildElements(o),u=0;u<l.length;u++){var h=l[u];switch(h.nodeName){case"a:fillStyleLst":for(var g=t.mxgraph.io.vsdx.mxVsdxUtils.getDirectChildElements(h),c=0;c<g.length;c++){var x=g[c];this.connFillStyles.push(t.mxgraph.io.vsdx.theme.FillStyleFactory.getFillStyle(x))}break;case"a:lnStyleLst":for(var m=t.mxgraph.io.vsdx.mxVsdxUtils.getDirectChildElements(h),p=0;p<m.length;p++){var d=m[p];this.connLineStyles.push(new t.mxgraph.io.vsdx.theme.LineStyle(d))}}}break;case"vt:lineStyles":for(var v=t.mxgraph.io.vsdx.mxVsdxUtils.getDirectChildElements(o),y=0;y<v.length;y++){var f=v[y];switch(f.nodeName){case"vt:fmtConnectorSchemeLineStyles":for(var _=t.mxgraph.io.vsdx.mxVsdxUtils.getDirectChildElements(f),S=0;S<_.length;S++){var C=_[S];this.connLineStylesExt.push(new t.mxgraph.io.vsdx.theme.LineStyleExt(C))}break;case"vt:fmtSchemeLineStyles":for(var I=t.mxgraph.io.vsdx.mxVsdxUtils.getDirectChildElements(f),L=0;L<I.length;L++){var A=I[L];this.lineStylesExt.push(new t.mxgraph.io.vsdx.theme.LineStyleExt(A))}}}break;case"vt:fontStylesGroup":for(var E=t.mxgraph.io.vsdx.mxVsdxUtils.getDirectChildElements(o),M=0;M<E.length;M++){var T=E[M];switch(T.nodeName){case"vt:connectorFontStyles":this.fillFontStyles(T,this.connFontColors,this.connFontStyles);break;case"vt:fontStyles":this.fillFontStyles(T,this.fontColors,this.fontStyles)}}break;case"vt:variationStyleSchemeLst":for(var N=t.mxgraph.io.vsdx.mxVsdxUtils.getDirectChildElements(o),D=0,$=0;$<N.length;$++){var V=N[$];this.variantEmbellishment[D]=t.mxgraph.io.vsdx.mxVsdxUtils.getIntAttr$org_w3c_dom_Element$java_lang_String(V,"embellishment");for(var O=t.mxgraph.io.vsdx.mxVsdxUtils.getDirectChildElements(V),k=0,R=0;R<O.length;R++){var b=O[R];this.variantFillIdx[D][k]=t.mxgraph.io.vsdx.mxVsdxUtils.getIntAttr$org_w3c_dom_Element$java_lang_String(b,"fillIdx"),this.variantLineIdx[D][k]=t.mxgraph.io.vsdx.mxVsdxUtils.getIntAttr$org_w3c_dom_Element$java_lang_String(b,"lineIdx"),this.variantEffectIdx[D][k]=t.mxgraph.io.vsdx.mxVsdxUtils.getIntAttr$org_w3c_dom_Element$java_lang_String(b,"effectIdx"),this.variantFontIdx[D][k]=t.mxgraph.io.vsdx.mxVsdxUtils.getIntAttr$org_w3c_dom_Element$java_lang_String(b,"fontIdx"),k++}D++}}}},e.prototype.fillFontStyles=function(e,n,r){for(var i=t.mxgraph.io.vsdx.mxVsdxUtils.getDirectChildElements(e),s=0;s<i.length;s++){var a=i[s];r.push(t.mxgraph.io.vsdx.mxVsdxUtils.getIntAttr$org_w3c_dom_Element$java_lang_String(a,"style"));var o=t.mxgraph.io.vsdx.mxVsdxUtils.getDirectFirstChildElement(a);null!=o&&n.push(t.mxgraph.io.vsdx.theme.OoxmlColorFactory.getOoxmlColor(t.mxgraph.io.vsdx.mxVsdxUtils.getDirectFirstChildElement(o)))}},e.prototype.processFormats=function(e){for(var n=t.mxgraph.io.vsdx.mxVsdxUtils.getDirectChildElements(e),r=0;r<n.length;r++){var i=n[r];switch(i.nodeName){case"a:fillStyleLst":for(var s=t.mxgraph.io.vsdx.mxVsdxUtils.getDirectChildElements(i),a=0;a<s.length;a++){var o=s[a];this.fillStyles.push(t.mxgraph.io.vsdx.theme.FillStyleFactory.getFillStyle(o))}break;case"a:lnStyleLst":for(var l=t.mxgraph.io.vsdx.mxVsdxUtils.getDirectChildElements(i),u=0;u<l.length;u++){var h=l[u];this.lineStyles.push(new t.mxgraph.io.vsdx.theme.LineStyle(h))}}}},e.prototype.processFonts=function(t){},e.prototype.processColors=function(e){for(var n,r,i=e.firstChild;null!=i;){if(null!=i&&1==i.nodeType){var s=i,a=s.nodeName,o=t.mxgraph.io.vsdx.mxVsdxUtils.getDirectChildElements(s);if(r="a:extLst",(n=a)&&n.equals?n.equals(r):n===r)3===o.length&&(this.themeIndex<0&&this.extractThemeIndex(o[0]),this.addBkgndColor(o[1]),this.addVariantColors(o[2]));else{var l=a.substring(2);o.length>0&&this.addBasicColor(l,o[0])}}i=i.nextSibling}},e.prototype.addVariantColors=function(e){var n=t.mxgraph.io.vsdx.mxVsdxUtils.getDirectFirstChildElement(e);if(null!=n)for(var r=t.mxgraph.io.vsdx.mxVsdxUtils.getDirectChildElements(n),i=0,s=0;s<r.length;s++){var a=r[s];this.addVariantColorsSet(i++,a)}},e.prototype.addVariantColorsSet=function(e,n){var r=t.mxgraph.io.vsdx.mxVsdxUtils.getDirectChildElements(n);this.isMonotoneVariant[e]=n.hasAttribute("monotone");for(var i=0;i<r.length;i++){var s=r[i];switch(s.nodeName){case"vt:varColor1":this.variantsColors[e][0]=t.mxgraph.io.vsdx.theme.OoxmlColorFactory.getOoxmlColor(t.mxgraph.io.vsdx.mxVsdxUtils.getDirectFirstChildElement(s));break;case"vt:varColor2":this.variantsColors[e][1]=t.mxgraph.io.vsdx.theme.OoxmlColorFactory.getOoxmlColor(t.mxgraph.io.vsdx.mxVsdxUtils.getDirectFirstChildElement(s));break;case"vt:varColor3":this.variantsColors[e][2]=t.mxgraph.io.vsdx.theme.OoxmlColorFactory.getOoxmlColor(t.mxgraph.io.vsdx.mxVsdxUtils.getDirectFirstChildElement(s));break;case"vt:varColor4":this.variantsColors[e][3]=t.mxgraph.io.vsdx.theme.OoxmlColorFactory.getOoxmlColor(t.mxgraph.io.vsdx.mxVsdxUtils.getDirectFirstChildElement(s));break;case"vt:varColor5":this.variantsColors[e][4]=t.mxgraph.io.vsdx.theme.OoxmlColorFactory.getOoxmlColor(t.mxgraph.io.vsdx.mxVsdxUtils.getDirectFirstChildElement(s));break;case"vt:varColor6":this.variantsColors[e][5]=t.mxgraph.io.vsdx.theme.OoxmlColorFactory.getOoxmlColor(t.mxgraph.io.vsdx.mxVsdxUtils.getDirectFirstChildElement(s));break;case"vt:varColor7":this.variantsColors[e][6]=t.mxgraph.io.vsdx.theme.OoxmlColorFactory.getOoxmlColor(t.mxgraph.io.vsdx.mxVsdxUtils.getDirectFirstChildElement(s))}}},e.prototype.addBkgndColor=function(e){var n=t.mxgraph.io.vsdx.mxVsdxUtils.getDirectFirstChildElement(e);null!=n&&(this.bkgndColor=t.mxgraph.io.vsdx.theme.OoxmlColorFactory.getOoxmlColor(t.mxgraph.io.vsdx.mxVsdxUtils.getDirectFirstChildElement(n)))},e.prototype.extractThemeIndex=function(e){var n=t.mxgraph.io.vsdx.mxVsdxUtils.getDirectFirstChildElement(e);null!=n&&(this.themeIndex=parseInt(n.getAttribute("schemeEnum")))},e.prototype.addBasicColor=function(e,n){this.baseColors[e]=t.mxgraph.io.vsdx.theme.OoxmlColorFactory.getOoxmlColor(n)},e.prototype.getSchemeColor=function(t){this.processTheme();var e,n,r=(e=this.baseColors)[n=t]?e[n]:null;return null!=r?r.getColor$com_mxgraph_io_vsdx_mxVsdxTheme(this):this.defaultClr},e.prototype.getStyleColor=function(t){var n,r;if(this.processTheme(),t<8){if(null!=(n=this.baseColors,r=function(t,e){null==t.entries&&(t.entries=[]);for(var n=0;n<t.entries.length;n++)if(null!=t.entries[n].key.equals&&t.entries[n].key.equals(e)||t.entries[n].key===e)return t.entries[n].value;return null}(e.colorIds_$LI$(),t),i=n[r]?n[r]:null))return i.getColor$com_mxgraph_io_vsdx_mxVsdxTheme(this)}else if(8===t){if(null!=this.bkgndColor)return this.bkgndColor.getColor$com_mxgraph_io_vsdx_mxVsdxTheme(this)}else{var i=null,s=0;if(t>=200?s=t-200:t>=100&&(s=t-100),s>=0&&s<=6&&(i=this.variantsColors[this.themeVariant][s]),null!=i)return i.getColor$com_mxgraph_io_vsdx_mxVsdxTheme(this)}return this.defaultClr},e.prototype.getFillGraientColor=function(t){return this.getFillColor$com_mxgraph_io_vsdx_theme_QuickStyleVals$boolean(t,!0)},e.prototype.getFillColor$com_mxgraph_io_vsdx_theme_QuickStyleVals=function(t){return this.getFillColor$com_mxgraph_io_vsdx_theme_QuickStyleVals$boolean(t,!1)},e.prototype.getFillColor$com_mxgraph_io_vsdx_theme_QuickStyleVals$boolean=function(e,n){this.processTheme();var r,i=e.getQuickStyleFillColor(),s=null;switch(e.getQuickStyleFillMatrix()){case 1:case 2:case 3:case 4:case 5:case 6:s=this.fillStyles[e.getQuickStyleFillMatrix()-1];break;case 100:case 101:case 102:case 103:this.isMonotoneVariant[this.themeVariant]&&(i=100);var a=e.getQuickStyleFillMatrix()-100;s=this.fillStyles[this.variantFillIdx[this.themeVariant][a]-1]}r=null!=s?n?null!=s&&s instanceof t.mxgraph.io.vsdx.theme.GradFill?s.applyStyle(i,this).getGradientClr():null:s.applyStyle(i,this):n?null:this.getStyleColor(i);var o=e.getQuickStyleVariation();if(null!=r&&(8&o)>0){var l=this.getStyleColor(8).toHsl(),u=this.getLineColor$com_mxgraph_io_vsdx_theme_QuickStyleVals(e),h=u.toHsl(),g=r.toHsl();Math.abs(l.getLum()-g.getLum())>=.1666||(l.getLum()<=.7292?r=new t.mxgraph.io.vsdx.theme.Color(255,255,255):Math.abs(l.getLum()-h.getLum())>Math.abs(l.getLum()-g.getLum())&&(r=u))}return r},e.prototype.getFillColor=function(e,n){if(!(null!=e&&e instanceof t.mxgraph.io.vsdx.theme.QuickStyleVals||null===e)||"boolean"!=typeof n&&null!==n){if((null!=e&&e instanceof t.mxgraph.io.vsdx.theme.QuickStyleVals||null===e)&&void 0===n)return this.getFillColor$com_mxgraph_io_vsdx_theme_QuickStyleVals(e);throw new Error("invalid overload")}return this.getFillColor$com_mxgraph_io_vsdx_theme_QuickStyleVals$boolean(e,n)},e.prototype.getLineStyle=function(t,e){this.processTheme();var n=null;switch(t){case 1:case 2:case 3:case 4:case 5:case 6:n=e[t-1];break;case 100:case 101:case 102:case 103:var r=t-100;n=e===this.lineStyles?this.lineStyles[this.variantLineIdx[this.themeVariant][r]-1]:this.defaultLineStyle}return n},e.prototype.getLineStyleExt=function(t,e){this.processTheme();var n=null;switch(t){case 0:case 1:case 2:case 3:case 4:case 5:case 6:n=e[t]}return n},e.prototype.getLineColor$com_mxgraph_io_vsdx_theme_QuickStyleVals$java_util_ArrayList=function(e,n){this.processTheme();var r,i=e.getQuickStyleLineColor(),s=this.getLineStyle(e.getQuickStyleLineMatrix(),n);switch(e.getQuickStyleLineMatrix()){case 100:case 101:case 102:case 103:this.isMonotoneVariant[this.themeVariant]&&(i=100)}if(r=null!=s?s.getLineColor(i,this):this.getStyleColor(i),(4&e.getQuickStyleVariation())>0){var a=this.getStyleColor(8).toHsl(),o=this.getFillColor$com_mxgraph_io_vsdx_theme_QuickStyleVals(e),l=o.toHsl(),u=r.toHsl();Math.abs(a.getLum()-u.getLum())>=.1666||(a.getLum()<=.7292?r=new t.mxgraph.io.vsdx.theme.Color(255,255,255):Math.abs(a.getLum()-l.getLum())>Math.abs(a.getLum()-u.getLum())&&(r=o))}return r},e.prototype.getLineColor=function(e,n){if((null!=e&&e instanceof t.mxgraph.io.vsdx.theme.QuickStyleVals||null===e)&&(null!=n&&n instanceof Array||null===n))return this.getLineColor$com_mxgraph_io_vsdx_theme_QuickStyleVals$java_util_ArrayList(e,n);if((null!=e&&e instanceof t.mxgraph.io.vsdx.theme.QuickStyleVals||null===e)&&void 0===n)return this.getLineColor$com_mxgraph_io_vsdx_theme_QuickStyleVals(e);throw new Error("invalid overload")},e.prototype.getLineColor$com_mxgraph_io_vsdx_theme_QuickStyleVals=function(t){return this.getLineColor$com_mxgraph_io_vsdx_theme_QuickStyleVals$java_util_ArrayList(t,this.lineStyles)},e.prototype.getConnLineColor=function(t){return this.getLineColor$com_mxgraph_io_vsdx_theme_QuickStyleVals$java_util_ArrayList(t,this.connLineStyles)},e.prototype.getDefaultLineClr=function(){return this.defaultLineClr},e.prototype.isLineDashed$com_mxgraph_io_vsdx_theme_QuickStyleVals$java_util_ArrayList$java_util_ArrayList=function(t,e,n){var r=this.getLineStyleExt(t.getQuickStyleLineMatrix(),e);if(null!=r)return r.isDashed();var i=this.getLineStyle(t.getQuickStyleLineMatrix(),n);return null!=i&&i.isDashed()},e.prototype.isLineDashed=function(e,n,r){if((null!=e&&e instanceof t.mxgraph.io.vsdx.theme.QuickStyleVals||null===e)&&(null!=n&&n instanceof Array||null===n)&&(null!=r&&r instanceof Array||null===r))return this.isLineDashed$com_mxgraph_io_vsdx_theme_QuickStyleVals$java_util_ArrayList$java_util_ArrayList(e,n,r);if((null!=e&&e instanceof t.mxgraph.io.vsdx.theme.QuickStyleVals||null===e)&&void 0===n&&void 0===r)return this.isLineDashed$com_mxgraph_io_vsdx_theme_QuickStyleVals(e);throw new Error("invalid overload")},e.prototype.isLineDashed$com_mxgraph_io_vsdx_theme_QuickStyleVals=function(t){return this.isLineDashed$com_mxgraph_io_vsdx_theme_QuickStyleVals$java_util_ArrayList$java_util_ArrayList(t,this.lineStylesExt,this.lineStyles)},e.prototype.isConnLineDashed=function(t){return this.isLineDashed$com_mxgraph_io_vsdx_theme_QuickStyleVals$java_util_ArrayList$java_util_ArrayList(t,this.connLineStylesExt,this.connLineStyles)},e.prototype.getLineDashPattern$com_mxgraph_io_vsdx_theme_QuickStyleVals$java_util_ArrayList$java_util_ArrayList=function(t,e,n){var r=this.getLineStyleExt(t.getQuickStyleLineMatrix(),e);if(null!=r)return r.getLineDashPattern();var i=this.getLineStyle(t.getQuickStyleLineMatrix(),n);return null!=i?i.getLineDashPattern():null},e.prototype.getLineDashPattern=function(e,n,r){if((null!=e&&e instanceof t.mxgraph.io.vsdx.theme.QuickStyleVals||null===e)&&(null!=n&&n instanceof Array||null===n)&&(null!=r&&r instanceof Array||null===r))return this.getLineDashPattern$com_mxgraph_io_vsdx_theme_QuickStyleVals$java_util_ArrayList$java_util_ArrayList(e,n,r);if((null!=e&&e instanceof t.mxgraph.io.vsdx.theme.QuickStyleVals||null===e)&&void 0===n&&void 0===r)return this.getLineDashPattern$com_mxgraph_io_vsdx_theme_QuickStyleVals(e);throw new Error("invalid overload")},e.prototype.getLineDashPattern$com_mxgraph_io_vsdx_theme_QuickStyleVals=function(t){return this.getLineDashPattern$com_mxgraph_io_vsdx_theme_QuickStyleVals$java_util_ArrayList$java_util_ArrayList(t,this.lineStylesExt,this.lineStyles)},e.prototype.getConnLineDashPattern=function(t){return this.getLineDashPattern$com_mxgraph_io_vsdx_theme_QuickStyleVals$java_util_ArrayList$java_util_ArrayList(t,this.connLineStylesExt,this.connLineStyles)},e.prototype.getArrowSize=function(t,e,n,r){var i=this.getLineStyleExt(t.getQuickStyleLineMatrix(),n);if(null!=i)return e?i.getStartSize():i.getEndSize();var s=this.getLineStyle(t.getQuickStyleLineMatrix(),r);return null!=s?e?s.getStartSize():s.getEndSize():4},e.prototype.getStartSize=function(t){return this.getArrowSize(t,!0,this.lineStylesExt,this.lineStyles)},e.prototype.getConnStartSize=function(t){return this.getArrowSize(t,!0,this.connLineStylesExt,this.connLineStyles)},e.prototype.getEndSize=function(t){return this.getArrowSize(t,!1,this.lineStylesExt,this.lineStyles)},e.prototype.getConnEndSize=function(t){return this.getArrowSize(t,!1,this.connLineStylesExt,this.connLineStyles)},e.prototype.getFontColor$com_mxgraph_io_vsdx_theme_QuickStyleVals$java_util_ArrayList=function(e,n){this.processTheme();var r,i,s=e.getQuickStyleFontColor(),a=null;switch(e.getQuickStyleFontMatrix()){case 1:case 2:case 3:case 4:case 5:case 6:a=n[e.getQuickStyleFontMatrix()-1];break;case 100:case 101:case 102:case 103:this.isMonotoneVariant[this.themeVariant]&&(s=100);var o=e.getQuickStyleFontMatrix()-100;a=n!==this.fontColors?(r=this.baseColors).dk1?r.dk1:null:n[this.variantFontIdx[this.themeVariant][o]-1]}if(i=null!=a?a.getColor$int$com_mxgraph_io_vsdx_mxVsdxTheme(s,this):this.getStyleColor(s),(2&e.getQuickStyleVariation())>0){var l=this.getStyleColor(8).toHsl(),u=i.toHsl(),h=this.getFillColor$com_mxgraph_io_vsdx_theme_QuickStyleVals(e),g=h.toHsl(),c=this.getLineColor$com_mxgraph_io_vsdx_theme_QuickStyleVals(e),x=c.toHsl();if(Math.abs(l.getLum()-u.getLum())>=.1666);else if(l.getLum()<=.7292)i=new t.mxgraph.io.vsdx.theme.Color(255,255,255);else{var m=Math.abs(l.getLum()-x.getLum()),p=Math.abs(l.getLum()-g.getLum()),d=Math.abs(l.getLum()-u.getLum()),v=Math.max(m,p,d);v==m?i=c:v==p&&(i=h)}}return i},e.prototype.getFontColor=function(e,n){if((null!=e&&e instanceof t.mxgraph.io.vsdx.theme.QuickStyleVals||null===e)&&(null!=n&&n instanceof Array||null===n))return this.getFontColor$com_mxgraph_io_vsdx_theme_QuickStyleVals$java_util_ArrayList(e,n);if((null!=e&&e instanceof t.mxgraph.io.vsdx.theme.QuickStyleVals||null===e)&&void 0===n)return this.getFontColor$com_mxgraph_io_vsdx_theme_QuickStyleVals(e);throw new Error("invalid overload")},e.prototype.getFontColor$com_mxgraph_io_vsdx_theme_QuickStyleVals=function(t){return this.getFontColor$com_mxgraph_io_vsdx_theme_QuickStyleVals$java_util_ArrayList(t,this.fontColors)},e.prototype.getConnFontColor=function(t){return this.getFontColor$com_mxgraph_io_vsdx_theme_QuickStyleVals$java_util_ArrayList(t,this.connFontColors)},e.prototype.getArrowType=function(t,e,n,r){var i=this.getLineStyleExt(t.getQuickStyleLineMatrix(),n);if(null!=i)return e?i.getStart():i.getEnd();var s=this.getLineStyle(t.getQuickStyleLineMatrix(),r);return null!=s?e?s.getStart():s.getEnd():0},e.prototype.getEdgeMarker=function(t,e){return this.getArrowType(e,t,this.lineStylesExt,this.lineStyles)},e.prototype.getConnEdgeMarker=function(t,e){return this.getArrowType(e,t,this.connLineStylesExt,this.connLineStyles)},e.prototype.getLineWidth$com_mxgraph_io_vsdx_theme_QuickStyleVals$java_util_ArrayList=function(t,e){var n=this.getLineStyle(t.getQuickStyleLineMatrix(),e);return null!=n?n.getLineWidth():0},e.prototype.getLineWidth=function(e,n){if((null!=e&&e instanceof t.mxgraph.io.vsdx.theme.QuickStyleVals||null===e)&&(null!=n&&n instanceof Array||null===n))return this.getLineWidth$com_mxgraph_io_vsdx_theme_QuickStyleVals$java_util_ArrayList(e,n);if((null!=e&&e instanceof t.mxgraph.io.vsdx.theme.QuickStyleVals||null===e)&&void 0===n)return this.getLineWidth$com_mxgraph_io_vsdx_theme_QuickStyleVals(e);throw new Error("invalid overload")},e.prototype.getLineWidth$com_mxgraph_io_vsdx_theme_QuickStyleVals=function(t){return this.getLineWidth$com_mxgraph_io_vsdx_theme_QuickStyleVals$java_util_ArrayList(t,this.lineStyles)},e.prototype.getConnLineWidth=function(t){return this.getLineWidth$com_mxgraph_io_vsdx_theme_QuickStyleVals$java_util_ArrayList(t,this.connLineStyles)},e}()).__static_initialized=!1,r.mxVsdxTheme=i,i.__class="com.mxgraph.io.vsdx.mxVsdxTheme"}(com||(com={})),function(t){var e,n,r,i;e=t.mxgraph||(t.mxgraph={}),n=e.io||(e.io={}),r=n.vsdx||(n.vsdx={}),(i=function(){function e(){}return e.conversionFactor_$LI$=function(){return null==e.conversionFactor&&(e.conversionFactor=e.screenCoordinatesPerCm*e.CENTIMETERS_PER_INCHES),e.conversionFactor},e.getDirectChildNamedElements=function(t,e){for(var n,r,i=[],s=t.firstChild;null!=s;s=s.nextSibling)null!=s&&1==s.nodeType&&(n=e,r=s.nodeName,n&&n.equals?n.equals(r):n===r)&&i.push(s);return i},e.getDirectChildElements=function(t){for(var e=[],n=t.firstChild;null!=n;n=n.nextSibling)null!=n&&1==n.nodeType&&e.push(n);return e},e.getDirectFirstChildElement=function(t){for(var e=t.firstChild;null!=e;e=e.nextSibling)if(null!=e&&1==e.nodeType)return e;return null},e.getIntAttr$org_w3c_dom_Element$java_lang_String$int=function(t,e,n){try{var r=t.getAttribute(e);if(null!=r)return parseInt(r)}catch(t){}return n},e.getIntAttr=function(e,n,r){if((null==e||1!=e.nodeType)&&null!==e||"string"!=typeof n&&null!==n||"number"!=typeof r&&null!==r){if((null==e||1!=e.nodeType)&&null!==e||"string"!=typeof n&&null!==n||void 0!==r)throw new Error("invalid overload");return t.mxgraph.io.vsdx.mxVsdxUtils.getIntAttr$org_w3c_dom_Element$java_lang_String(e,n)}return t.mxgraph.io.vsdx.mxVsdxUtils.getIntAttr$org_w3c_dom_Element$java_lang_String$int(e,n,r)},e.getIntAttr$org_w3c_dom_Element$java_lang_String=function(t,n){return e.getIntAttr$org_w3c_dom_Element$java_lang_String$int(t,n,0)},e.getStyleString=function(t,e){for(var n,r,i,s,a,o,l,u,h,g="",c=(i=t,n=Object.keys(i).map((function(t){return i[t]})),r=0,{next:function(){return r<n.length?n[r++]:null},hasNext:function(){return r<n.length}}),x=function(t){var e=0;return{next:function(){return e<t.length?t[e++]:null},hasNext:function(){return e<t.length}}}(Object.keys(t));x.hasNext();){var m=x.next(),p=c.next();if(u=m,h=mxConstants.STYLE_SHAPE,!(u&&u.equals?u.equals(h):u===h)||(s="image",void 0===(a=void 0)&&(a=0),((o=t)[l=m]?o[l]:null).substr(a,s.length)!==s&&!function(t,e,n){return void 0===n&&(n=0),t.substr(n,e.length)===e}(function(t,e){return t[e]?t[e]:null}(t,m),"rounded=")))try{g=g+m+e}catch(t){console.error("mxVsdxUtils.getStyleString,"+t+",style.length="+g.length+",key.length="+m.length+",asig.length="+e.length)}g=g+p+";"}return g},e.surroundByTags=function(t,e,n){return"<"+e+(n?' style="'+n+'"':"")+">"+t+"</"+e+">"},e.htmlEntities=function(t){return t.replace(new RegExp("&","g"),"&amp;").replace(new RegExp('"',"g"),"&quot;").replace(new RegExp("'","g"),"&prime;").replace(new RegExp("<","g"),"&lt;").replace(new RegExp(">","g"),"&gt;")},e.toInitialCapital=function(t){for(var e=t.split(" "),n="",r=0;r<e.length;r++){var i=e[r],s=i.substring(0,1);i=i.substring(1),n+=(s=s.toUpperCase())+i}return n.substring(0,n.length)},e.toSmallCaps=function(t,e){var n,r,i="";if(r=i,(n=e)&&n.equals?n.equals(r):n===r)i=t;else for(var s=t.split(""),a=0;a<s.length;a++){var o=s[a];if(function(t){return null==t.charCodeAt?t:t.charCodeAt(0)}(o)>=(null=="a".charCodeAt?"a":"a".charCodeAt(0))&&function(t){return null==t.charCodeAt?t:t.charCodeAt(0)}(o)<=(null=="z".charCodeAt?"z":"z".charCodeAt(0))){var l=new String(o).toString();l=l.toUpperCase(),i+='<font style="font-size:'+parseFloat(e)/1.28+'px">'+l+"</font>"}else i+=o}return i},e.getStyleMap=function(t,e){for(var n={},r=t.split(";"),i=0;i<r.length;i++){var s=r[i],a=s.indexOf(e),o=s.substring(0,a),l=s.substring(a+1);n[o]=l}return n},e.isInsideTriangle=function(t,e,n,r,i,s,a,o){function l(t,e,n,r,i,s){return(t-i)*(r-s)-(n-i)*(e-s)}var u=l(t,e,n,r,i,s),h=l(t,e,i,s,a,o),g=l(t,e,a,o,n,r);return!((u<0||h<0||g<0)&&(u>0||h>0||g>0))},e}()).screenCoordinatesPerCm=40,i.CENTIMETERS_PER_INCHES=2.54,r.mxVsdxUtils=i,i.__class="com.mxgraph.io.vsdx.mxVsdxUtils"}(com||(com={})),function(t){var e,n,r,i;e=t.mxgraph||(t.mxgraph={}),n=e.io||(e.io={}),r=n.vsdx||(n.vsdx={}),i=function(){function t(t,e,n,r){this.values=null,this.charIndices=null,this.fields=null,this.paraIndex=null,this.values=[],this.values.push(t),this.charIndices=[],this.charIndices.push(e),this.fields=[],this.fields.push(r),this.paraIndex=n}return t.prototype.addText=function(t,e,n){this.values.push(t),this.charIndices.push(e),this.fields.push(n)},t.prototype.getParagraphIndex=function(){return this.paraIndex},t.prototype.getValue=function(t){return this.values[t]},t.prototype.numValues=function(){return this.values.length},t.prototype.getChar=function(t){return this.charIndices[t]},t.prototype.getField=function(t){return this.fields[t]},t}(),r.Paragraph=i,i.__class="com.mxgraph.io.vsdx.Paragraph"}(com||(com={})),function(t){var e,n,r,i;e=t.mxgraph||(t.mxgraph={}),n=e.io||(e.io={}),r=n.vsdx||(n.vsdx={}),i=function(){function e(t){this.elem=null,this.elem=t}return e.prototype.getIndexedCell=function(e,n){for(var r,i,s=t.mxgraph.io.vsdx.mxVsdxUtils.getDirectChildNamedElements(this.elem,"Row"),a=0;a<s.length;a++){var o=s[a],l=o.getAttribute("IX");if(i=e,((r=l)&&r.equals?r.equals(i):r===i)||null==e)for(var u=t.mxgraph.io.vsdx.mxVsdxUtils.getDirectChildNamedElements(o,"Cell"),h=0;h<u.length;h++){var g=u[h];if(function(t,e){return t&&t.equals?t.equals(e):t===e}(l=g.getAttribute("N"),n))return g}}return null},e}(),r.Section=i,i.__class="com.mxgraph.io.vsdx.Section"}(com||(com={})),function(t){var e,n,r,i;e=t.mxgraph||(t.mxgraph={}),n=e.io||(e.io={}),r=n.vsdx||(n.vsdx={}),i=function(){function t(t,e){this.pageNumber=0,this.Id=0,this.pageNumber=t,this.Id=e}return t.prototype.getId=function(){return this.Id},t.prototype.getPageNumber=function(){return this.pageNumber},t.prototype.equals=function(t){if(null==t||this.constructor!==t.constructor)return!1;var e=t;return this.pageNumber===e.pageNumber&&this.Id===e.Id},t.prototype.hashCode=function(){return 1e5*this.pageNumber+this.Id},t}(),r.ShapePageId=i,i.__class="com.mxgraph.io.vsdx.ShapePageId"}(com||(com={})),function(t){var e,n,r,i,s;e=t.mxgraph||(t.mxgraph={}),n=e.io||(e.io={}),r=n.vsdx||(n.vsdx={}),i=r.theme||(r.theme={}),s=function(){function e(t,e,n){this.red=0,this.green=0,this.blue=0,this.gradientClr=null,this.red=t,this.green=e,this.blue=n}return e.NONE_$LI$=function(){return null==e.NONE&&(e.NONE=new e(-1,-1,-1)),e.NONE},e.prototype.getRed=function(){return this.red},e.prototype.setRed=function(t){this.red=t},e.prototype.getGreen=function(){return this.green},e.prototype.setGreen=function(t){this.green=t},e.prototype.getBlue=function(){return this.blue},e.prototype.setBlue=function(t){this.blue=t},e.prototype.toHsl=function(){var e,n,r=this.getRed()/255,i=this.getGreen()/255,s=this.getBlue()/255,a=Math.max(r,Math.max(i,s)),o=Math.min(r,Math.min(i,s)),l=(a+o)/2;if(a===o)e=n=0;else{var u=a-o;n=l>.5?u/(2-a-o):u/(a+o),e=a===r?(i-s)/u+(i<s?6:0):a===i?(s-r)/u+2:(r-i)/u+4,e/=6}return new t.mxgraph.io.vsdx.theme.HSLColor(e,n,l)},e.prototype.toHsv=function(){var e,n,r=this.getRed()/255,i=this.getGreen()/255,s=this.getBlue()/255,a=Math.max(r,Math.max(i,s)),o=Math.min(r,Math.min(i,s)),l=a,u=a-o;return n=0===a?0:u/a,a===o?e=0:(e=a===r?(i-s)/u+(i<s?6:0):a===i?(s-r)/u+2:(r-i)/u+4,e/=6),new t.mxgraph.io.vsdx.theme.HSVColor(e,n,l)},e.decodeColorHex=function(t){var n=parseInt(t,16);return new e(n>>16&255,n>>8&255,255&n)},e.prototype.toHexStr=function(){var t=this.red.toString(16);t=1==t.length?"0"+t:t;var e=this.green.toString(16);e=1==e.length?"0"+e:e;var n=this.blue.toString(16);return"#"+t+e+(1==n.length?"0"+n:n)},e.prototype.getGradientClr=function(){return this.gradientClr},e.prototype.setGradientClr=function(t){this.gradientClr=t},e}(),i.Color=s,s.__class="com.mxgraph.io.vsdx.theme.Color"}(com||(com={})),function(t){var e,n,r,i,s;e=t.mxgraph||(t.mxgraph={}),n=e.io||(e.io={}),r=n.vsdx||(n.vsdx={}),i=r.theme||(r.theme={}),s=function(){function e(){}return e.getFillStyle=function(e){var n=null;switch(e.nodeName){case"a:solidFill":n=new t.mxgraph.io.vsdx.theme.SolidFillStyle(t.mxgraph.io.vsdx.theme.OoxmlColorFactory.getOoxmlColor(t.mxgraph.io.vsdx.mxVsdxUtils.getDirectFirstChildElement(e)));break;case"a:noFill":n=new t.mxgraph.io.vsdx.theme.NoFillStyle;break;case"a:gradFill":n=new t.mxgraph.io.vsdx.theme.GradFill(e)}return n},e}(),i.FillStyleFactory=s,s.__class="com.mxgraph.io.vsdx.theme.FillStyleFactory"}(com||(com={})),function(t){var e,n,r,i,s;e=t.mxgraph||(t.mxgraph={}),n=e.io||(e.io={}),r=n.vsdx||(n.vsdx={}),i=r.theme||(r.theme={}),s=function(){function e(e){this.color1=null,this.color2=null;var n=t.mxgraph.io.vsdx.mxVsdxUtils.getDirectChildNamedElements(e,"a:gsLst");if(n.length>0){var r=t.mxgraph.io.vsdx.mxVsdxUtils.getDirectChildElements(n[0]);r.length>=2&&(this.color2=t.mxgraph.io.vsdx.theme.OoxmlColorFactory.getOoxmlColor(t.mxgraph.io.vsdx.mxVsdxUtils.getDirectFirstChildElement(r[0])),this.color1=t.mxgraph.io.vsdx.theme.OoxmlColorFactory.getOoxmlColor(t.mxgraph.io.vsdx.mxVsdxUtils.getDirectFirstChildElement(r[r.length-1])))}null==this.color1&&(this.color1=this.color2=new t.mxgraph.io.vsdx.theme.SrgbClr("FFFFFF"))}return e.prototype.applyStyle=function(t,e){var n=this.color1.getColor$int$com_mxgraph_io_vsdx_mxVsdxTheme(t,e);return n.setGradientClr(this.color2.getColor$int$com_mxgraph_io_vsdx_mxVsdxTheme(t,e)),n},e}(),i.GradFill=s,s.__class="com.mxgraph.io.vsdx.theme.GradFill",s.__interfaces=["com.mxgraph.io.vsdx.theme.FillStyle"]}(com||(com={})),function(t){var e,n,r,i,s;e=t.mxgraph||(t.mxgraph={}),n=e.io||(e.io={}),r=n.vsdx||(n.vsdx={}),i=r.theme||(r.theme={}),s=function(){function e(t,e,n){this.hue=0,this.sat=0,this.lum=0,this.hue=t,this.sat=e,this.lum=n}return e.prototype.getHue=function(){return this.hue},e.prototype.setHue=function(t){this.hue=t},e.prototype.getSat=function(){return this.sat},e.prototype.setSat=function(t){this.sat=t},e.prototype.getLum=function(){return this.lum},e.prototype.setLum=function(t){this.lum=t},e.prototype.hue2rgb=function(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+6*(e-t)*n:n<.5?e:n<2/3?t+(e-t)*(2/3-n)*6:t},e.prototype.toRgb=function(){var e,n,r,i=this.hue,s=this.sat,a=this.lum;if(0===s)e=n=r=a;else{var o=a<.5?a*(1+s):a+s-a*s,l=2*a-o;e=this.hue2rgb(l,o,i+1/3),n=this.hue2rgb(l,o,i),r=this.hue2rgb(l,o,i-1/3)}return new t.mxgraph.io.vsdx.theme.Color(255*e|0,255*n|0,255*r|0)},e.prototype.clamp01=function(t){return Math.min(1,Math.max(0,t))},e.prototype.tint=function(t){return this.lum*=1+t/100,this.lum=this.clamp01(this.lum),this},e.prototype.shade=function(t){return this.lum*=t/100,this.lum=this.clamp01(this.lum),this},e.prototype.satMod=function(t){return this.sat*=t/100,this.sat=this.clamp01(this.sat),this},e.prototype.lumMod=function(t){return this.lum*=t/100,this.lum=this.clamp01(this.lum),this},e}(),i.HSLColor=s,s.__class="com.mxgraph.io.vsdx.theme.HSLColor"}(com||(com={})),function(t){var e,n,r,i,s;e=t.mxgraph||(t.mxgraph={}),n=e.io||(e.io={}),r=n.vsdx||(n.vsdx={}),i=r.theme||(r.theme={}),s=function(){function e(t,e,n){this.h=0,this.s=0,this.v=0,this.h=t,this.s=e,this.v=n}return e.prototype.toRgb=function(){var e=6*this.h,n=this.s,r=(this.v,Math.floor(e)),i=e-r,s=this.v*(1-n),a=this.v*(1-i*n),o=this.v*(1-(1-i)*n),l=(0|r)%6,u=[this.v,a,s,s,o,this.v],h=[o,this.v,this.v,a,s,s],g=[s,s,o,this.v,this.v,a],c=u[l],x=h[l],m=g[l];return new t.mxgraph.io.vsdx.theme.Color(255*c|0,255*x|0,255*m|0)},e.prototype.clamp01=function(t){return Math.min(1,Math.max(0,t))},e.prototype.tint=function(t){return this.v*=1+t/100,this.v=this.clamp01(this.v),this},e.prototype.shade=function(t){return this.v*=t/100,this.v=this.clamp01(this.v),this},e.prototype.satMod=function(t){return this.s*=t/100,this.s=this.clamp01(this.s),this},e.prototype.lumMod=function(t){return this.v*=t/100,this.v=this.clamp01(this.v),this},e.prototype.hueMod=function(t){return this.h*=t/100,this.h=this.clamp01(this.h),this},e}(),i.HSVColor=s,s.__class="com.mxgraph.io.vsdx.theme.HSVColor"}(com||(com={})),function(t){var e,n,r,i,s;e=t.mxgraph||(t.mxgraph={}),n=e.io||(e.io={}),r=n.vsdx||(n.vsdx={}),i=r.theme||(r.theme={}),s=function(){function e(n){var r=this;if(this.isLineDashed=!1,this.lineDashPattern=[],this.isRoundJoin=!1,this.isBevelJoin=!1,this.isMiterJoin=!1,null!=n&&1==n.nodeType||null===n)Array.prototype.slice.call(arguments),this.lineWidth=0,this.lineCap=null,this.lineComp=null,this.fillStyle=null,this.headEndType=null,this.headEndWidth=0,this.headEndLen=0,this.tailEndType=null,this.tailEndWidth=0,this.tailEndLen=0,this.isLineDashed=!1,this.lineDashPattern=[],this.isRoundJoin=!1,this.isBevelJoin=!1,this.isMiterJoin=!1,this.lineWidth=0,this.lineCap=null,this.lineComp=null,this.fillStyle=null,this.headEndType=null,this.headEndWidth=0,this.headEndLen=0,this.tailEndType=null,this.tailEndWidth=0,this.tailEndLen=0,function(){r.lineWidth=t.mxgraph.io.vsdx.mxVsdxUtils.getIntAttr$org_w3c_dom_Element$java_lang_String(n,"w");var i=n.getAttribute("cap");if(null!=i)switch(i){case"rnd":r.lineCap=e.LineCapType.ROUND;break;case"sq":r.lineCap=e.LineCapType.SQUARE;break;case"flat":r.lineCap=e.LineCapType.FLAT}var s=n.getAttribute("cmpd");if(null!=s)switch(s){case"sng":r.lineComp=e.CompoundLineType.SINGLE;break;case"dbl":r.lineComp=e.CompoundLineType.DOUBLE;break;case"thickThin":r.lineComp=e.CompoundLineType.THICK_THIN_DOUBLE;break;case"thinThick":r.lineComp=e.CompoundLineType.THIN_THICK_DOUBLE;break;case"tri":r.lineComp=e.CompoundLineType.THIN_THICK_THIN_TRIPLE}for(var a=t.mxgraph.io.vsdx.mxVsdxUtils.getDirectChildElements(n),o=0;o<a.length;o++){var l=a[o];switch(l.nodeName){case"a:noFill":case"a:solidFill":case"a:gradFill":case"a:pattFill":r.fillStyle=t.mxgraph.io.vsdx.theme.FillStyleFactory.getFillStyle(l);break;case"a:prstDash":var u=l.getAttribute("val");switch(r.isLineDashed=!0,u){case"solid":r.isLineDashed=!1;break;case"sysDot":case"dot":r.lineDashPattern.push(1),r.lineDashPattern.push(4);break;case"sysDash":case"dash":break;case"lgDash":r.lineDashPattern.push(12),r.lineDashPattern.push(4);break;case"sysDashDot":case"dashDot":r.lineDashPattern.push(8),r.lineDashPattern.push(4),r.lineDashPattern.push(1),r.lineDashPattern.push(4);break;case"lgDashDot":r.lineDashPattern.push(12),r.lineDashPattern.push(4),r.lineDashPattern.push(1),r.lineDashPattern.push(4);break;case"sysDashDotDot":case"lgDashDotDot":r.lineDashPattern.push(12),r.lineDashPattern.push(4),r.lineDashPattern.push(1),r.lineDashPattern.push(4),r.lineDashPattern.push(1),r.lineDashPattern.push(4)}break;case"a:custDash":r.isLineDashed=!0;for(var h=t.mxgraph.io.vsdx.mxVsdxUtils.getDirectChildNamedElements(l,"a:ds"),g=0;g<h.length;g++){var c=h[g],x=t.mxgraph.io.vsdx.mxVsdxUtils.getIntAttr$org_w3c_dom_Element$java_lang_String(c,"d"),m=t.mxgraph.io.vsdx.mxVsdxUtils.getIntAttr$org_w3c_dom_Element$java_lang_String(c,"sp");r.lineDashPattern.push(x/1e4),r.lineDashPattern.push(m/1e4)}break;case"a:round":r.isRoundJoin=!0;break;case"a:bevel":r.isBevelJoin=!0;break;case"a:miter":t.mxgraph.io.vsdx.mxVsdxUtils.getIntAttr$org_w3c_dom_Element$java_lang_String(l,"lim"),r.isMiterJoin=!0;break;case"a:headEnd":r.headEndType=r.getLineEndType(l),r.headEndWidth=t.mxgraph.io.vsdx.mxVsdxUtils.getIntAttr$org_w3c_dom_Element$java_lang_String(l,"w"),r.headEndLen=t.mxgraph.io.vsdx.mxVsdxUtils.getIntAttr$org_w3c_dom_Element$java_lang_String(l,"len");break;case"a:tailEnd":r.tailEndType=r.getLineEndType(l),r.tailEndWidth=t.mxgraph.io.vsdx.mxVsdxUtils.getIntAttr$org_w3c_dom_Element$java_lang_String(l,"w"),r.tailEndLen=t.mxgraph.io.vsdx.mxVsdxUtils.getIntAttr$org_w3c_dom_Element$java_lang_String(l,"len")}}}();else{if(void 0!==n)throw new Error("invalid overload");Array.prototype.slice.call(arguments),this.lineWidth=0,this.lineCap=null,this.lineComp=null,this.fillStyle=null,this.headEndType=null,this.headEndWidth=0,this.headEndLen=0,this.tailEndType=null,this.tailEndWidth=0,this.tailEndLen=0,this.isLineDashed=!1,this.lineDashPattern=[],this.isRoundJoin=!1,this.isBevelJoin=!1,this.isMiterJoin=!1,this.lineWidth=0,this.lineCap=null,this.lineComp=null,this.fillStyle=null,this.headEndType=null,this.headEndWidth=0,this.headEndLen=0,this.tailEndType=null,this.tailEndWidth=0,this.tailEndLen=0}}return e.prototype.getLineEndType=function(t){var n=null;switch(t.getAttribute("type")){case"none":n=e.LineEndType.NONE;break;case"triangle":n=e.LineEndType.TRIANGLE;break;case"stealth":n=e.LineEndType.STEALTH;break;case"diamond":n=e.LineEndType.DIAMOND;break;case"oval":n=e.LineEndType.OVAL;break;case"arrow":n=e.LineEndType.ARROW}return n},e.prototype.getLineColor=function(t,e){return null!=this.fillStyle?this.fillStyle.applyStyle(t,e):e.getDefaultLineClr()},e.prototype.isDashed=function(){return this.isLineDashed},e.prototype.getLineDashPattern=function(){return this.lineDashPattern},e.prototype.getStartSize=function(){return 4},e.prototype.getEndSize=function(){return 4},e.prototype.getStart=function(){return 0},e.prototype.getEnd=function(){return 0},e.prototype.getLineWidth=function(){return this.lineWidth},e}(),i.LineStyle=s,s.__class="com.mxgraph.io.vsdx.theme.LineStyle",function(t){var e,n,r;(r=t.LineCapType||(t.LineCapType={}))[r.ROUND=0]="ROUND",r[r.SQUARE=1]="SQUARE",r[r.FLAT=2]="FLAT",(n=t.CompoundLineType||(t.CompoundLineType={}))[n.SINGLE=0]="SINGLE",n[n.DOUBLE=1]="DOUBLE",n[n.THICK_THIN_DOUBLE=2]="THICK_THIN_DOUBLE",n[n.THIN_THICK_DOUBLE=3]="THIN_THICK_DOUBLE",n[n.THIN_THICK_THIN_TRIPLE=4]="THIN_THICK_THIN_TRIPLE",(e=t.LineEndType||(t.LineEndType={}))[e.NONE=0]="NONE",e[e.TRIANGLE=1]="TRIANGLE",e[e.STEALTH=2]="STEALTH",e[e.DIAMOND=3]="DIAMOND",e[e.OVAL=4]="OVAL",e[e.ARROW=5]="ARROW"}(s=i.LineStyle||(i.LineStyle={}))}(com||(com={})),function(t){var e,n,r,i,s;e=t.mxgraph||(t.mxgraph={}),n=e.io||(e.io={}),r=n.vsdx||(n.vsdx={}),i=r.theme||(r.theme={}),s=function(){function e(e){this.rndg=0,this.start=0,this.startSize=0,this.end=0,this.endSize=0,this.pattern=0,this.lineDashPattern=null;var n=t.mxgraph.io.vsdx.mxVsdxUtils.getDirectFirstChildElement(e);this.rndg=t.mxgraph.io.vsdx.mxVsdxUtils.getIntAttr$org_w3c_dom_Element$java_lang_String(n,"rndg"),this.start=t.mxgraph.io.vsdx.mxVsdxUtils.getIntAttr$org_w3c_dom_Element$java_lang_String(n,"start"),this.startSize=t.mxgraph.io.vsdx.mxVsdxUtils.getIntAttr$org_w3c_dom_Element$java_lang_String(n,"startSize"),this.end=t.mxgraph.io.vsdx.mxVsdxUtils.getIntAttr$org_w3c_dom_Element$java_lang_String(n,"end"),this.endSize=t.mxgraph.io.vsdx.mxVsdxUtils.getIntAttr$org_w3c_dom_Element$java_lang_String(n,"endSize"),this.pattern=t.mxgraph.io.vsdx.mxVsdxUtils.getIntAttr$org_w3c_dom_Element$java_lang_String(n,"pattern"),this.lineDashPattern=t.mxgraph.io.vsdx.Style.getLineDashPattern(this.pattern)}return e.prototype.getRndg=function(){return this.rndg},e.prototype.getStart=function(){return this.start},e.prototype.getStartSize=function(){return this.startSize},e.prototype.getEnd=function(){return this.end},e.prototype.getEndSize=function(){return this.endSize},e.prototype.isDashed=function(){return this.pattern>1},e.prototype.getLineDashPattern=function(){return this.lineDashPattern},e}(),i.LineStyleExt=s,s.__class="com.mxgraph.io.vsdx.theme.LineStyleExt"}(com||(com={})),function(t){var e,n,r,i,s;e=t.mxgraph||(t.mxgraph={}),n=e.io||(e.io={}),r=n.vsdx||(n.vsdx={}),i=r.theme||(r.theme={}),s=function(){function e(){}return e.prototype.applyStyle=function(e,n){return t.mxgraph.io.vsdx.theme.Color.NONE_$LI$()},e}(),i.NoFillStyle=s,s.__class="com.mxgraph.io.vsdx.theme.NoFillStyle",s.__interfaces=["com.mxgraph.io.vsdx.theme.FillStyle"]}(com||(com={})),function(t){var e,n,r,i,s;e=t.mxgraph||(t.mxgraph={}),n=e.io||(e.io={}),r=n.vsdx||(n.vsdx={}),i=r.theme||(r.theme={}),s=function(){function e(){this.tint=0,this.shade=0,this.comp=0,this.inv=0,this.gray=0,this.alpha=0,this.alphaOff=0,this.alphaMod=0,this.hue=0,this.hueOff=0,this.hueMod=0,this.sat=0,this.satOff=0,this.satMod=0,this.lum=0,this.lumOff=0,this.lumMod=0,this.red=0,this.redOff=0,this.redMod=0,this.green=0,this.greenOff=0,this.greenMod=0,this.blue=0,this.blueOff=0,this.blueMod=0,this.gamma=0,this.invGamma=0,this.isDynamic=!1,this.isInitialized=!1,this.hasEffects=!1,this.color=null}return e.prototype.calcColor=function(t,e){if(this.hasEffects){var n=this.color.toHsv();0!==this.tint&&n.tint(this.tint),0!==this.shade&&n.shade(this.shade),0!==this.satMod&&n.satMod(this.satMod),0!==this.lumMod&&n.lumMod(this.lumMod),0!==this.hueMod&&n.hueMod(this.hueMod),this.color=n.toRgb()}},e.prototype.getColor$int$com_mxgraph_io_vsdx_mxVsdxTheme=function(t,e){return!this.isDynamic&&this.isInitialized||(this.calcColor(t,e),this.isInitialized=!0),this.color},e.prototype.getColor=function(e,n){if("number"!=typeof e&&null!==e||!(null!=n&&n instanceof t.mxgraph.io.vsdx.mxVsdxTheme||null===n)){if((null!=e&&e instanceof t.mxgraph.io.vsdx.mxVsdxTheme||null===e)&&void 0===n)return this.getColor$com_mxgraph_io_vsdx_mxVsdxTheme(e);throw new Error("invalid overload")}return this.getColor$int$com_mxgraph_io_vsdx_mxVsdxTheme(e,n)},e.prototype.getColor$com_mxgraph_io_vsdx_mxVsdxTheme=function(t){return this.getColor$int$com_mxgraph_io_vsdx_mxVsdxTheme(-1,t)},e.prototype.setTint=function(t){this.tint=t,this.hasEffects=!0},e.prototype.setShade=function(t){this.shade=t,this.hasEffects=!0},e.prototype.setComp=function(t){this.comp=t,this.hasEffects=!0},e.prototype.setInv=function(t){this.inv=t,this.hasEffects=!0},e.prototype.setGray=function(t){this.gray=t,this.hasEffects=!0},e.prototype.setAlpha=function(t){this.alpha=t,this.hasEffects=!0},e.prototype.setAlphaOff=function(t){this.alphaOff=t,this.hasEffects=!0},e.prototype.setAlphaMod=function(t){this.alphaMod=t,this.hasEffects=!0},e.prototype.setHue=function(t){this.hue=t,this.hasEffects=!0},e.prototype.setHueOff=function(t){this.hueOff=t,this.hasEffects=!0},e.prototype.setHueMod=function(t){this.hueMod=t,this.hasEffects=!0},e.prototype.setSat=function(t){this.sat=t,this.hasEffects=!0},e.prototype.setSatOff=function(t){this.satOff=t,this.hasEffects=!0},e.prototype.setSatMod=function(t){this.satMod=t,this.hasEffects=!0},e.prototype.setLum=function(t){this.lum=t,this.hasEffects=!0},e.prototype.setLumOff=function(t){this.lumOff=t,this.hasEffects=!0},e.prototype.setLumMod=function(t){this.lumMod=t,this.hasEffects=!0},e.prototype.setRed=function(t){this.red=t,this.hasEffects=!0},e.prototype.setRedOff=function(t){this.redOff=t,this.hasEffects=!0},e.prototype.setRedMod=function(t){this.redMod=t,this.hasEffects=!0},e.prototype.setGreen=function(t){this.green=t,this.hasEffects=!0},e.prototype.setGreenOff=function(t){this.greenOff=t,this.hasEffects=!0},e.prototype.setGreenMod=function(t){this.greenMod=t,this.hasEffects=!0},e.prototype.setBlue=function(t){this.blue=t,this.hasEffects=!0},e.prototype.setBlueOff=function(t){this.blueOff=t,this.hasEffects=!0},e.prototype.setBlueMod=function(t){this.blueMod=t,this.hasEffects=!0},e.prototype.setGamma=function(t){this.gamma=t,this.hasEffects=!0},e.prototype.setInvGamma=function(t){this.invGamma=t,this.hasEffects=!0},e}(),i.OoxmlColor=s,s.__class="com.mxgraph.io.vsdx.theme.OoxmlColor"}(com||(com={})),function(t){var e,n,r,i,s;e=t.mxgraph||(t.mxgraph={}),n=e.io||(e.io={}),r=n.vsdx||(n.vsdx={}),i=r.theme||(r.theme={}),s=function(){function e(){}return e.getOoxmlColor=function(e){var n=null;switch(e.nodeName){case"a:scrgbClr":n=new t.mxgraph.io.vsdx.theme.ScrgbClr(parseInt(e.getAttribute("r")),parseInt(e.getAttribute("g")),parseInt(e.getAttribute("b")));break;case"a:srgbClr":case"a:prstClr":n=new t.mxgraph.io.vsdx.theme.SrgbClr(e.getAttribute("val"));break;case"a:hslClr":n=new t.mxgraph.io.vsdx.theme.HslClr(parseInt(e.getAttribute("hue")),parseInt(e.getAttribute("sat")),parseInt(e.getAttribute("lum")));break;case"a:sysClr":n=new t.mxgraph.io.vsdx.theme.SysClr(e.getAttribute("val"),e.getAttribute("lastClr"));break;case"a:schemeClr":n=new t.mxgraph.io.vsdx.theme.SchemeClr(e.getAttribute("val"))}for(var r=t.mxgraph.io.vsdx.mxVsdxUtils.getDirectChildElements(e),i=0;i<r.length;i++){var s=r[i],a=parseInt(s.getAttribute("val"))/1e3|0;switch(s.nodeName){case"a:tint":n.setTint(a);break;case"a:shade":n.setShade(a);break;case"a:satMod":n.setSatMod(a);break;case"a:lumMod":n.setLumMod(a);break;case"a:hueMod":n.setHueMod(a)}}return n},e}(),i.OoxmlColorFactory=s,s.__class="com.mxgraph.io.vsdx.theme.OoxmlColorFactory"}(com||(com={})),function(t){var e,n,r,i,s;e=t.mxgraph||(t.mxgraph={}),n=e.io||(e.io={}),r=n.vsdx||(n.vsdx={}),i=r.theme||(r.theme={}),s=function(){function t(t,e,n,r,i,s,a,o,l,u){this.quickStyleEffectsMatrix=0,this.quickStyleFillColor=0,this.quickStyleFillMatrix=0,this.quickStyleFontColor=0,this.quickStyleFontMatrix=0,this.quickStyleLineColor=0,this.quickStyleLineMatrix=0,this.quickStyleShadowColor=0,this.quickStyleType=0,this.quickStyleVariation=0,this.quickStyleEffectsMatrix=t,this.quickStyleFillColor=e,this.quickStyleFillMatrix=n,this.quickStyleFontColor=r,this.quickStyleFontMatrix=i,this.quickStyleLineColor=s,this.quickStyleLineMatrix=a,this.quickStyleShadowColor=o,this.quickStyleType=l,this.quickStyleVariation=u}return t.prototype.getQuickStyleEffectsMatrix=function(){return this.quickStyleEffectsMatrix},t.prototype.getQuickStyleFillColor=function(){return this.quickStyleFillColor},t.prototype.getQuickStyleFillMatrix=function(){return this.quickStyleFillMatrix},t.prototype.getQuickStyleFontColor=function(){return this.quickStyleFontColor},t.prototype.getQuickStyleFontMatrix=function(){return this.quickStyleFontMatrix},t.prototype.getQuickStyleLineColor=function(){return this.quickStyleLineColor},t.prototype.getQuickStyleLineMatrix=function(){return this.quickStyleLineMatrix},t.prototype.getQuickStyleShadowColor=function(){return this.quickStyleShadowColor},t.prototype.getQuickStyleType=function(){return this.quickStyleType},t.prototype.getQuickStyleVariation=function(){return this.quickStyleVariation},t.prototype.setQuickStyleEffectsMatrix=function(t){this.quickStyleEffectsMatrix=t},t.prototype.setQuickStyleFillColor=function(t){this.quickStyleFillColor=t},t.prototype.setQuickStyleFillMatrix=function(t){this.quickStyleFillMatrix=t},t.prototype.setQuickStyleFontColor=function(t){this.quickStyleFontColor=t},t.prototype.setQuickStyleFontMatrix=function(t){this.quickStyleFontMatrix=t},t.prototype.setQuickStyleLineColor=function(t){this.quickStyleLineColor=t},t.prototype.setQuickStyleLineMatrix=function(t){this.quickStyleLineMatrix=t},t.prototype.setQuickStyleShadowColor=function(t){this.quickStyleShadowColor=t},t.prototype.setQuickStyleType=function(t){this.quickStyleType=t},t.prototype.setQuickStyleVariation=function(t){this.quickStyleVariation=t},t}(),i.QuickStyleVals=s,s.__class="com.mxgraph.io.vsdx.theme.QuickStyleVals"}(com||(com={})),function(t){var e,n,r,i,s;e=t.mxgraph||(t.mxgraph={}),n=e.io||(e.io={}),r=n.vsdx||(n.vsdx={}),i=r.theme||(r.theme={}),s=function(){function t(t){this.color=null,this.color=t}return t.prototype.applyStyle=function(t,e){return this.color.getColor$int$com_mxgraph_io_vsdx_mxVsdxTheme(t,e)},t}(),i.SolidFillStyle=s,s.__class="com.mxgraph.io.vsdx.theme.SolidFillStyle",s.__interfaces=["com.mxgraph.io.vsdx.theme.FillStyle"]}(com||(com={})),function(t){var e,n,r;e=t.mxgraph||(t.mxgraph={}),n=e.online||(e.online={}),(r=function(){function t(){}return t.MAX_AREA_$LI$=function(){return null==t.MAX_AREA&&(t.MAX_AREA=1e8),t.MAX_AREA},t}()).MAX_REQUEST_SIZE=52428800,r.IMAGE_DOMAIN="http://img.diagramly.com/",n.Constants=r,r.__class="com.mxgraph.online.Constants"}(com||(com={})),function(t){var e,n,r;e=t.mxgraph||(t.mxgraph={}),n=e.online||(e.online={}),(r=function(){function t(){}return t.getRotatedPoint=function(t,e,n,r){var i=t.x-r.x,s=t.y-r.y,a=s*e+i*n;return new mxPoint(i*e-s*n+r.x,a+r.y)},t.rotatedGeometry=function(t,e,n,r){e=function(t){return t*Math.PI/180}(e);var i=Math.cos(e),s=Math.sin(e),a=t.getCenterX()-n,o=t.getCenterY()-r,l=a*i-o*s,u=o*i+a*s;t.x=Math.round(l+n-t.width/2),t.y=Math.round(u+r-t.height/2)},t}()).CHARSET_FOR_URL_ENCODING="ISO-8859-1",n.Utils=r,r.__class="com.mxgraph.online.Utils"}(com||(com={})),function(t){var e,n,r,i,s;e=t.mxgraph||(t.mxgraph={}),n=e.io||(e.io={}),r=n.vsdx||(n.vsdx={}),i=r.geometry||(r.geometry={}),s=function(e){function n(t,n,r,i){var s=e.call(this,t,n,r)||this;return s.a=i,s}return __extends(n,e),n.prototype.handle=function(e,n){if(null!=this.x&&null!=this.y&&null!=this.a){var r=n.getHeight(),i=n.getWidth(),s=Math.floor(Math.round(n.getLastX()*i)/100),a=Math.floor(Math.round(n.getLastY()*r)/100),o=this.x*t.mxgraph.io.vsdx.mxVsdxUtils.conversionFactor_$LI$(),l=this.y*t.mxgraph.io.vsdx.mxVsdxUtils.conversionFactor_$LI$();l=r-l;var u=this.a*t.mxgraph.io.vsdx.mxVsdxUtils.conversionFactor_$LI$(),h=Math.abs(o-s),g=Math.abs(l-a),c=.5*u+(h*h+g*g)/(8*u),x=c,m=Math.abs(c);c=100*c/i,x=100*x/r,o=100*o/i,l=100*l/r,c=Math.round(100*c)/100,x=Math.round(100*x)/100,o=Math.round(100*o)/100,l=Math.round(100*l)/100,u=Math.round(100*u)/100,c=Math.abs(c),x=Math.abs(x);var p=u<0?"1":"0",d=m<Math.abs(u)?"1":"0";return n.setLastX(o),n.setLastY(l),'<arc rx="'+new String(c).toString()+'" ry="'+new String(x).toString()+'" x="'+new String(o).toString()+'" y="'+new String(l).toString()+'" x-axis-rotation="0" large-arc-flag="'+d+'" sweep-flag="'+p+'"/>'}return""},n}(t.mxgraph.io.vsdx.geometry.Row),i.ArcTo=s,s.__class="com.mxgraph.io.vsdx.geometry.ArcTo"}(com||(com={})),function(t){var e,n,r,i,s;e=t.mxgraph||(t.mxgraph={}),n=e.io||(e.io={}),r=n.vsdx||(n.vsdx={}),i=r.geometry||(r.geometry={}),s=function(t){function e(e){return t.call(this,e,null,null)||this}return __extends(e,t),e.prototype.handle=function(t,e){return""},e}(t.mxgraph.io.vsdx.geometry.Row),i.DelRow=s,s.__class="com.mxgraph.io.vsdx.geometry.DelRow"}(com||(com={})),function(t){var e,n,r,i,s;e=t.mxgraph||(t.mxgraph={}),n=e.io||(e.io={}),r=n.vsdx||(n.vsdx={}),i=r.geometry||(r.geometry={}),s=function(e){function n(t,n,r,i,s,a,o){var l=e.call(this,t,n,r)||this;return l.a=i,l.b=s,l.c=a,l.d=o,l}return __extends(n,e),n.prototype.handle=function(e,n){if(null!=this.x&&null!=this.y&&null!=this.a&&null!=this.b&&null!=this.c&&null!=this.d){var r=n.getHeight(),i=n.getWidth(),s=this.x*t.mxgraph.io.vsdx.mxVsdxUtils.conversionFactor_$LI$(),a=this.y*t.mxgraph.io.vsdx.mxVsdxUtils.conversionFactor_$LI$();a=r-a;var o=this.a*t.mxgraph.io.vsdx.mxVsdxUtils.conversionFactor_$LI$(),l=this.b*t.mxgraph.io.vsdx.mxVsdxUtils.conversionFactor_$LI$();l=r-l;var u=this.c*t.mxgraph.io.vsdx.mxVsdxUtils.conversionFactor_$LI$(),h=this.d*t.mxgraph.io.vsdx.mxVsdxUtils.conversionFactor_$LI$();h=r-h;var g=Math.abs(o-s),c=Math.abs(l-a),x=Math.sqrt(g*g+c*c),m=Math.abs(u-s),p=Math.abs(h-a),d=100*s/i,v=100*a/r,y=100*x/i/2,f=100*Math.sqrt(m*m+p*p)/r/2;f=Math.round(100*f)/100,y=Math.round(100*y)/100;var _=Math.round(100*(d-2*y))/100,S=Math.round(100*(d+2*y))/100;return v=Math.round(100*v)/100,'<move x="'+new String(_).toString()+'" y="'+new String(v).toString()+'"/><arc rx="'+new String(y).toString()+'" ry="'+new String(f).toString()+'" x="'+new String(S).toString()+'" y="'+new String(v).toString()+'" x-axis-rotation="0" large-arc-flag="1" sweep-flag="0"/><arc rx="'+new String(y).toString()+'" ry="'+new String(f).toString()+'" x="'+new String(_).toString()+'" y="'+new String(v).toString()+'" x-axis-rotation="0" large-arc-flag="1" sweep-flag="0"/>'}return""},n}(t.mxgraph.io.vsdx.geometry.Row),i.Ellipse=s,s.__class="com.mxgraph.io.vsdx.geometry.Ellipse"}(com||(com={})),function(t){var e,n,r,i,s;e=t.mxgraph||(t.mxgraph={}),n=e.io||(e.io={}),r=n.vsdx||(n.vsdx={}),i=r.geometry||(r.geometry={}),s=function(e){function n(t,n,r,i,s,a,o){var l=e.call(this,t,n,r)||this;return l.a=i,l.b=s,l.c=a,l.d=o,l}return __extends(n,e),n.prototype.handle=function(e,n){if(null!=this.x&&null!=this.y&&null!=this.a&&null!=this.b&&null!=this.c&&null!=this.d){var r=n.getHeight(),i=n.getWidth(),s=this.x*t.mxgraph.io.vsdx.mxVsdxUtils.conversionFactor_$LI$(),a=this.y*t.mxgraph.io.vsdx.mxVsdxUtils.conversionFactor_$LI$();a=r-a;var o=this.a*t.mxgraph.io.vsdx.mxVsdxUtils.conversionFactor_$LI$(),l=this.b*t.mxgraph.io.vsdx.mxVsdxUtils.conversionFactor_$LI$(),u=this.c,h=this.d;s=100*s/i,a=100*a/r;var g=n.getLastX()*i/100,c=n.getLastY()*r/100,x=s*i/100,m=a*r/100,p=o,d=r-l,v=-u,y=Math.sqrt(g*g+c*c)*Math.cos(Math.atan2(c,g)-v),f=Math.sqrt(g*g+c*c)*Math.sin(Math.atan2(c,g)-v),_=Math.sqrt(x*x+m*m)*Math.cos(Math.atan2(m,x)-v),S=Math.sqrt(x*x+m*m)*Math.sin(Math.atan2(m,x)-v),C=Math.sqrt(p*p+d*d)*Math.cos(Math.atan2(d,p)-v),I=Math.sqrt(p*p+d*d)*Math.sin(Math.atan2(d,p)-v),L=((y-_)*(y+_)*(S-I)-(_-C)*(_+C)*(f-S)+h*h*(f-S)*(S-I)*(f-I))/(2*((y-_)*(S-I)-(_-C)*(f-S))),A=((y-_)*(_-C)*(y-C)/(h*h)+(_-C)*(f-S)*(f+S)-(y-_)*(S-I)*(S+I))/(2*((_-C)*(f-S)-(y-_)*(S-I))),E=Math.sqrt(L*L+A*A)*Math.cos(Math.atan2(A,L)+v),M=Math.sqrt(L*L+A*A)*Math.sin(Math.atan2(A,L)+v);E=E*i/100,M=M*r/100;var T=y-L,N=f-A,D=Math.sqrt(T*T+N*N*h*h),$=D/h,V=function(t){return 180*t/Math.PI}(v);D=100*D/i,$=100*$/r,s=Math.round(100*s)/100,a=Math.round(100*a)/100,D=Math.round(100*D)/100,$=Math.round(100*$)/100,V=Math.round(100*V)/100;var O=(x-g)*(d-c)-(m-c)*(p-g)>0?"0":"1",k="0";return t.mxgraph.io.vsdx.mxVsdxUtils.isInsideTriangle(L,A,y,f,_,S,C,I)&&(k="1"),n.setLastX(s),n.setLastY(a),'<arc rx="'+new String(D).toString()+'" ry="'+new String($).toString()+'" x="'+new String(s).toString()+'" y="'+new String(a).toString()+'" x-axis-rotation="'+new String(V).toString()+'" large-arc-flag="'+k+'" sweep-flag="'+O+'"/>'}return""},n.prototype.isReflexAngle=function(t,e,n,r,i,s,a,o){n-=t,r-=e,i-=t,s-=e,i=a-t,o-=e,t=0,e=0;var l=180*(Math.atan2(r,n)-Math.atan2(e,t))/Math.PI,u=180*(Math.atan2(s,i)-Math.atan2(e,t))/Math.PI,h=function(t){return 180*t/Math.PI}(Math.atan2(o,a)-Math.atan2(e,t));return(l=(l-h)%360)>180?l-=360:l<-180&&(l+=360),(u=(u-h)%360)>180?u-=360:u<-180&&(u+=360),(l>0&&u<0||l<0&&u>0)&&Math.abs(l-u)>180},n}(t.mxgraph.io.vsdx.geometry.Row),i.EllipticalArcTo=s,s.__class="com.mxgraph.io.vsdx.geometry.EllipticalArcTo"}(com||(com={})),function(t){var e,n,r,i,s;e=t.mxgraph||(t.mxgraph={}),n=e.io||(e.io={}),r=n.vsdx||(n.vsdx={}),i=r.geometry||(r.geometry={}),s=function(t){function e(e,n,r,i,s){var a=t.call(this,e,n,r)||this;return a.a=i,a.b=s,a}return __extends(e,t),e.prototype.handle=function(t,e){return""},e}(t.mxgraph.io.vsdx.geometry.Row),i.InfiniteLine=s,s.__class="com.mxgraph.io.vsdx.geometry.InfiniteLine"}(com||(com={})),function(t){var e,n,r,i,s;e=t.mxgraph||(t.mxgraph={}),n=e.io||(e.io={}),r=n.vsdx||(n.vsdx={}),i=r.geometry||(r.geometry={}),s=function(e){function n(t,n,r){return e.call(this,t,n,r)||this}return __extends(n,e),n.prototype.handle=function(e,n){var r=e.x,i=e.y,s=n.getHeight(),a=n.getWidth();return null!=this.x&&null!=this.y&&(r=this.x*t.mxgraph.io.vsdx.mxVsdxUtils.conversionFactor_$LI$(),i=this.y*t.mxgraph.io.vsdx.mxVsdxUtils.conversionFactor_$LI$()),r=100*r/a,i=100-(i=100*i/s),r=Math.round(100*r)/100,i=Math.round(100*i)/100,e.x=r,e.y=i,n.setLastX(r),n.setLastY(i),'<line x="'+new String(r).toString()+'" y="'+new String(i).toString()+'"/>'},n}(t.mxgraph.io.vsdx.geometry.Row),i.LineTo=s,s.__class="com.mxgraph.io.vsdx.geometry.LineTo"}(com||(com={})),function(t){var e,n,r,i,s;e=t.mxgraph||(t.mxgraph={}),n=e.io||(e.io={}),r=n.vsdx||(n.vsdx={}),i=r.geometry||(r.geometry={}),s=function(e){function n(t,n,r){return e.call(this,t,n,r)||this}return __extends(n,e),n.prototype.handle=function(e,n){var r=e.x,i=e.y,s=n.getHeight(),a=n.getWidth();return null!=this.x&&null!=this.y&&(r=this.x*t.mxgraph.io.vsdx.mxVsdxUtils.conversionFactor_$LI$(),i=this.y*t.mxgraph.io.vsdx.mxVsdxUtils.conversionFactor_$LI$()),r=100*r/a,i=100-(i=100*i/s),r=Math.round(100*r)/100,i=Math.round(100*i)/100,e.x=r,e.y=i,n.setLastX(r),n.setLastY(i),n.setLastMoveX(r),n.setLastMoveY(i),'<move x="'+new String(r).toString()+'" y="'+new String(i).toString()+'"/>'},n}(t.mxgraph.io.vsdx.geometry.Row),i.MoveTo=s,s.__class="com.mxgraph.io.vsdx.geometry.MoveTo"}(com||(com={})),function(t){var e,n,r,i,s;e=t.mxgraph||(t.mxgraph={}),n=e.io||(e.io={}),r=n.vsdx||(n.vsdx={}),i=r.geometry||(r.geometry={}),s=function(e){function n(t,n,r,i,s,a,o,l){var u=e.call(this,t,n,r)||this;return u.a=i,u.b=s,u.c=a,u.d=o,u.formulaE=l,u}return __extends(n,e),n.prototype.handle=function(e,r){if(null!=this.x&&null!=this.y&&null!=this.formulaE){var i=r.getHeight(),s=r.getWidth(),a=this.x*t.mxgraph.io.vsdx.mxVsdxUtils.conversionFactor_$LI$(),o=this.y*t.mxgraph.io.vsdx.mxVsdxUtils.conversionFactor_$LI$(),l=this.formulaE.split("NURBS(").join("");l=l.split(")").join("");var u=new n.Nurbs(this,l,s,i);if(u.getSize()>=2){var h=u.getX(0),g=u.getY(0),c=u.getX(1),x=u.getY(1);if(a=100*a/s,o=100-(o=100*o/i),a=Math.round(100*a)/100,o=Math.round(100*o)/100,h=Math.round(100*h)/100,g=Math.round(100*g)/100,c=Math.round(100*c)/100,x=Math.round(100*x)/100,r.setLastX(a),r.setLastY(o),3===u.getDegree()&&u.isOrderedByThree(this.getA())){for(var m=[],p=[],d=[],v=u.getSize(),y=0;y<v-1;y+=3)m.push(new mxPoint(u.getX(y),u.getY(y))),p.push(new mxPoint(u.getX(y+1),u.getY(y+1))),y<v-2?d.push(new mxPoint(u.getX(y+2),u.getY(y+2))):d.push(new mxPoint(a,o));var f="";for(y=0;y<m.length;y++)f+='<curve x1="'+m[y].x+'" y1="'+m[y].y+'" x2="'+p[y].x+'" y2="'+p[y].y+'" x3="'+d[y].x+'" y3="'+d[y].y+'"/>\n';return f}return'<curve x1="'+new String(h).toString()+'" y1="'+new String(g).toString()+'" x2="'+new String(c).toString()+'" y2="'+new String(x).toString()+'" x3="'+new String(a).toString()+'" y3="'+new String(o).toString()+'"/>'}}return""},n}(t.mxgraph.io.vsdx.geometry.Row),i.NURBSTo=s,s.__class="com.mxgraph.io.vsdx.geometry.NURBSTo",function(t){var e=function(){function t(t,e,n,r){this.__parent=t,this.nurbsValues=[];for(var i=e.split(/\s*,\s*/).slice(0),s=0;s<i.length;s++)s>3&&s%4==0?this.nurbsValues.push(100*parseFloat(i[s])):s>3&&s%4==1?this.nurbsValues.push(100-100*parseFloat(i[s])):this.nurbsValues.push(parseFloat(i[s]))}return t.prototype.isOrderedByThree=function(t){for(var e=0;e+2<this.getSize();e+=3){var n=Math.round(100*this.getKnot(e))/100,r=Math.round(100*this.getKnot(e+1))/100,i=Math.round(100*this.getKnot(e+2))/100;if(n!==r||n!==i||r!==i)return!1}var s=Math.round(10*this.getKnot(this.getSize()-2))/10,a=Math.round(10*this.getKnot(this.getSize()-1))/10,o=Math.round(10*t)/10;return s===a&&s===o&&a===o},t.prototype.getSize=function(){return(this.nurbsValues.length/4|0)-1},t.prototype.getKnotLast=function(){return this.nurbsValues[0]},t.prototype.getDegree=function(){return this.nurbsValues[1]},t.prototype.getXType=function(){return this.nurbsValues[2]},t.prototype.getYType=function(){return this.nurbsValues[3]},t.prototype.getX=function(t){return this.nurbsValues[4*(t+1)]},t.prototype.getY=function(t){return this.nurbsValues[4*(t+1)+1]},t.prototype.getKnot=function(t){return this.nurbsValues[4*(t+1)+2]},t.prototype.getWeight=function(t){return this.nurbsValues[4*(t+1)+3]},t}();t.Nurbs=e,e.__class="com.mxgraph.io.vsdx.geometry.NURBSTo.Nurbs"}(s=i.NURBSTo||(i.NURBSTo={}))}(com||(com={})),function(t){var e,n,r,i,s;e=t.mxgraph||(t.mxgraph={}),n=e.io||(e.io={}),r=n.vsdx||(n.vsdx={}),i=r.geometry||(r.geometry={}),s=function(e){function n(t,n,r,i){var s=e.call(this,t,n,r)||this;return s.formulaA=i,s}return __extends(n,e),n.prototype.handle=function(e,n){var r,i="";if(null!=this.x&&null!=this.y&&null!=this.formulaA){var s=n.getHeight(),a=n.getWidth(),o=this.x*t.mxgraph.io.vsdx.mxVsdxUtils.conversionFactor_$LI$(),l=this.y*t.mxgraph.io.vsdx.mxVsdxUtils.conversionFactor_$LI$();o=100*o/a,l=100-(l=100*l/s),o=Math.round(100*o)/100,l=Math.round(100*l)/100;var u=this.formulaA.replace(new RegExp("\\s","g"),"").toLowerCase().replace(new RegExp("polyline\\(","g"),"").replace(new RegExp("\\)","g"),"");if((r=u)&&r.equals?r.equals("inh"):"inh"===r)throw Object.defineProperty(new Error,"__classes",{configurable:!0,value:["java.lang.Throwable","java.lang.Object","java.lang.RuntimeException","java.lang.IllegalArgumentException","java.lang.Exception"]});for(var h=u.split(",").slice(0).slice(0),g=parseFloat(h.splice(0,1)),c=(parseFloat(h.splice(0,1)),0),x=0;h.length>0;)c=parseFloat(h.splice(0,1))*t.mxgraph.io.vsdx.mxVsdxUtils.conversionFactor_$LI$(),x=parseFloat(h.splice(0,1))*t.mxgraph.io.vsdx.mxVsdxUtils.conversionFactor_$LI$(),1===g&&(c=100*c/a),1===g&&(x=100*x/s),x=100-x,c=Math.round(100*c)/100,x=Math.round(100*x)/100,n.setLastX(c),n.setLastY(x),i+='<line x="'+new String(c).toString()+'" y="'+new String(x).toString()+'"/>';i+='<line x="'+new String(o).toString()+'" y="'+new String(l).toString()+'"/>',n.getLastMoveX()===o&&n.getLastMoveY()===l&&(i+="<close/>")}return i},n}(t.mxgraph.io.vsdx.geometry.Row),i.PolylineTo=s,s.__class="com.mxgraph.io.vsdx.geometry.PolylineTo"}(com||(com={})),function(t){var e,n,r,i,s;e=t.mxgraph||(t.mxgraph={}),n=e.io||(e.io={}),r=n.vsdx||(n.vsdx={}),i=r.geometry||(r.geometry={}),s=function(t){function e(e,n,r,i,s,a,o){var l=t.call(this,e,n,r)||this;return l.a=i,l.b=s,l.c=a,l.d=o,l}return __extends(e,t),e.prototype.handle=function(t,e){if(null!=this.x&&null!=this.y&&null!=this.a&&null!=this.b&&null!=this.c&&null!=this.d){var n=100*this.x,r=100-100*this.y,i=100*this.a,s=100-100*this.b,a=100*this.c,o=100-100*this.d;return n=Math.round(100*n)/100,r=Math.round(100*r)/100,i=Math.round(100*i)/100,s=Math.round(100*s)/100,a=Math.round(100*a)/100,o=Math.round(100*o)/100,e.setLastX(n),e.setLastY(r),'<curve x1="'+new String(i).toString()+'" y1="'+new String(s).toString()+'" x2="'+new String(a).toString()+'" y2="'+new String(o).toString()+'" x3="'+new String(n).toString()+'" y3="'+new String(r).toString()+'"/>'}return""},e}(t.mxgraph.io.vsdx.geometry.Row),i.RelCubBezTo=s,s.__class="com.mxgraph.io.vsdx.geometry.RelCubBezTo"}(com||(com={})),function(t){var e,n,r,i,s;e=t.mxgraph||(t.mxgraph={}),n=e.io||(e.io={}),r=n.vsdx||(n.vsdx={}),i=r.geometry||(r.geometry={}),s=function(t){function e(e,n,r){return t.call(this,e,n,r)||this}return __extends(e,t),e.prototype.handle=function(t,e){var n=t.x,r=t.y;return null!=this.x&&null!=this.y&&(n=100*this.x,r=100-100*this.y),n=Math.round(100*n)/100,r=Math.round(100*r)/100,t.x=n,t.y=r,e.setLastX(n),e.setLastY(r),'<line x="'+new String(n).toString()+'" y="'+new String(r).toString()+'"/>'},e}(t.mxgraph.io.vsdx.geometry.Row),i.RelLineTo=s,s.__class="com.mxgraph.io.vsdx.geometry.RelLineTo"}(com||(com={})),function(t){var e,n,r,i,s;e=t.mxgraph||(t.mxgraph={}),n=e.io||(e.io={}),r=n.vsdx||(n.vsdx={}),i=r.geometry||(r.geometry={}),s=function(t){function e(e,n,r){return t.call(this,e,n,r)||this}return __extends(e,t),e.prototype.handle=function(t,e){var n=t.x,r=t.y;return null!=this.x&&null!=this.y&&(n=100*this.x,r=100-100*this.y),n=Math.round(100*n)/100,r=Math.round(100*r)/100,t.x=n,t.y=r,e.setLastX(n),e.setLastY(r),e.setLastMoveX(n),e.setLastMoveY(r),'<move x="'+new String(n).toString()+'" y="'+new String(r).toString()+'"/>'},e}(t.mxgraph.io.vsdx.geometry.Row),i.RelMoveTo=s,s.__class="com.mxgraph.io.vsdx.geometry.RelMoveTo"}(com||(com={})),function(t){var e,n,r,i,s;e=t.mxgraph||(t.mxgraph={}),n=e.io||(e.io={}),r=n.vsdx||(n.vsdx={}),i=r.geometry||(r.geometry={}),s=function(t){function e(e,n,r,i,s){var a=t.call(this,e,n,r)||this;return a.a=i,a.b=s,a}return __extends(e,t),e.prototype.handle=function(t,e){if(null!=this.x&&null!=this.y&&null!=this.a&&null!=this.b){var n=100*this.x,r=100-100*this.y,i=100*this.a,s=100-100*this.b;return n=Math.round(100*n)/100,r=Math.round(100*r)/100,i=Math.round(100*i)/100,s=Math.round(100*s)/100,e.setLastX(n),e.setLastY(r),'<quad x1="'+new String(i).toString()+'" y1="'+new String(s).toString()+'" x2="'+new String(n).toString()+'" y2="'+new String(r).toString()+'"/>'}return""},e}(t.mxgraph.io.vsdx.geometry.Row),i.RelQuadBezTo=s,s.__class="com.mxgraph.io.vsdx.geometry.RelQuadBezTo"}(com||(com={})),function(t){var e,n,r,i,s;e=t.mxgraph||(t.mxgraph={}),n=e.io||(e.io={}),r=n.vsdx||(n.vsdx={}),i=r.geometry||(r.geometry={}),s=function(e){function n(t,n,r,i){var s=e.call(this,t,n,r)||this;return s.a=i,s}return __extends(n,e),n.prototype.handle=function(e,n){if(null!=this.x&&null!=this.y&&null!=this.a){var r=this.x*t.mxgraph.io.vsdx.mxVsdxUtils.conversionFactor_$LI$(),i=this.y*t.mxgraph.io.vsdx.mxVsdxUtils.conversionFactor_$LI$(),s=this.a;i=100-i,r=Math.round(100*r)/100,i=Math.round(100*i)/100,s=Math.round(100*s)/100,n.setLastX(r),n.setLastY(i)}return""},n}(t.mxgraph.io.vsdx.geometry.Row),i.SplineKnot=s,s.__class="com.mxgraph.io.vsdx.geometry.SplineKnot"}(com||(com={})),function(t){var e,n,r,i,s;e=t.mxgraph||(t.mxgraph={}),n=e.io||(e.io={}),r=n.vsdx||(n.vsdx={}),i=r.geometry||(r.geometry={}),s=function(e){function n(t,n,r,i,s,a,o){var l=e.call(this,t,n,r)||this;return l.a=i,l.b=s,l.c=a,l.d=o,l}return __extends(n,e),n.prototype.handle=function(e,n){if(null!=this.x&&null!=this.y&&null!=this.a&&null!=this.b&&null!=this.c&&null!=this.d){n.getHeight(),n.getWidth();var r=this.x*t.mxgraph.io.vsdx.mxVsdxUtils.conversionFactor_$LI$(),i=this.y*t.mxgraph.io.vsdx.mxVsdxUtils.conversionFactor_$LI$(),s=this.c,a=(this.d,s);return n.setLastKnot(a),i=100-i,r=Math.round(100*r)/100,i=Math.round(100*i)/100,a=Math.round(100*a)/100,n.getLastX(),n.getLastY(),n.setLastX(r),n.setLastY(i),"<curve "}return""},n}(t.mxgraph.io.vsdx.geometry.Row),i.SplineStart=s,s.__class="com.mxgraph.io.vsdx.geometry.SplineStart"}(com||(com={})),function(t){var e,n,r,i;e=t.mxgraph||(t.mxgraph={}),n=e.io||(e.io={}),r=n.vsdx||(n.vsdx={}),(i=function(){function e(e,n){this.cellElements={},this.sections={},this.styleParents={},this.shape=null,this.Id=null,this.pm=null,this.style=null,this.shape=e,this.pm=n.getPropertiesManager();var r=e.getAttribute(t.mxgraph.io.vsdx.mxVsdxConstants.ID);try{this.Id=null!=r&&0!==r.length?parseFloat(r):-1}catch(t){this.Id=-1}this.cacheCells(n),this.stylesheetRefs(n)}return e.__static_initialize=function(){e.__static_initialized||(e.__static_initialized=!0,e.__static_initializer_0(),e.__static_initializer_1())},e.styleTypes_$LI$=function(){return e.__static_initialize(),null==e.styleTypes&&(e.styleTypes={}),e.styleTypes},e.__static_initializer_0=function(){e.styleTypes_$LI$()[t.mxgraph.io.vsdx.mxVsdxConstants.FILL]=t.mxgraph.io.vsdx.mxVsdxConstants.FILL_STYLE,e.styleTypes_$LI$()[t.mxgraph.io.vsdx.mxVsdxConstants.FILL_BKGND]=t.mxgraph.io.vsdx.mxVsdxConstants.FILL_STYLE,e.styleTypes_$LI$()[t.mxgraph.io.vsdx.mxVsdxConstants.FILL_BKGND_TRANS]=t.mxgraph.io.vsdx.mxVsdxConstants.FILL_STYLE,e.styleTypes_$LI$()[t.mxgraph.io.vsdx.mxVsdxConstants.FILL_FOREGND]=t.mxgraph.io.vsdx.mxVsdxConstants.FILL_STYLE,e.styleTypes_$LI$()[t.mxgraph.io.vsdx.mxVsdxConstants.FILL_FOREGND_TRANS]=t.mxgraph.io.vsdx.mxVsdxConstants.FILL_STYLE,e.styleTypes_$LI$()[t.mxgraph.io.vsdx.mxVsdxConstants.FILL_PATTERN]=t.mxgraph.io.vsdx.mxVsdxConstants.FILL_STYLE,e.styleTypes_$LI$()[t.mxgraph.io.vsdx.mxVsdxConstants.SHDW_PATTERN]=t.mxgraph.io.vsdx.mxVsdxConstants.FILL_STYLE,e.styleTypes_$LI$()[t.mxgraph.io.vsdx.mxVsdxConstants.FILL_STYLE]=t.mxgraph.io.vsdx.mxVsdxConstants.FILL_STYLE,e.styleTypes_$LI$().QuickStyleFillColor=t.mxgraph.io.vsdx.mxVsdxConstants.FILL_STYLE,e.styleTypes_$LI$().QuickStyleFillMatrix=t.mxgraph.io.vsdx.mxVsdxConstants.FILL_STYLE,e.styleTypes_$LI$()[t.mxgraph.io.vsdx.mxVsdxConstants.BEGIN_ARROW]=t.mxgraph.io.vsdx.mxVsdxConstants.LINE_STYLE,e.styleTypes_$LI$()[t.mxgraph.io.vsdx.mxVsdxConstants.END_ARROW]=t.mxgraph.io.vsdx.mxVsdxConstants.LINE_STYLE,e.styleTypes_$LI$()[t.mxgraph.io.vsdx.mxVsdxConstants.LINE_PATTERN]=t.mxgraph.io.vsdx.mxVsdxConstants.LINE_STYLE,e.styleTypes_$LI$()[t.mxgraph.io.vsdx.mxVsdxConstants.LINE_COLOR]=t.mxgraph.io.vsdx.mxVsdxConstants.LINE_STYLE,e.styleTypes_$LI$()[t.mxgraph.io.vsdx.mxVsdxConstants.LINE_COLOR_TRANS]=t.mxgraph.io.vsdx.mxVsdxConstants.LINE_STYLE,e.styleTypes_$LI$()[t.mxgraph.io.vsdx.mxVsdxConstants.LINE_WEIGHT]=t.mxgraph.io.vsdx.mxVsdxConstants.LINE_STYLE,e.styleTypes_$LI$().QuickStyleLineColor=t.mxgraph.io.vsdx.mxVsdxConstants.LINE_STYLE,e.styleTypes_$LI$().QuickStyleLineMatrix=t.mxgraph.io.vsdx.mxVsdxConstants.LINE_STYLE,e.styleTypes_$LI$()[t.mxgraph.io.vsdx.mxVsdxConstants.BEGIN_ARROW_SIZE]=t.mxgraph.io.vsdx.mxVsdxConstants.LINE_STYLE,e.styleTypes_$LI$()[t.mxgraph.io.vsdx.mxVsdxConstants.END_ARROW_SIZE]=t.mxgraph.io.vsdx.mxVsdxConstants.LINE_STYLE,e.styleTypes_$LI$()[t.mxgraph.io.vsdx.mxVsdxConstants.TEXT_BKGND]=t.mxgraph.io.vsdx.mxVsdxConstants.TEXT_STYLE,e.styleTypes_$LI$()[t.mxgraph.io.vsdx.mxVsdxConstants.BOTTOM_MARGIN]=t.mxgraph.io.vsdx.mxVsdxConstants.TEXT_STYLE,e.styleTypes_$LI$()[t.mxgraph.io.vsdx.mxVsdxConstants.LEFT_MARGIN]=t.mxgraph.io.vsdx.mxVsdxConstants.TEXT_STYLE,e.styleTypes_$LI$()[t.mxgraph.io.vsdx.mxVsdxConstants.RIGHT_MARGIN]=t.mxgraph.io.vsdx.mxVsdxConstants.TEXT_STYLE,e.styleTypes_$LI$()[t.mxgraph.io.vsdx.mxVsdxConstants.TOP_MARGIN]=t.mxgraph.io.vsdx.mxVsdxConstants.TEXT_STYLE,e.styleTypes_$LI$()[t.mxgraph.io.vsdx.mxVsdxConstants.PARAGRAPH]=t.mxgraph.io.vsdx.mxVsdxConstants.TEXT_STYLE,e.styleTypes_$LI$()[t.mxgraph.io.vsdx.mxVsdxConstants.CHARACTER]=t.mxgraph.io.vsdx.mxVsdxConstants.TEXT_STYLE,e.styleTypes_$LI$().QuickStyleFontColor=t.mxgraph.io.vsdx.mxVsdxConstants.TEXT_STYLE,e.styleTypes_$LI$().QuickStyleFontMatrix=t.mxgraph.io.vsdx.mxVsdxConstants.TEXT_STYLE},e.prototype.getTheme=function(){return null},e.prototype.getQuickStyleVals=function(){return null},e.prototype.isVertex=function(){return!1},e.prototype.styleDebug=function(t){e.vsdxStyleDebug&&console.info(t)},e.prototype.stylesheetRefs=function(e){this.styleParents[t.mxgraph.io.vsdx.mxVsdxConstants.FILL_STYLE]=e.getStylesheet(this.shape.getAttribute(t.mxgraph.io.vsdx.mxVsdxConstants.FILL_STYLE)),this.styleParents[t.mxgraph.io.vsdx.mxVsdxConstants.LINE_STYLE]=e.getStylesheet(this.shape.getAttribute(t.mxgraph.io.vsdx.mxVsdxConstants.LINE_STYLE)),this.styleParents[t.mxgraph.io.vsdx.mxVsdxConstants.TEXT_STYLE]=e.getStylesheet(this.shape.getAttribute(t.mxgraph.io.vsdx.mxVsdxConstants.TEXT_STYLE));var n=e.getStylesheet("0");this.style=n},e.prototype.cacheCells=function(t){if(null!=this.shape){var e=this.shape.childNodes;if(null!=e)for(var n=e.item(0);null!=n;)null!=n&&1==n.nodeType&&this.parseShapeElem(n,t),n=n.nextSibling}},e.prototype.parseShapeElem=function(t,e){var n,r,i=t.nodeName;r="Cell",((n=i)&&n.equals?n.equals(r):n===r)?this.cellElements[t.getAttribute("N")]=t:function(t,e){return t&&t.equals?t.equals(e):t===e}(i,"Section")&&this.parseSection(t)},e.prototype.parseSection=function(e){var n=new t.mxgraph.io.vsdx.Section(e);this.sections[e.getAttribute("N")]=n},e.prototype.hasProperty=function(t,e){return this.cellElements.hasOwnProperty(e)},e.prototype.getValue=function(t,e){return null!=t?t.getAttribute("V")||"":e},e.prototype.getValueAsDouble=function(e,n){if(null!=e){var r=e.getAttribute("V");if(null!=r){if(a="Themed",(s=r)&&s.equals?s.equals(a):s===a)return 0;try{var i=parseFloat(r);return function(t,e){return t&&t.equals?t.equals("PT"):"PT"===t}(e.getAttribute("U"))&&(i*=t.mxgraph.io.vsdx.mxVsdxUtils.conversionFactor_$LI$()),Math.round(100*i)/100}catch(t){console.error(t.message,t)}}}var s,a;return n},e.prototype.getScreenNumericalValue$org_w3c_dom_Element$double=function(t,e){if(null!=t){var n=t.getAttribute("V");if(null!=n)try{var r=parseFloat(n);return this.getScreenNumericalValue$double(r)}catch(t){console.error(t.message,t)}}return e},e.prototype.getScreenNumericalValue=function(t,e){if((null==t||1!=t.nodeType)&&null!==t||"number"!=typeof e&&null!==e){if("number"!=typeof t&&null!==t||void 0!==e)throw new Error("invalid overload");return this.getScreenNumericalValue$double(t)}return this.getScreenNumericalValue$org_w3c_dom_Element$double(t,e)},e.prototype.getScreenNumericalValue$double=function(e){return e*t.mxgraph.io.vsdx.mxVsdxUtils.conversionFactor_$LI$()},e.prototype.getAttribute=function(t,e,n){var r,i,s=n,a=(r=this.cellElements)[i=t]?r[i]:null;return null!=a&&(s=a.getAttribute(e)||""),s},e.prototype.getChildValues=function(t,e){for(var n,r,i,s,a={},o=t.firstChild;null!=o;){if(null!=o&&1==o.nodeType){var l=o,u=null,h=null;if(s="Cell",((i=l.nodeName)&&i.equals?i.equals(s):i===s)?(u=l.getAttribute("N")||"",h=l.getAttribute("V")||""):(u=l.nodeName,h=l.textContent),null!=e){var g=(n=e)[r=u]?n[r]:null;null!=g&&(h=l.getAttribute(g)||"")}a[u]=h}o=o.nextSibling}return a},e.prototype.getCellElement$java_lang_String$java_lang_String$java_lang_String=function(n,r,i){var s,a,o,l=(s=this.sections)[a=i]?s[a]:null,u=null,h=!1;if(null!=l&&(u=l.getIndexedCell(r,n)),null!=u){var g=u.getAttribute("F"),c=u.getAttribute("V");if(null!=g&&null!=c)if(((o=g)&&o.equals?o.equals("Inh"):"Inh"===o)&&function(t,e){return t&&t.equals?t.equals(e):t===e}(c,"Themed"))h=!0;else if(function(t,e){return t&&t.equals?t.equals(e):t===e}(g,"THEMEVAL()")&&function(t,e){return t&&t.equals?t.equals(e):t===e}(c,"Themed")&&null!=this.style){if(function(t,e){return t&&t.equals?t.equals(e):t===e}(t.mxgraph.io.vsdx.mxVsdxConstants.COLOR,n))return u;var x=this.style.getCellElement$java_lang_String$java_lang_String$java_lang_String(n,r,i);if(null!=x)return x}}if(null==u||h){var m=function(t,e){return t[e]?t[e]:null}(e.styleTypes_$LI$(),i),p=function(t,e){return t[e]?t[e]:null}(this.styleParents,m);if(null!=p){var d=p.getCellElement$java_lang_String$java_lang_String$java_lang_String(n,r,i);if(null!=d)return d}}return u},e.prototype.getCellElement=function(t,e,n){if("string"!=typeof t&&null!==t||"string"!=typeof e&&null!==e||"string"!=typeof n&&null!==n){if("string"!=typeof t&&null!==t||void 0!==e||void 0!==n)throw new Error("invalid overload");return this.getCellElement$java_lang_String(t)}return this.getCellElement$java_lang_String$java_lang_String$java_lang_String(t,e,n)},e.prototype.getCellElement$java_lang_String=function(n){var r,i,s,a=(r=this.cellElements)[i=n]?r[i]:null,o=!1;if(null!=a){var l=a.getAttribute("F"),u=a.getAttribute("V");if(null!=l&&null!=u)if(((s=l)&&s.equals?s.equals("Inh"):"Inh"===s)&&function(t,e){return t&&t.equals?t.equals(e):t===e}(u,"Themed"))o=!0;else if(-1!=l.indexOf("THEMEVAL()")&&function(t,e){return t&&t.equals?t.equals(e):t===e}(u,"Themed")&&null!=this.style){if(function(t,e){return t.equals?t.equals(e):t===e}("FillForegnd",n)||function(t,e){return t&&t.equals?t.equals(e):t===e}(t.mxgraph.io.vsdx.mxVsdxConstants.LINE_COLOR,n)||function(t,e){return t&&t.equals?t.equals(e):t===e}(t.mxgraph.io.vsdx.mxVsdxConstants.LINE_PATTERN,n)||function(t,e){return t&&t.equals?t.equals(e):t===e}(t.mxgraph.io.vsdx.mxVsdxConstants.BEGIN_ARROW_SIZE,n)||function(t,e){return t&&t.equals?t.equals(e):t===e}(t.mxgraph.io.vsdx.mxVsdxConstants.END_ARROW_SIZE,n)||function(t,e){return t&&t.equals?t.equals(e):t===e}(t.mxgraph.io.vsdx.mxVsdxConstants.BEGIN_ARROW,n)||function(t,e){return t&&t.equals?t.equals(e):t===e}(t.mxgraph.io.vsdx.mxVsdxConstants.END_ARROW,n)||function(t,e){return t&&t.equals?t.equals(e):t===e}(t.mxgraph.io.vsdx.mxVsdxConstants.LINE_WEIGHT,n))return a;var h=this.style.getCellElement$java_lang_String(n);if(null!=h)return h}}if(null==a||o){var g=function(t,e){return t[e]?t[e]:null}(e.styleTypes_$LI$(),n),c=function(t,e){return t[e]?t[e]:null}(this.styleParents,g);if(null!=c){var x=c.getCellElement$java_lang_String(n);if(null!=x)return x}}return a},e.prototype.getStrokeColor=function(){var e,n="";if((e=this.getValue(this.getCellElement$java_lang_String(t.mxgraph.io.vsdx.mxVsdxConstants.LINE_PATTERN),"1"))&&e.equals?e.equals("0"):"0"===e)n="none";else if(function(t,e){return t.equals?t.equals(e):t===e}("Themed",n=this.getColor(this.getCellElement$java_lang_String(t.mxgraph.io.vsdx.mxVsdxConstants.LINE_COLOR)))){var r=this.getTheme();n=null!=r?(this.isVertex()?r.getLineColor$com_mxgraph_io_vsdx_theme_QuickStyleVals(this.getQuickStyleVals()):r.getConnLineColor(this.getQuickStyleVals())).toHexStr():""}return n},e.prototype.getFillColor=function(){var e,n;if(n=this.getValue(this.getCellElement$java_lang_String(t.mxgraph.io.vsdx.mxVsdxConstants.FILL_GRADIENT_ENABLED),"0"),"1".equals?"1".equals(n):"1"===n){var r=(e=this.sections).FillGradient?e.FillGradient:null;if(null!=r&&null!=(s=this.getColor(r.getIndexedCell("0","GradientStopColor")))&&0!==s.length)return s}var i=this.getColor(this.getCellElement$java_lang_String(t.mxgraph.io.vsdx.mxVsdxConstants.FILL_FOREGND));if(function(t,e){return t.equals?t.equals(e):t===e}("Themed",i)){var s,a=this.getTheme();i=null!=a?(s=a.getFillColor$com_mxgraph_io_vsdx_theme_QuickStyleVals(this.getQuickStyleVals())).toHexStr():"#FFFFFF"}var o=this.getValue(this.getCellElement$java_lang_String(t.mxgraph.io.vsdx.mxVsdxConstants.FILL_PATTERN),"0");return null!=o&&function(t,e){return t&&t.equals?t.equals("0"):"0"===t}(o)?"none":i},e.prototype.getColor=function(t){var e,n,r,i=this.getValue(t,"");return r=i,((n="Themed").equals?n.equals(r):n===r)||(void 0===e&&(e=0),"#"===i.substr(e,"#".length))||(i=this.pm.getColor(i)),i},e.prototype.getTextBkgndColor=function(t){var e,n,r=this.getValue(t,"");return void 0===n&&(n=0),"#"!==r.substr(n,"#".length)?((e=r)&&e.equals?e.equals("0"):"0"===e)||function(t,e){return t&&t.equals?t.equals("255"):"255"===t}(r)||0===r.length?"none":this.pm.getColor(new String(parseInt(r)-1).toString()):r},e.prototype.getLineWeight=function(){return this.getScreenNumericalValue$org_w3c_dom_Element$double(this.getCellElement$java_lang_String(t.mxgraph.io.vsdx.mxVsdxConstants.LINE_WEIGHT),0)},e.prototype.getStrokeTransparency=function(){return this.getValueAsDouble(this.getCellElement$java_lang_String(t.mxgraph.io.vsdx.mxVsdxConstants.LINE_COLOR_TRANS),0)},e.prototype.getNameU=function(){return this.shape.getAttribute(t.mxgraph.io.vsdx.mxVsdxConstants.NAME_U)||""},e.prototype.getName=function(){return this.shape.getAttribute(t.mxgraph.io.vsdx.mxVsdxConstants.NAME)||""},e.prototype.getUniqueID=function(){return this.shape.getAttribute(t.mxgraph.io.vsdx.mxVsdxConstants.UNIQUE_ID)||""},e.prototype.getId=function(){return this.Id},e.prototype.getTextColor=function(e){var n,r,i,s=this.getCellElement$java_lang_String$java_lang_String$java_lang_String(t.mxgraph.io.vsdx.mxVsdxConstants.COLOR,e,t.mxgraph.io.vsdx.mxVsdxConstants.CHARACTER),a=this.getValue(s,"#000000");if(i=a,(r="Themed").equals?r.equals(i):r===i){var o=this.getTheme();a=null!=o?(this.isVertex()?o.getFontColor$com_mxgraph_io_vsdx_theme_QuickStyleVals(this.getQuickStyleVals()):o.getConnFontColor(this.getQuickStyleVals())).toHexStr():"#000000"}else void 0===n&&(n=0),"#"!==a.substr(n,"#".length)&&(a=this.pm.getColor(a));return a},e.prototype.getTextTopMargin=function(){return this.getScreenNumericalValue$org_w3c_dom_Element$double(this.getCellElement$java_lang_String(t.mxgraph.io.vsdx.mxVsdxConstants.TOP_MARGIN),0)},e.prototype.getTextBottomMargin=function(){return this.getScreenNumericalValue$org_w3c_dom_Element$double(this.getCellElement$java_lang_String(t.mxgraph.io.vsdx.mxVsdxConstants.BOTTOM_MARGIN),0)},e.prototype.getTextLeftMargin=function(){return this.getScreenNumericalValue$org_w3c_dom_Element$double(this.getCellElement$java_lang_String(t.mxgraph.io.vsdx.mxVsdxConstants.LEFT_MARGIN),0)},e.prototype.getTextRightMargin=function(){return this.getScreenNumericalValue$org_w3c_dom_Element$double(this.getCellElement$java_lang_String(t.mxgraph.io.vsdx.mxVsdxConstants.RIGHT_MARGIN),0)},e.prototype.getTextStyle=function(e){var n=this.getCellElement$java_lang_String$java_lang_String$java_lang_String(t.mxgraph.io.vsdx.mxVsdxConstants.STYLE,e,t.mxgraph.io.vsdx.mxVsdxConstants.CHARACTER);return this.getValue(n,"")},e.prototype.getTextFont=function(e){var n=this.getCellElement$java_lang_String$java_lang_String$java_lang_String(t.mxgraph.io.vsdx.mxVsdxConstants.FONT,e,t.mxgraph.io.vsdx.mxVsdxConstants.CHARACTER);return this.getValue(n,"")},e.prototype.getTextPos=function(e){var n=this.getCellElement$java_lang_String$java_lang_String$java_lang_String(t.mxgraph.io.vsdx.mxVsdxConstants.POS,e,t.mxgraph.io.vsdx.mxVsdxConstants.CHARACTER);return this.getValue(n,"")},e.prototype.getTextStrike=function(e){var n,r=this.getCellElement$java_lang_String$java_lang_String$java_lang_String(t.mxgraph.io.vsdx.mxVsdxConstants.STRIKETHRU,e,t.mxgraph.io.vsdx.mxVsdxConstants.CHARACTER);return(n=this.getValue(r,""))&&n.equals?n.equals("1"):"1"===n},e.prototype.getTextCase=function(e){var n=this.getCellElement$java_lang_String$java_lang_String$java_lang_String(t.mxgraph.io.vsdx.mxVsdxConstants.CASE,e,t.mxgraph.io.vsdx.mxVsdxConstants.CHARACTER);return this.getValue(n,"")},e.prototype.getHorizontalAlign=function(e,n){var r="center",i=this.getCellElement$java_lang_String$java_lang_String$java_lang_String(t.mxgraph.io.vsdx.mxVsdxConstants.HORIZONTAL_ALIGN,e,t.mxgraph.io.vsdx.mxVsdxConstants.PARAGRAPH);switch(this.getValue(i,"")){case"0":r=n?"left":mxConstants.ALIGN_LEFT;break;case"2":r=n?"right":mxConstants.ALIGN_RIGHT;break;case"3":case"4":r=n?"justify":mxConstants.ALIGN_CENTER;break;default:r=n?"center":mxConstants.ALIGN_CENTER}return r},e.prototype.getIndentFirst=function(e){var n=this.getCellElement$java_lang_String$java_lang_String$java_lang_String(t.mxgraph.io.vsdx.mxVsdxConstants.INDENT_FIRST,e,t.mxgraph.io.vsdx.mxVsdxConstants.PARAGRAPH);return new String(this.getScreenNumericalValue$org_w3c_dom_Element$double(n,0)).toString()},e.prototype.getIndentLeft=function(e){var n=this.getCellElement$java_lang_String$java_lang_String$java_lang_String(t.mxgraph.io.vsdx.mxVsdxConstants.INDENT_LEFT,e,t.mxgraph.io.vsdx.mxVsdxConstants.PARAGRAPH);return new String(0|Math.round(this.getScreenNumericalValue$org_w3c_dom_Element$double(n,0))).toString()},e.prototype.getIndentRight=function(e){var n=this.getCellElement$java_lang_String$java_lang_String$java_lang_String(t.mxgraph.io.vsdx.mxVsdxConstants.INDENT_RIGHT,e,t.mxgraph.io.vsdx.mxVsdxConstants.PARAGRAPH);return new String(0|Math.round(this.getScreenNumericalValue$org_w3c_dom_Element$double(n,0))).toString()},e.prototype.getSpBefore=function(e){var n=this.getCellElement$java_lang_String$java_lang_String$java_lang_String(t.mxgraph.io.vsdx.mxVsdxConstants.SPACE_BEFORE,e,t.mxgraph.io.vsdx.mxVsdxConstants.PARAGRAPH);return new String(0|Math.round(this.getScreenNumericalValue$org_w3c_dom_Element$double(n,0))).toString()},e.prototype.getSpAfter=function(e){var n=this.getCellElement$java_lang_String$java_lang_String$java_lang_String(t.mxgraph.io.vsdx.mxVsdxConstants.SPACE_AFTER,e,t.mxgraph.io.vsdx.mxVsdxConstants.PARAGRAPH);return new String(0|Math.round(this.getScreenNumericalValue$org_w3c_dom_Element$double(n,0))).toString()},e.prototype.getSpLine=function(e){var n,r=this.getCellElement$java_lang_String$java_lang_String$java_lang_String(t.mxgraph.io.vsdx.mxVsdxConstants.SPACE_LINE,e,t.mxgraph.io.vsdx.mxVsdxConstants.PARAGRAPH),i=this.getValue(r,"");return((n=i)&&n.equals?n.equals(""):""===n)?0:parseFloat(i)},e.prototype.getFlags=function(e){var n=this.getCellElement$java_lang_String$java_lang_String$java_lang_String(t.mxgraph.io.vsdx.mxVsdxConstants.FLAGS,e,t.mxgraph.io.vsdx.mxVsdxConstants.PARAGRAPH);return this.getValue(n,"0")},e.prototype.getLetterSpace=function(e){var n=this.getCellElement$java_lang_String$java_lang_String$java_lang_String(t.mxgraph.io.vsdx.mxVsdxConstants.LETTER_SPACE,e,t.mxgraph.io.vsdx.mxVsdxConstants.PARAGRAPH);return new String(this.getScreenNumericalValue$org_w3c_dom_Element$double(n,0)).toString()},e.prototype.getBullet=function(e){var n=this.getCellElement$java_lang_String$java_lang_String$java_lang_String(t.mxgraph.io.vsdx.mxVsdxConstants.BULLET,e,t.mxgraph.io.vsdx.mxVsdxConstants.PARAGRAPH);return this.getValue(n,"0")},e.prototype.getShape=function(){return this.shape},e.prototype.setShape=function(t){this.shape=t},e.lineDashPatterns_$LI$=function(){return e.__static_initialize(),null==e.lineDashPatterns&&(e.lineDashPatterns=[]),e.lineDashPatterns},e.__static_initializer_1=function(){e.lineDashPatterns_$LI$().push([]),e.lineDashPatterns_$LI$().push([]),e.lineDashPatterns_$LI$().push([]);var t=[];t.push(e.DOT),t.push(e.SPACE),e.lineDashPatterns_$LI$().push(t),(t=[]).push(e.DASH),t.push(e.SPACE),t.push(e.DOT),t.push(e.SPACE),e.lineDashPatterns_$LI$().push(t),(t=[]).push(e.DASH),t.push(e.SPACE),t.push(e.DOT),t.push(e.SPACE),t.push(e.DOT),t.push(e.SPACE),e.lineDashPatterns_$LI$().push(t),(t=[]).push(e.DASH),t.push(e.SPACE),t.push(e.DASH),t.push(e.SPACE),t.push(e.DOT),t.push(e.SPACE),e.lineDashPatterns_$LI$().push(t),(t=[]).push(e.LONG_DASH),t.push(e.SPACE),t.push(e.SHORT_DASH),t.push(e.SPACE),e.lineDashPatterns_$LI$().push(t),(t=[]).push(e.LONG_DASH),t.push(e.SPACE),t.push(e.SHORT_DASH),t.push(e.SPACE),t.push(e.SHORT_DASH),t.push(e.SPACE),e.lineDashPatterns_$LI$().push(t),(t=[]).push(e.SHORT_DASH),t.push(e.SHORT_SPACE),e.lineDashPatterns_$LI$().push(t),(t=[]).push(e.DOT),t.push(e.SHORT_SPACE),e.lineDashPatterns_$LI$().push(t),(t=[]).push(e.SHORT_DASH),t.push(e.SHORT_SPACE),t.push(e.DOT),t.push(e.SHORT_SPACE),e.lineDashPatterns_$LI$().push(t),(t=[]).push(e.SHORT_DASH),t.push(e.SHORT_SPACE),t.push(e.DOT),t.push(e.SHORT_SPACE),t.push(e.DOT),t.push(e.SHORT_SPACE),e.lineDashPatterns_$LI$().push(t),(t=[]).push(e.SHORT_DASH),t.push(e.SHORT_SPACE),t.push(e.SHORT_DASH),t.push(e.SHORT_SPACE),t.push(e.DOT),t.push(e.SHORT_SPACE),e.lineDashPatterns_$LI$().push(t),(t=[]).push(e.DASH),t.push(e.SHORT_SPACE),t.push(e.SHORT_DASH),t.push(e.SHORT_SPACE),e.lineDashPatterns_$LI$().push(t),(t=[]).push(e.DASH),t.push(e.SHORT_SPACE),t.push(e.SHORT_DASH),t.push(e.SHORT_SPACE),t.push(e.SHORT_DASH),t.push(e.SHORT_SPACE),e.lineDashPatterns_$LI$().push(t),(t=[]).push(e.LONG_DASH),t.push(e.LONG_SPACE),e.lineDashPatterns_$LI$().push(t),(t=[]).push(e.DOT),t.push(e.LONG_SPACE),e.lineDashPatterns_$LI$().push(t),(t=[]).push(e.LONG_DASH),t.push(e.LONG_SPACE),t.push(e.DOT),t.push(e.LONG_SPACE),e.lineDashPatterns_$LI$().push(t),(t=[]).push(e.LONG_DASH),t.push(e.LONG_SPACE),t.push(e.DOT),t.push(e.LONG_SPACE),t.push(e.DOT),t.push(e.LONG_SPACE),e.lineDashPatterns_$LI$().push(t),(t=[]).push(e.LONG_DASH),t.push(e.LONG_SPACE),t.push(e.LONG_DASH),t.push(e.LONG_SPACE),t.push(e.DOT),t.push(e.LONG_SPACE),e.lineDashPatterns_$LI$().push(t),(t=[]).push(e.XLONG_DASH),t.push(e.LONG_SPACE),t.push(e.DASH),t.push(e.LONG_SPACE),e.lineDashPatterns_$LI$().push(t),(t=[]).push(e.XLONG_DASH),t.push(e.LONG_SPACE),t.push(e.DASH),t.push(e.LONG_SPACE),t.push(e.DASH),t.push(e.LONG_SPACE),e.lineDashPatterns_$LI$().push(t),(t=[]).push(e.XSHORT_DASH),t.push(e.SHORT_SPACE),e.lineDashPatterns_$LI$().push(t)},e.getLineDashPattern=function(t){return t>=0&&t<=23?e.lineDashPatterns_$LI$()[t]:e.lineDashPatterns_$LI$()[0]},e}()).__static_initialized=!1,i.vsdxStyleDebug=!1,i.SPACE=4,i.SHORT_SPACE=2,i.LONG_SPACE=6,i.DOT=1,i.DASH=8,i.LONG_DASH=12,i.SHORT_DASH=4,i.XLONG_DASH=20,i.XSHORT_DASH=2,r.Style=i,i.__class="com.mxgraph.io.vsdx.Style"}(com||(com={})),function(t){var e,n,r,i,s;e=t.mxgraph||(t.mxgraph={}),n=e.io||(e.io={}),r=n.vsdx||(n.vsdx={}),i=r.theme||(r.theme={}),s=function(e){function n(n,r,i){var s=e.call(this)||this;return s.__com_mxgraph_io_vsdx_theme_HslClr_hue=0,s.__com_mxgraph_io_vsdx_theme_HslClr_sat=0,s.__com_mxgraph_io_vsdx_theme_HslClr_lum=0,s.__com_mxgraph_io_vsdx_theme_HslClr_hue=n/360,s.__com_mxgraph_io_vsdx_theme_HslClr_sat=r/100,s.__com_mxgraph_io_vsdx_theme_HslClr_lum=i/100,s.color=new t.mxgraph.io.vsdx.theme.HSLColor(n,r,i).toRgb(),s}return __extends(n,e),n}(t.mxgraph.io.vsdx.theme.OoxmlColor),i.HslClr=s,s.__class="com.mxgraph.io.vsdx.theme.HslClr"}(com||(com={})),function(t){var e,n,r,i,s;e=t.mxgraph||(t.mxgraph={}),n=e.io||(e.io={}),r=n.vsdx||(n.vsdx={}),i=r.theme||(r.theme={}),s=function(e){function n(n){var r=e.call(this)||this;return r.val=null,r.val=n,r.color=new t.mxgraph.io.vsdx.theme.Color(255,255,255),r}return __extends(n,e),n}(t.mxgraph.io.vsdx.theme.OoxmlColor),i.PrstClr=s,s.__class="com.mxgraph.io.vsdx.theme.PrstClr"}(com||(com={})),function(t){var e,n,r,i,s;e=t.mxgraph||(t.mxgraph={}),n=e.io||(e.io={}),r=n.vsdx||(n.vsdx={}),i=r.theme||(r.theme={}),s=function(t){function e(e){var n=t.call(this)||this;return n.val=null,n.isDynamic=!0,n.val=e,n}return __extends(e,t),e.prototype.calcColor=function(e,n){var r,i;r="phClr",i=this.val,(r.equals?r.equals(i):r===i)?this.color=n.getStyleColor(e):(this.color=n.getSchemeColor(this.val),this.isDynamic=!1),t.prototype.calcColor.call(this,e,n)},e}(t.mxgraph.io.vsdx.theme.OoxmlColor),i.SchemeClr=s,s.__class="com.mxgraph.io.vsdx.theme.SchemeClr"}(com||(com={})),function(t){var e,n,r,i,s;e=t.mxgraph||(t.mxgraph={}),n=e.io||(e.io={}),r=n.vsdx||(n.vsdx={}),i=r.theme||(r.theme={}),s=function(e){function n(n,r,i){var s=e.call(this)||this;return s.r=0,s.g=0,s.b=0,s.r=n,s.g=r,s.b=i,s.color=new t.mxgraph.io.vsdx.theme.Color(n,r,i),s}return __extends(n,e),n}(t.mxgraph.io.vsdx.theme.OoxmlColor),i.ScrgbClr=s,s.__class="com.mxgraph.io.vsdx.theme.ScrgbClr"}(com||(com={})),function(t){var e,n,r,i,s;e=t.mxgraph||(t.mxgraph={}),n=e.io||(e.io={}),r=n.vsdx||(n.vsdx={}),i=r.theme||(r.theme={}),s=function(e){function n(n){var r=e.call(this)||this;return r.hexVal=null,r.hexVal=n,r.color=t.mxgraph.io.vsdx.theme.Color.decodeColorHex(n),r}return __extends(n,e),n}(t.mxgraph.io.vsdx.theme.OoxmlColor),i.SrgbClr=s,s.__class="com.mxgraph.io.vsdx.theme.SrgbClr"}(com||(com={})),function(t){var e,n,r,i,s;e=t.mxgraph||(t.mxgraph={}),n=e.io||(e.io={}),r=n.vsdx||(n.vsdx={}),i=r.theme||(r.theme={}),s=function(e){function n(n,r){var i=e.call(this)||this;i.val=null,i.lastClr=null,i.val=n,i.lastClr=r;var s=r;return null==s&&(s="windowText"===n?"000000":"FFFFFF"),i.color=t.mxgraph.io.vsdx.theme.Color.decodeColorHex(s),i}return __extends(n,e),n}(t.mxgraph.io.vsdx.theme.OoxmlColor),i.SysClr=s,s.__class="com.mxgraph.io.vsdx.theme.SysClr"}(com||(com={})),function(t){var e,n,r,i,s;e=t.mxgraph||(t.mxgraph={}),n=e.io||(e.io={}),r=n.vsdx||(n.vsdx={}),i=r.geometry||(r.geometry={}),s=function(e){function n(t,n,r,i,s,a,o){return e.call(this,t,n,r,i,s,a,o)||this}return __extends(n,e),n.prototype.handle=function(n,r){if(null!=this.x&&null!=this.y&&null!=this.a&&null!=this.b&&null!=this.c&&null!=this.d){var i=r.getHeight()/t.mxgraph.io.vsdx.mxVsdxUtils.conversionFactor_$LI$(),s=r.getWidth()/t.mxgraph.io.vsdx.mxVsdxUtils.conversionFactor_$LI$();this.x*=s,this.y*=i,this.a*=s,this.b*=i}return e.prototype.handle.call(this,n,r)},n}(t.mxgraph.io.vsdx.geometry.EllipticalArcTo),i.RelEllipticalArcTo=s,s.__class="com.mxgraph.io.vsdx.geometry.RelEllipticalArcTo"}(com||(com={})),function(t){var e,n,r,i;e=t.mxgraph||(t.mxgraph={}),n=e.io||(e.io={}),r=n.vsdx||(n.vsdx={}),(i=function(e){function n(n,r){var i,s,a=this;return a.text=null,a.fields=null,a.geom=null,a.imageData=null,a.theme=null,a.quickStyleVals=null,(a=e.call(this,n,r)||this).paragraphs=null,a.styleMap={},a.width=0,a.height=0,a.rotation=0,a.lastX=0,a.lastY=0,a.lastMoveX=0,a.lastMoveY=0,a.lastKnot=-1,a.geomList=null,a.geomListProcessed=!1,a.themeVariant=0,a.cp="0",a.pp="0",a.tp="0",a.fld="0",a.width=a.getScreenNumericalValue$org_w3c_dom_Element$double((i=a.cellElements)[s=t.mxgraph.io.vsdx.mxVsdxConstants.WIDTH]?i[s]:null,0),a.height=a.getScreenNumericalValue$org_w3c_dom_Element$double(function(t,e){return t[e]?t[e]:null}(a.cellElements,t.mxgraph.io.vsdx.mxVsdxConstants.HEIGHT),0),a}return __extends(n,e),n.UNICODE_LINE_SEP_$LI$=function(){return null==n.UNICODE_LINE_SEP&&(n.ERROR_IMAGE="PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+DQo8IS0tIENyZWF0ZWQgd2l0aCBJbmtzY2FwZSAoaHR0cDovL3d3dy5pbmtzY2FwZS5vcmcvKSAtLT4NCjxzdmcNCiAgIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyINCiAgIHhtbG5zOmNjPSJodHRwOi8vY3JlYXRpdmVjb21tb25zLm9yZy9ucyMiDQogICB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiDQogICB4bWxuczpzdmc9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIg0KICAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIg0KICAgeG1sbnM6c29kaXBvZGk9Imh0dHA6Ly9zb2RpcG9kaS5zb3VyY2Vmb3JnZS5uZXQvRFREL3NvZGlwb2RpLTAuZHRkIg0KICAgeG1sbnM6aW5rc2NhcGU9Imh0dHA6Ly93d3cuaW5rc2NhcGUub3JnL25hbWVzcGFjZXMvaW5rc2NhcGUiDQogICB3aWR0aD0iMjUwIg0KICAgaGVpZ2h0PSIyNTAiDQogICBpZD0ic3ZnMzMxOSINCiAgIHNvZGlwb2RpOnZlcnNpb249IjAuMzIiDQogICBpbmtzY2FwZTp2ZXJzaW9uPSIwLjQ2Ig0KICAgdmVyc2lvbj0iMS4wIg0KICAgc29kaXBvZGk6ZG9jbmFtZT0ibm9waG90b19pLnN2ZyINCiAgIGlua3NjYXBlOm91dHB1dF9leHRlbnNpb249Im9yZy5pbmtzY2FwZS5vdXRwdXQuc3ZnLmlua3NjYXBlIj4NCiAgPGRlZnMNCiAgICAgaWQ9ImRlZnMzMzIxIj4NCiAgICA8aW5rc2NhcGU6cGVyc3BlY3RpdmUNCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIg0KICAgICAgIGlua3NjYXBlOnZwX3g9IjAgOiA1MjYuMTgxMDkgOiAxIg0KICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCINCiAgICAgICBpbmtzY2FwZTp2cF96PSI3NDQuMDk0NDggOiA1MjYuMTgxMDkgOiAxIg0KICAgICAgIGlua3NjYXBlOnBlcnNwM2Qtb3JpZ2luPSIzNzIuMDQ3MjQgOiAzNTAuNzg3MzkgOiAxIg0KICAgICAgIGlkPSJwZXJzcGVjdGl2ZTMzMjciIC8+DQogICAgPGlua3NjYXBlOnBlcnNwZWN0aXZlDQogICAgICAgaWQ9InBlcnNwZWN0aXZlMzM0MiINCiAgICAgICBpbmtzY2FwZTpwZXJzcDNkLW9yaWdpbj0iMzcyLjA0NzI0IDogMzUwLjc4NzM5IDogMSINCiAgICAgICBpbmtzY2FwZTp2cF96PSI3NDQuMDk0NDggOiA1MjYuMTgxMDkgOiAxIg0KICAgICAgIGlua3NjYXBlOnZwX3k9IjAgOiAxMDAwIDogMCINCiAgICAgICBpbmtzY2FwZTp2cF94PSIwIDogNTI2LjE4MTA5IDogMSINCiAgICAgICBzb2RpcG9kaTp0eXBlPSJpbmtzY2FwZTpwZXJzcDNkIiAvPg0KICA8L2RlZnM+DQogIDxzb2RpcG9kaTpuYW1lZHZpZXcNCiAgICAgaWQ9ImJhc2UiDQogICAgIHBhZ2Vjb2xvcj0iI2ZmZmZmZiINCiAgICAgYm9yZGVyY29sb3I9IiM2NjY2NjYiDQogICAgIGJvcmRlcm9wYWNpdHk9IjEuMCINCiAgICAgaW5rc2NhcGU6cGFnZW9wYWNpdHk9IjAuMCINCiAgICAgaW5rc2NhcGU6cGFnZXNoYWRvdz0iMiINCiAgICAgaW5rc2NhcGU6em9vbT0iMi4yNDI5NDI3Ig0KICAgICBpbmtzY2FwZTpjeD0iMTIxLjk3NjQ4Ig0KICAgICBpbmtzY2FwZTpjeT0iMTIyLjQ0MTk4Ig0KICAgICBpbmtzY2FwZTpkb2N1bWVudC11bml0cz0icHgiDQogICAgIGlua3NjYXBlOmN1cnJlbnQtbGF5ZXI9ImxheWVyMSINCiAgICAgc2hvd2dyaWQ9ImZhbHNlIg0KICAgICBpbmtzY2FwZTp3aW5kb3ctd2lkdGg9IjE2NjQiDQogICAgIGlua3NjYXBlOndpbmRvdy1oZWlnaHQ9Ijg0NCINCiAgICAgaW5rc2NhcGU6d2luZG93LXg9Ii0zIg0KICAgICBpbmtzY2FwZTp3aW5kb3cteT0iLTE4IiAvPg0KICA8bWV0YWRhdGENCiAgICAgaWQ9Im1ldGFkYXRhMzMyNCI+DQogICAgPHJkZjpSREY+DQogICAgICA8Y2M6V29yaw0KICAgICAgICAgcmRmOmFib3V0PSIiPg0KICAgICAgICA8ZGM6Zm9ybWF0PmltYWdlL3N2Zyt4bWw8L2RjOmZvcm1hdD4NCiAgICAgICAgPGRjOnR5cGUNCiAgICAgICAgICAgcmRmOnJlc291cmNlPSJodHRwOi8vcHVybC5vcmcvZGMvZGNtaXR5cGUvU3RpbGxJbWFnZSIgLz4NCiAgICAgICAgPGRjOnRpdGxlPkZvdG9ncmFmaWVydmVyYm90PC9kYzp0aXRsZT4NCiAgICAgICAgPGRjOmRhdGU+MjAwOC0wNi0yOTwvZGM6ZGF0ZT4NCiAgICAgICAgPGRjOmNyZWF0b3I+DQogICAgICAgICAgPGNjOkFnZW50Pg0KICAgICAgICAgICAgPGRjOnRpdGxlPlRvcnJzdGVuIFNrb21wPC9kYzp0aXRsZT4NCiAgICAgICAgICA8L2NjOkFnZW50Pg0KICAgICAgICA8L2RjOmNyZWF0b3I+DQogICAgICAgIDxkYzpyaWdodHM+DQogICAgICAgICAgPGNjOkFnZW50Pg0KICAgICAgICAgICAgPGRjOnRpdGxlPlRvcnN0ZW4gU2tvbXA8L2RjOnRpdGxlPg0KICAgICAgICAgIDwvY2M6QWdlbnQ+DQogICAgICAgIDwvZGM6cmlnaHRzPg0KICAgICAgICA8ZGM6cHVibGlzaGVyPg0KICAgICAgICAgIDxjYzpBZ2VudD4NCiAgICAgICAgICAgIDxkYzp0aXRsZT5Ub3JzdGVuIFNrb21wPC9kYzp0aXRsZT4NCiAgICAgICAgICA8L2NjOkFnZW50Pg0KICAgICAgICA8L2RjOnB1Ymxpc2hlcj4NCiAgICAgICAgPGRjOmxhbmd1YWdlPmRlX0RFPC9kYzpsYW5ndWFnZT4NCiAgICAgICAgPGRjOnN1YmplY3Q+DQogICAgICAgICAgPHJkZjpCYWc+DQogICAgICAgICAgICA8cmRmOmxpPlBpa3RvZ3JhbW07IEZvdG9ncmFmaWVydmVyYm90PC9yZGY6bGk+DQogICAgICAgICAgPC9yZGY6QmFnPg0KICAgICAgICA8L2RjOnN1YmplY3Q+DQogICAgICAgIDxkYzpkZXNjcmlwdGlvbj5Gb3RvZ3JhZmllcnZlcmJvdCBhbHMgUGlrdG9ncmFtbSA8L2RjOmRlc2NyaXB0aW9uPg0KICAgICAgICA8Y2M6bGljZW5zZQ0KICAgICAgICAgICByZGY6cmVzb3VyY2U9Imh0dHA6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL3B1YmxpY2RvbWFpbi8iIC8+DQogICAgICA8L2NjOldvcms+DQogICAgICA8Y2M6TGljZW5zZQ0KICAgICAgICAgcmRmOmFib3V0PSJodHRwOi8vY3JlYXRpdmVjb21tb25zLm9yZy9saWNlbnNlcy9wdWJsaWNkb21haW4vIj4NCiAgICAgICAgPGNjOnBlcm1pdHMNCiAgICAgICAgICAgcmRmOnJlc291cmNlPSJodHRwOi8vY3JlYXRpdmVjb21tb25zLm9yZy9ucyNSZXByb2R1Y3Rpb24iIC8+DQogICAgICAgIDxjYzpwZXJtaXRzDQogICAgICAgICAgIHJkZjpyZXNvdXJjZT0iaHR0cDovL2NyZWF0aXZlY29tbW9ucy5vcmcvbnMjRGlzdHJpYnV0aW9uIiAvPg0KICAgICAgICA8Y2M6cGVybWl0cw0KICAgICAgICAgICByZGY6cmVzb3VyY2U9Imh0dHA6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL25zI0Rlcml2YXRpdmVXb3JrcyIgLz4NCiAgICAgIDwvY2M6TGljZW5zZT4NCiAgICA8L3JkZjpSREY+DQogIDwvbWV0YWRhdGE+DQogIDxnDQogICAgIGlua3NjYXBlOmxhYmVsPSJFYmVuZSAxIg0KICAgICBpbmtzY2FwZTpncm91cG1vZGU9ImxheWVyIg0KICAgICBpZD0ibGF5ZXIxIj4NCiAgICA8cGF0aA0KICAgICAgIHN0eWxlPSJmaWxsOiMwMDAwMDA7ZmlsbC1vcGFjaXR5OjEiDQogICAgICAgZD0iTSAxNjQuNTMxMjUgNjIuNjg3NSBDIDE2Mi43OTExNSA2Mi42ODc1MDEgMTYxLjM3NSA2NC4wNzI0MTYgMTYxLjM3NSA2NS44MTI1IEwgMTYxLjM3NSA2OC43NSBMIDM4LjM3NSA2OC43NSBDIDM1LjA5MjI5OCA2OC43NDk5OTkgMzIuNDY4NzUgNzEuMzczNTQ4IDMyLjQ2ODc1IDc0LjY1NjI1IEwgMzIuNDY4NzUgMTgxLjM3NSBDIDMyLjQ2ODc1IDE4NC42NTc3IDM1LjA5MjMwNyAxODcuMzEyNTEgMzguMzc1IDE4Ny4zMTI1IEwgMjExLjYyNSAxODcuMzEyNSBDIDIxNC45MDc2OSAxODcuMzEyNSAyMTcuNTMxMjcgMTg0LjY1NzcgMjE3LjUzMTI1IDE4MS4zNzUgTCAyMTcuNTMxMjUgNzQuNjU2MjUgQyAyMTcuNTMxMjUgNzEuMzczNTUxIDIxNC45MDc2OCA2OC43NSAyMTEuNjI1IDY4Ljc1IEwgMjAyLjA2MjUgNjguNzUgTCAyMDIuMDYyNSA2NS44MTI1IEMgMjAyLjA2MjUgNjQuMDcyNDEgMjAwLjY0NjM1IDYyLjY4NzUgMTk4LjkwNjI1IDYyLjY4NzUgTCAxNjQuNTMxMjUgNjIuNjg3NSB6IE0gNDYuODEyNSA3OCBMIDg4LjY1NjI1IDc4IEMgOTAuMzk2MzQyIDc4IDkxLjgxMjUgNzkuMzg0OTA3IDkxLjgxMjUgODEuMTI1IEwgOTEuODEyNSA5Ni4zMTI1IEMgOTEuODEyNSA5OC4wNTI1OTIgOTAuMzk2MzQzIDk5LjQzNzUgODguNjU2MjUgOTkuNDM3NSBMIDQ2LjgxMjUgOTkuNDM3NSBDIDQ1LjA3MjQwOCA5OS40Mzc1IDQzLjY4NzUgOTguMDUyNTkzIDQzLjY4NzUgOTYuMzEyNSBMIDQzLjY4NzUgODEuMTI1IEMgNDMuNjg3NSA3OS4zODQ5MDggNDUuMDcyNDA3IDc4IDQ2LjgxMjUgNzggeiBNIDE0NiA4OC4yMTg3NSBDIDE2Ny43MzQ3NSA4OC4yMTg3NTMgMTg1LjM3NSAxMDYuMTUwNzEgMTg1LjM3NSAxMjguMjUgQyAxODUuMzc0OTkgMTUwLjM0OTI4IDE2Ny43MzQ3NCAxNjguMjgxMjUgMTQ2IDE2OC4yODEyNSBDIDEyNC4yNjUyNyAxNjguMjgxMjYgMTA2LjYyNSAxNTAuMzQ5MjkgMTA2LjYyNSAxMjguMjUgQyAxMDYuNjI1IDEwNi4xNTA3MSAxMjQuMjY1MjYgODguMjE4NzUgMTQ2IDg4LjIxODc1IHogTSAxNDYgOTEuNzE4NzUgQyAxMjYuMTY1NTcgOTEuNzE4NzUgMTEwLjA2MjUgMTA4LjA4Mjg5IDExMC4wNjI1IDEyOC4yNSBDIDExMC4wNjI1IDE0OC40MTcxMSAxMjYuMTY1NTcgMTY0Ljc4MTI2IDE0NiAxNjQuNzgxMjUgQyAxNjUuODM0NDMgMTY0Ljc4MTI1IDE4MS45Mzc1IDE0OC40MTcxIDE4MS45Mzc1IDEyOC4yNSBDIDE4MS45Mzc1IDEwOC4wODI4OSAxNjUuODM0NDMgOTEuNzE4NzUgMTQ2IDkxLjcxODc1IHogTSAxNDYgOTYuNTkzNzUgQyAxNjMuMTc3NjggOTYuNTkzNzUyIDE3Ny4xMjUgMTEwLjc4NDIgMTc3LjEyNSAxMjguMjUgQyAxNzcuMTI0OTkgMTQ1LjcxNTggMTYzLjE3NzY5IDE1OS44NzUgMTQ2IDE1OS44NzUgQyAxMjguODIyMzEgMTU5Ljg3NSAxMTQuODc1IDE0NS43MTU4IDExNC44NzUgMTI4LjI1IEMgMTE0Ljg3NSAxMTAuNzg0MTkgMTI4LjgyMjMxIDk2LjU5Mzc1IDE0NiA5Ni41OTM3NSB6IE0gMTc2LjUgMTcyLjcxODc1IEwgMjA2LjE4NzUgMTcyLjcxODc1IEMgMjA3LjQyMTM4IDE3Mi43MTg3NSAyMDguNDA2MjUgMTczLjEyNzgzIDIwOC40MDYyNSAxNzMuNjI1IEwgMjA4LjQwNjI1IDE3Ny45Njg3NSBDIDIwOC40MDYyNSAxNzguNDY1OTIgMjA3LjQyMTM4IDE3OC44NDM3NSAyMDYuMTg3NSAxNzguODQzNzUgTCAxNzYuNSAxNzguODQzNzUgQyAxNzUuMjY2MTEgMTc4Ljg0Mzc1IDE3NC4yODEyNSAxNzguNDY1OTIgMTc0LjI4MTI1IDE3Ny45Njg3NSBMIDE3NC4yODEyNSAxNzMuNjI1IEMgMTc0LjI4MTI1IDE3My4xMjc4MyAxNzUuMjY2MTIgMTcyLjcxODc1IDE3Ni41IDE3Mi43MTg3NSB6ICINCiAgICAgICBpZD0icmVjdDMyMDkiIC8+DQogICAgPHBhdGgNCiAgICAgICBzdHlsZT0iZmlsbDojYzQyNjFkO2ZpbGwtb3BhY2l0eToxIg0KICAgICAgIGQ9Ik0gMjAgMCBDIDE4LjU1OTkzOCAwIDE3LjE2NDc0NyAwLjE1MDk4NjY2IDE1LjgxMjUgMC40Mzc1IEMgMTUuMjEwMjkxIDAuNTY1MTk1NzggMTQuNjExOTEzIDAuNzI2MjExMjYgMTQuMDMxMjUgMC45MDYyNSBDIDEzLjU1NDc3MyAxLjA1Mzk4NTIgMTMuMDg1MzQ5IDEuMjI0ODUzNiAxMi42MjUgMS40MDYyNSBDIDEyLjMyODc2NiAxLjUyMzA3MzkgMTIuMDM5MDMzIDEuNjUwOTE4MiAxMS43NSAxLjc4MTI1IEMgMTEuMzQ3Mjc4IDEuOTYyMzU5OCAxMC45NTA0MDYgMi4xMzc0MTY1IDEwLjU2MjUgMi4zNDM3NSBDIDEwLjUyMTU1NSAyLjM2NTU2ODggMTAuNDc4MjczIDIuMzg0MTU1NSAxMC40Mzc1IDIuNDA2MjUgQyAxMC40MTY5MzQgMi40MTczNzU0IDEwLjM5NTUyMiAyLjQyNjMwNDkgMTAuMzc1IDIuNDM3NSBDIDkuODMyNjg2MSAyLjczMzM0NDYgOS4zMjI2NDQ4IDMuMDYzMjQ1MiA4LjgxMjUgMy40MDYyNSBDIDguMjgzMTIyMSAzLjc2MjE4NjUgNy43NzI3NzI4IDQuMTU4OTIwOSA3LjI4MTI1IDQuNTYyNSBDIDcuMjc1MDU1IDQuNTY3NTg2NiA3LjI1NjE4ODggNC41NTc0MDYxIDcuMjUgNC41NjI1IEMgNy4yMzg1NDc5IDQuNTcxOTQzNCA3LjIzMDE4MDYgNC41ODQyODE2IDcuMjE4NzUgNC41OTM3NSBDIDcuMTA0NzM1MiA0LjY4ODAxNTkgNi45ODY4NTA3IDQuNzc4MjY4NyA2Ljg3NSA0Ljg3NSBDIDYuNTE1NzAyMSA1LjE4NjQyNjQgNi4xNzk3OTA5IDUuNTA3NzA5MSA1Ljg0Mzc1IDUuODQzNzUgQyA1LjQwNDQwMjUgNi4yODE4MDc4IDQuOTkwNzQ0OSA2Ljc0MTM1NTQgNC41OTM3NSA3LjIxODc1IEMgNC41NzkwMDg2IDcuMjM2NTQ2MiA0LjU3NzE4MDYgNy4yNjM0MDE1IDQuNTYyNSA3LjI4MTI1IEMgMy43Njc0ODk4IDguMjQzOTE4MSAzLjA0MjI3MjEgOS4yNzE4NzA1IDIuNDM3NSAxMC4zNzUgQyAyLjQyNjIyMzIgMTAuMzk1NjM1IDIuNDE3NDU2MSAxMC40MTY4MiAyLjQwNjI1IDEwLjQzNzUgQyAyLjEwODM5MDggMTAuOTg1MzQ4IDEuODQwMjIzMyAxMS41NDcyMTQgMS41OTM3NSAxMi4xMjUgQyAxLjU3NTU4NjUgMTIuMTY3NjY1IDEuNTQ5MTI1NSAxMi4yMDcxODIgMS41MzEyNSAxMi4yNSBDIDEuMjg3NzEzMSAxMi44MzI0MzMgMS4wOTQ2NzU0IDEzLjQyMTgyMiAwLjkwNjI1IDE0LjAzMTI1IEMgMC43Mjk2MzAxNCAxNC42MDI0OTUgMC41NjMwOTYzNCAxNS4xODg4MjggMC40Mzc1IDE1Ljc4MTI1IEMgMC4xNDY5MTQwNCAxNy4xNDI1NzggLTQuMzkwNjEzM2UtMTggMTguNTQ5NDY2IDAgMjAgTCAwIDIzMCBDIDAgMjQxLjA4IDguOTIgMjUwIDIwIDI1MCBMIDIzMCAyNTAgQyAyMzEuNDQwMDYgMjUwIDIzMi44MzUyNSAyNDkuODQ5MDEgMjM0LjE4NzUgMjQ5LjU2MjUgQyAyMzQuNzg5MDMgMjQ5LjQzNDk3IDIzNS4zODg2NiAyNDkuMjczODEgMjM1Ljk2ODc1IDI0OS4wOTM3NSBDIDIzNi40NDQ3NiAyNDguOTQ2IDIzNi45MTUwNSAyNDguNzc1MjYgMjM3LjM3NSAyNDguNTkzNzUgQyAyMzcuNjcxMjMgMjQ4LjQ3NjkzIDIzNy45NjA5NyAyNDguMzQ5MDggMjM4LjI1IDI0OC4yMTg3NSBDIDIzOC4yNzk4MSAyNDguMjA1MzEgMjM4LjMxNDAyIDI0OC4yMDEwOSAyMzguMzQzNzUgMjQ4LjE4NzUgQyAyMzguNzU4MzYgMjQ3Ljk5ODMgMjM5LjE2Mzc0IDI0Ny44MDk4MSAyMzkuNTYyNSAyNDcuNTkzNzUgQyAyMzkuNTgzMTggMjQ3LjU4MjU0IDIzOS42MDQzNiAyNDcuNTczNzggMjM5LjYyNSAyNDcuNTYyNSBDIDI0MC4xNjkyNSAyNDcuMjY1MTIgMjQwLjY3NTU4IDI0Ni45Mzg3MyAyNDEuMTg3NSAyNDYuNTkzNzUgQyAyNDEuNjY4NzggMjQ2LjI2OTQxIDI0Mi4xNDM1OSAyNDUuOTI2MzkgMjQyLjU5Mzc1IDI0NS41NjI1IEMgMjQyLjY0NDc0IDI0NS41MjEyOCAyNDIuNjk5NDMgMjQ1LjQ3OTIxIDI0Mi43NSAyNDUuNDM3NSBDIDI0Mi44NzY1MSAyNDUuMzMzMTggMjQzLjAwMTE1IDI0NS4yMzIzNSAyNDMuMTI1IDI0NS4xMjUgQyAyNDMuNDgyNjUgMjQ0LjgxNTM4IDI0My44MjE1NSAyNDQuNDkwMTkgMjQ0LjE1NjI1IDI0NC4xNTYyNSBDIDI0NC40OTIyOSAyNDMuODIwMjEgMjQ0LjgxMzU3IDI0My40ODQzIDI0NS4xMjUgMjQzLjEyNSBDIDI0NS4yMzE2NyAyNDMuMDAyMzQgMjQ1LjMzMzgxIDI0Mi44NzUyNyAyNDUuNDM3NSAyNDIuNzUgQyAyNDUuNDQyNzYgMjQyLjc0MzYyIDI0NS40MzIyNSAyNDIuNzI1MTMgMjQ1LjQzNzUgMjQyLjcxODc1IEMgMjQ1Ljg0MjQ5IDI0Mi4yMjgzIDI0Ni4yMzY0IDI0MS43MTU3NiAyNDYuNTkzNzUgMjQxLjE4NzUgQyAyNDYuOTM4MTIgMjQwLjY3ODQzIDI0Ny4yNjUzNiAyNDAuMTY2MjIgMjQ3LjU2MjUgMjM5LjYyNSBDIDI0Ny41NzM2MyAyMzkuNjA0NzIgMjQ3LjU4MjY4IDIzOS41ODI4MiAyNDcuNTkzNzUgMjM5LjU2MjUgQyAyNDcuODkxOTcgMjM5LjAxNDggMjQ4LjE1OTMxIDIzOC40NTIzOSAyNDguNDA2MjUgMjM3Ljg3NSBDIDI0OC40MTU1NCAyMzcuODUzMjggMjQ4LjQyODI5IDIzNy44MzQyNiAyNDguNDM3NSAyMzcuODEyNSBDIDI0OC40NDY0NCAyMzcuNzkxMjkgMjQ4LjQ1OTg4IDIzNy43NzEyNSAyNDguNDY4NzUgMjM3Ljc1IEMgMjQ4LjcwOTkyIDIzNy4xNzQ3NiAyNDguOTA2MjggMjM2LjU3MDA4IDI0OS4wOTM3NSAyMzUuOTY4NzUgQyAyNDkuMjczNzUgMjM1LjM5MTM3IDI0OS40MzQ2OCAyMzQuODE3NTQgMjQ5LjU2MjUgMjM0LjIxODc1IEMgMjQ5Ljg1MzA5IDIzMi44NTc0MiAyNTAgMjMxLjQ1MDUzIDI1MCAyMzAgTCAyNTAgMjAgQyAyNTAgOC45MiAyNDEuMDggLTMuMzUzNzk4N2UtMTcgMjMwIDAgTCAyMCAwIHogTSAzNC43ODEyNSAxOS40MDYyNSBMIDIyNS40Njg3NSAxOS40MDYyNSBDIDIyOC4zMDk0NiAxOS40MDYyNSAyMzAuNTkzNzUgMjEuNjkwNTQ0IDIzMC41OTM3NSAyNC41MzEyNSBMIDIzMC41OTM3NSAyMTUuMjUgTCAzNC43ODEyNSAxOS40MDYyNSB6IE0gMTkuNDA2MjUgMzQuNzUgTCAyMTUuMjE4NzUgMjMwLjU5Mzc1IEwgMjQuNTMxMjUgMjMwLjU5Mzc1IEMgMjEuNjkwNTQ0IDIzMC41OTM3NiAxOS40MDYyNSAyMjguMzA5NDYgMTkuNDA2MjUgMjI1LjQ2ODc1IEwgMTkuNDA2MjUgMzQuNzUgeiAiDQogICAgICAgaWQ9InBhdGgzMTk2IiAvPg0KICA8L2c+DQo8L3N2Zz4NCg==",n.UNICODE_LINE_SEP=String.fromCharCode(8232)),n.UNICODE_LINE_SEP},n.prototype.setThemeAndVariant=function(t,e){this.theme=t,this.themeVariant=e},n.prototype.getTheme=function(){return null!=this.theme&&this.theme.setVariant(this.themeVariant),this.theme},n.prototype.getQuickStyleVals=function(){return this.quickStyleVals},n.prototype.processGeomList=function(e){if(!this.geomListProcessed){if(this.geomList=new t.mxgraph.io.vsdx.mxVsdxGeometryList(e),null!=this.geom)for(var n=0;n<this.geom.length;n++){var r=this.geom[n];this.geomList.addGeometry(r)}this.geomListProcessed=!0}},n.prototype.parseShapeElem=function(r,i){e.prototype.parseShapeElem.call(this,r,i);var s,a,o,l,u,h,g=r.nodeName;if(h="ForeignData",(u=g)&&u.equals?u.equals(h):u===h){function c(t,e){for(var n=t.firstChild;null!=n;){if(1==n.nodeType){var r=n;if("rel"==r.nodeName.toLowerCase()){var s=r.getAttribute("r:id");if(null!=s&&0!==s.length){var a=e.lastIndexOf("/"),o="",l="";try{o=e.substring(0,a),l=e.substring(a,e.length)}catch(t){return}var u=i.getRelationship(s,o+"/_rels"+l+".rels");if(null!=u){var h=u.getAttribute("Target")||"",g=u.getAttribute("Type");a=h.lastIndexOf("/");try{h=h.substring(a+1,h.length)}catch(t){return}return{type:g,target:h}}return}}}n=n.nextSibling}}var x=r.ownerDocument.vsdxFileName,m=r.getAttribute("ForeignType"),p=r.getAttribute("CompressionType")||"",d=null;if(function(t,e){return t&&t.equals?t.equals(e):t===e}(m,"Bitmap"))p=p.toLowerCase();else if(function(t,e){return t&&t.equals?t.equals(e):t===e}(m,"MetaFile"))p="png";else if(function(t,e){return t&&t.equals?t.equals(e):t===e}(m,"Enhanced Metafile")||function(t,e){return t&&t.equals?t.equals(e):t===e}(m,"EnhMetaFile"))p="png";else{if("Object"!=m)return;if((d=c(r,x)).type.indexOf("/oleObject")>0){var v=i.getRelationship("rId1","visio/embeddings/_rels/"+d.target+".rels");if(null==v)return;var y=v.getAttribute("Target"),f=v.getAttribute("Type");try{var _=y.lastIndexOf("/");y=y.substring(_+1,y.length)}catch(C){return}p="png",d={type:f,target:y}}}if(null==d&&(d=c(r,x)),f=d.type,y=d.target,null!=f&&(a="image",o=(s=f).length-a.length,-1!==(l=s.indexOf(a,o))&&l===o)){this.imageData={};var S=i.getMedia(t.mxgraph.io.mxVsdxCodec.vsdxPlaceholder+"/media/"+y);S?(this.imageData.iData=S,function(t,e){var n=t.length-e.length,r=t.indexOf(e,n);return-1!==r&&r===n}(y.toLowerCase(),".bmp")&&(p="jpg"),this.imageData.iType=p):(this.imageData.iData=n.ERROR_IMAGE,this.imageData.iType="svg+xml")}}else(function(t,e){return t&&t.equals?t.equals(e):t===e})(g,t.mxgraph.io.vsdx.mxVsdxConstants.TEXT)&&(this.text=r)},n.prototype.parseSection=function(r){var i,s,a=r.getAttribute("N");if(s="Geometry",(i=a)&&i.equals?i.equals(s):i===s)null==this.geom&&(this.geom=[]),this.geom.push(r);else if(function(t,e){return t&&t.equals?t.equals(e):t===e}(a,"Field"))for(var o=t.mxgraph.io.vsdx.mxVsdxUtils.getDirectChildNamedElements(r,"Row"),l=0;l<o.length;l++){var u=o[l],h=u.getAttribute("IX")||"";if(0!==h.length){if(null==this.fields&&(this.fields={}),function(t,e){return"1".equals?"1".equals(e):"1"===e}(0,u.getAttribute("Del"))){this.fields[h]="";continue}for(var g=t.mxgraph.io.vsdx.mxVsdxUtils.getDirectChildNamedElements(u,"Cell"),c="",x="",m=0;m<g.length;m++){var p=g[m];a=p.getAttribute("N");var d=p.getAttribute("V")||p.textContent||"";switch(a){case"Value":c=d;break;case"Format":x=d}}if(0!==c.length){try{var v=isNaN(c)?new Date(c):new Date(n.VSDX_START_TIME+Math.floor(24*parseFloat(c)*60*60*1e3));x="c"==x?v.getHours()+v.getMinutes()+v.getSeconds()+v.getMilliseconds()==0?"m/d/yyyy":"m/d/yyyy h:MM:ss tt":"ddddd"==x?"m/d/yyyy":"dddddd"==x?"dddd, mmmm dd, yyyy":"C"==x?"dddd, mmmm dd, yyyy h:MM:ss tt":"T"==x?"h:MM:ss tt":x.replace(/am\/pm/g,"tt").replace(/m/g,"@").replace(/M/g,"m").replace(/@/g,"M"),c=Graph.prototype.formatDate(v,"UTC:"+x.replace(new RegExp("\\{|\\}","g"),""))}catch(t){}this.fields[h]=c}}}else e.prototype.parseSection.call(this,r)},n.prototype.parseGeom=function(){return this.hasGeomList()?this.geomList.getShapeXML(this):""},n.prototype.getText=function(){return null!=this.text?this.text.textContent:null},n.prototype.getTextChildren=function(){return null!=this.text?this.text.childNodes:null},n.prototype.getWidth=function(){return 0===this.width&&this.height>0?1:this.width},n.prototype.getHeight=function(){return 0===this.height&&this.width>0?1:this.height},n.prototype.getRotation=function(){return this.rotation},n.prototype.getStyleMap=function(){return this.styleMap},n.prototype.hasGeom=function(){return!(null==this.geom||0==this.geom.length)},n.prototype.hasGeomList=function(){return null!=this.geomList&&this.geomList.hasGeom()},n.prototype.getPPList=function(t){var e=null;if(""!=t){var n=this.getBullet(t);"0"!=n&&(e='<ul style="margin: 0;list-style-type: '+("4"==n?"square":"disc")+'">')}return e},n.prototype.getTextParagraphFormated=function(t){var e="",n={};return n.align=this.getHorizontalAlign(this.pp,!0),n["margin-left"]=this.getIndentLeft(this.pp),n["margin-right"]=this.getIndentRight(this.pp),n["margin-top"]=this.getSpBefore(this.pp)+"px",n["margin-bottom"]=this.getSpAfter(this.pp)+"px",n["text-indent"]=this.getIndentFirst(this.pp),n.valign=this.getAlignVertical(),n.direction=this.getTextDirection(this.pp),e+this.insertAttributes(t,n)},n.prototype.getTextCharFormated=function(e){var n,r="",i="color:"+this.getTextColor(this.cp)+";",s="font-size:"+parseFloat(this.getTextSize(this.cp))+"px;",a="font-family:"+this.getTextFont(this.cp)+";",o="direction:"+this.getRtlText(this.cp)+";",l="letter-spacing:"+parseFloat(this.getLetterSpace(this.cp))/.71+"px;",u="line-height:"+this.getSpcLine(this.pp),h=";opacity:"+this.getTextOpacity(this.cp),g=this.getTextPos(this.cp),c=this.getTextCase(this.cp);return((n=c)&&n.equals?n.equals("1"):"1"===n)?e=e.toUpperCase():function(t,e){return t&&t.equals?t.equals("2"):"2"===t}(c)&&(e=t.mxgraph.io.vsdx.mxVsdxUtils.toInitialCapital(e)),function(t,e){return t&&t.equals?t.equals("1"):"1"===t}(g)?e=t.mxgraph.io.vsdx.mxVsdxUtils.surroundByTags(e,"sup"):function(t,e){return t&&t.equals?t.equals("2"):"2"===t}(g)&&(e=t.mxgraph.io.vsdx.mxVsdxUtils.surroundByTags(e,"sub")),e=this.isBold(this.cp)?t.mxgraph.io.vsdx.mxVsdxUtils.surroundByTags(e,"b"):e,e=this.isItalic(this.cp)?t.mxgraph.io.vsdx.mxVsdxUtils.surroundByTags(e,"i"):e,e=this.isUnderline(this.cp)?t.mxgraph.io.vsdx.mxVsdxUtils.surroundByTags(e,"u"):e,e=this.getTextStrike(this.cp)?t.mxgraph.io.vsdx.mxVsdxUtils.surroundByTags(e,"s"):e,r+'<font style="'+s+a+i+o+l+u+h+'">'+(e=this.isSmallCaps(this.cp)?t.mxgraph.io.vsdx.mxVsdxUtils.toSmallCaps(e,this.getTextSize(this.cp)):e)+"</font>"},n.prototype.getTextDirection=function(t){var e,n=this.getFlags(t);return((e=n)&&e.equals?e.equals("0"):"0"===e)?n="ltr":function(t,e){return t&&t.equals?t.equals("1"):"1"===t}(n)&&(n="rtl"),n},n.prototype.getSpcLine=function(e){var n=!1,r=this.getSpLine(e);return r>0?r*=t.mxgraph.io.vsdx.mxVsdxUtils.conversionFactor_$LI$():0===r?(r=100,n=!0):(r=100*Math.abs(r),n=!0),new String(r).toString()+(n?"%":"px")},n.prototype.getSpcBefore=function(t){return this.getSpBefore(t)},n.prototype.insertAttributes=function(e,n){if(-1!=e.indexOf(">")){var r=e.indexOf(">"),i=e.substring(r);return e.substring(0,r)+' style="'+t.mxgraph.io.vsdx.mxVsdxUtils.getStyleString(n,":")+'"'+i}return e},n.prototype.getRtlText=function(e){var n,r=this.getCellElement$java_lang_String$java_lang_String$java_lang_String(t.mxgraph.io.vsdx.mxVsdxConstants.RTL_TEXT,e,t.mxgraph.io.vsdx.mxVsdxConstants.PARAGRAPH),i=this.getValue(r,"ltr");return((n=i)&&n.equals?n.equals("0"):"0"===n)?i="ltr":function(t,e){return t&&t.equals?t.equals("1"):"1"===t}(i)&&(i="rtl"),i},n.prototype.isBold=function(t){var e,n=!1,r=this.getTextStyle(t);return((e=r)&&e.equals?e.equals(""):""===e)||function(t,e){return t&&t.equals?t.equals(e):t===e}(r.toLowerCase(),"themed")||(n=1==(1&parseInt(r))),n},n.prototype.isItalic=function(t){var e,n=!1,r=this.getTextStyle(t);return((e=r)&&e.equals?e.equals(""):""===e)||function(t,e){return t&&t.equals?t.equals(e):t===e}(r.toLowerCase(),"themed")||(n=2==(2&parseInt(r))),n},n.prototype.isUnderline=function(t){var e,n=!1,r=this.getTextStyle(t);return((e=r)&&e.equals?e.equals(""):""===e)||function(t,e){return t&&t.equals?t.equals(e):t===e}(r.toLowerCase(),"themed")||(n=4==(4&parseInt(r))),n},n.prototype.isSmallCaps=function(t){var e,n=!1,r=this.getTextStyle(t);return((e=r)&&e.equals?e.equals(""):""===e)||function(t,e){return t&&t.equals?t.equals(e):t===e}(r.toLowerCase(),"themed")||(n=8==(8&parseInt(r))),n},n.prototype.getTextOpacity=function(e){var n=this.getCellElement$java_lang_String$java_lang_String$java_lang_String(t.mxgraph.io.vsdx.mxVsdxConstants.COLOR_TRANS,e,t.mxgraph.io.vsdx.mxVsdxConstants.CHARACTER),r=this.getValue(n,"0"),i="1";if(null!=r&&0!==r.length){var s=1-parseFloat(r);i=new String(s).toString()}return i},n.prototype.getTextSize=function(e){var n=this.getCellElement$java_lang_String$java_lang_String$java_lang_String(t.mxgraph.io.vsdx.mxVsdxConstants.SIZE,e,t.mxgraph.io.vsdx.mxVsdxConstants.CHARACTER),r=this.getScreenNumericalValue$org_w3c_dom_Element$double(n,12);return""+Math.round(100*r)/100},n.prototype.getAlignVertical=function(){var e=mxConstants.ALIGN_MIDDLE,n=parseInt(this.getValue(this.getCellElement$java_lang_String(t.mxgraph.io.vsdx.mxVsdxConstants.VERTICAL_ALIGN),"1"));return 0===n?e=mxConstants.ALIGN_TOP:2===n&&(e=mxConstants.ALIGN_BOTTOM),e},n.prototype.getGeomList=function(){return this.geomList},n.prototype.getLastX=function(){return this.lastX},n.prototype.getLastY=function(){return this.lastY},n.prototype.getLastMoveX=function(){return this.lastMoveX},n.prototype.getLastMoveY=function(){return this.lastMoveY},n.prototype.getLastKnot=function(){return this.lastKnot},n.prototype.setLastX=function(t){this.lastX=t},n.prototype.setLastY=function(t){this.lastY=t},n.prototype.setLastMoveX=function(t){this.lastMoveX=t},n.prototype.setLastMoveY=function(t){this.lastMoveY=t},n.prototype.setLastKnot=function(t){this.lastKnot=t},n}(t.mxgraph.io.vsdx.Style)).VSDX_START_TIME=new Date("1899-12-30T00:00:00Z").getTime(),r.Shape=i,i.__class="com.mxgraph.io.vsdx.Shape"}(com||(com={})),function(t){var e,n,r,i;e=t.mxgraph||(t.mxgraph={}),n=e.io||(e.io={}),r=n.vsdx||(n.vsdx={}),(i=function(e){function n(n,r,i,s,a,o){var l=this;l.masterShape=null,l.master=null,l.parentHeight=0,(l=e.call(this,r,o)||this).htmlLabels=!0,l.rootShape=l,l.shapeName=null,l.shapeIndex=0,l.vertex=!0,l.childShapes={};var u,h,g=l.getMasterId(),c=l.getShapeMasterId();l.master=null!=g?(u=s)[h=g]?u[h]:null:a,null!=l.master&&(l.masterShape=null==g&&null!=c?l.master.getSubShape(c):l.master.getMasterShape());var x=l.getNameU(),m=x.lastIndexOf(".");-1!==m&&(x=x.substring(0,m)),l.shapeName=x;var p=r.getElementsByTagName(t.mxgraph.io.vsdx.mxVsdxConstants.SHAPES);if(null!=p&&p.length>0){var d=p.item(0);l.childShapes=n.parseShapes(d,l.master,!1)}var v=l.calcRotation();l.rotation=100*v/100,l.rotation=l.rotation%360;var y=n.getCellIntValue("ThemeIndex",-100);-100===y&&(y=parseInt(l.getValue(l.getCellElement$java_lang_String("ThemeIndex"),"0")));var f=function(t,e){null==t.entries&&(t.entries=[]);for(var n=0;n<t.entries.length;n++)if(null!=t.entries[n].key.equals&&t.entries[n].key.equals(e)||t.entries[n].key===e)return t.entries[n].value;return null}(o.getThemes(),y),_=n.getCellIntValue("VariationColorIndex",0);l.setThemeAndVariant(f,_);for(var S=function(t){return null==t.entries&&(t.entries=[]),t.entries}(l.childShapes),C=0;C<S.length;C++){var I=S[C].getValue();I.setRootShape(l),null==I.theme&&I.setThemeAndVariant(f,_)}return l.quickStyleVals=new t.mxgraph.io.vsdx.theme.QuickStyleVals(parseInt(l.getValue(l.getCellElement$java_lang_String("QuickStyleEffectsMatrix"),"0")),parseInt(l.getValue(l.getCellElement$java_lang_String("QuickStyleFillColor"),"1")),parseInt(l.getValue(l.getCellElement$java_lang_String("QuickStyleFillMatrix"),"0")),parseInt(l.getValue(l.getCellElement$java_lang_String("QuickStyleFontColor"),"1")),parseInt(l.getValue(l.getCellElement$java_lang_String("QuickStyleFontMatrix"),"0")),parseInt(l.getValue(l.getCellElement$java_lang_String("QuickStyleLineColor"),"1")),parseInt(l.getValue(l.getCellElement$java_lang_String("QuickStyleLineMatrix"),"0")),parseInt(l.getValue(l.getCellElement$java_lang_String("QuickStyleShadowColor"),"1")),parseInt(l.getValue(l.getCellElement$java_lang_String("QuickStyleType"),"0")),parseInt(l.getValue(l.getCellElement$java_lang_String("QuickStyleVariation"),"0"))),null!=l.masterShape?(l.masterShape.processGeomList(null),l.processGeomList(l.masterShape.getGeomList()),0===l.width&&(l.width=l.getScreenNumericalValue$org_w3c_dom_Element$double(l.getCellElement$java_lang_String(t.mxgraph.io.vsdx.mxVsdxConstants.WIDTH),0)),0===l.height&&(l.height=l.getScreenNumericalValue$org_w3c_dom_Element$double(l.getCellElement$java_lang_String(t.mxgraph.io.vsdx.mxVsdxConstants.HEIGHT),0))):l.processGeomList(null),l.vertex=i||null!=l.childShapes&&!function(t){return null==t.entries&&(t.entries=[]),0==t.entries.length}(l.childShapes)||null!=l.geomList&&(!l.geomList.isNoFill()||l.geomList.getGeoCount()>1),l.layerMember=l.getValue(l.getCellElement$java_lang_String("LayerMember")),l.layerMember&&0==l.layerMember.indexOf("0;")&&(l.layerMember=l.layerMember.substr(2)),l}return __extends(n,e),n.__static_initialize=function(){n.__static_initialized||(n.__static_initialized=!0,n.__static_initializer_0())},n.OFFSET_ARRAY_$LI$=function(){return n.__static_initialize(),null==n.OFFSET_ARRAY&&(n.OFFSET_ARRAY=["Organizational unit","Domain 3D"].slice(0).slice(0)),n.OFFSET_ARRAY},n.arrowSizes_$LI$=function(){return n.__static_initialize(),null==n.arrowSizes&&(n.arrowSizes=[2,3,5,7,9,22,45]),n.arrowSizes},n.arrowTypes_$LI$=function(){return n.__static_initialize(),n.arrowTypes},n.__static_initializer_0=function(){n.arrowTypes={},function(t,e,n){null==t.entries&&(t.entries=[]);for(var r=0;r<t.entries.length;r++)if(null!=t.entries[r].key.equals&&t.entries[r].key.equals(0)||0===t.entries[r].key)return void(t.entries[r].value=n);t.entries.push({key:0,value:n,getKey:function(){return this.key},getValue:function(){return this.value}})}(n.arrowTypes_$LI$(),0,mxConstants.NONE),function(t,e,n){null==t.entries&&(t.entries=[]);for(var r=0;r<t.entries.length;r++)if(null!=t.entries[r].key.equals&&t.entries[r].key.equals(1)||1===t.entries[r].key)return void(t.entries[r].value=n);t.entries.push({key:1,value:n,getKey:function(){return this.key},getValue:function(){return this.value}})}(n.arrowTypes_$LI$(),0,mxConstants.ARROW_OPEN),function(t,e,n){null==t.entries&&(t.entries=[]);for(var r=0;r<t.entries.length;r++)if(null!=t.entries[r].key.equals&&t.entries[r].key.equals(2)||2===t.entries[r].key)return void(t.entries[r].value=n);t.entries.push({key:2,value:n,getKey:function(){return this.key},getValue:function(){return this.value}})}(n.arrowTypes_$LI$(),0,"blockThin"),function(t,e,n){null==t.entries&&(t.entries=[]);for(var r=0;r<t.entries.length;r++)if(null!=t.entries[r].key.equals&&t.entries[r].key.equals(3)||3===t.entries[r].key)return void(t.entries[r].value=n);t.entries.push({key:3,value:n,getKey:function(){return this.key},getValue:function(){return this.value}})}(n.arrowTypes_$LI$(),0,mxConstants.ARROW_OPEN),function(t,e,n){null==t.entries&&(t.entries=[]);for(var r=0;r<t.entries.length;r++)if(null!=t.entries[r].key.equals&&t.entries[r].key.equals(4)||4===t.entries[r].key)return void(t.entries[r].value=n);t.entries.push({key:4,value:n,getKey:function(){return this.key},getValue:function(){return this.value}})}(n.arrowTypes_$LI$(),0,mxConstants.ARROW_BLOCK),function(t,e,n){null==t.entries&&(t.entries=[]);for(var r=0;r<t.entries.length;r++)if(null!=t.entries[r].key.equals&&t.entries[r].key.equals(5)||5===t.entries[r].key)return void(t.entries[r].value=n);t.entries.push({key:5,value:n,getKey:function(){return this.key},getValue:function(){return this.value}})}(n.arrowTypes_$LI$(),0,mxConstants.ARROW_CLASSIC),function(t,e,n){null==t.entries&&(t.entries=[]);for(var r=0;r<t.entries.length;r++)if(null!=t.entries[r].key.equals&&t.entries[r].key.equals(10)||10===t.entries[r].key)return void(t.entries[r].value=n);t.entries.push({key:10,value:n,getKey:function(){return this.key},getValue:function(){return this.value}})}(n.arrowTypes_$LI$(),0,mxConstants.ARROW_OVAL),function(t,e,n){null==t.entries&&(t.entries=[]);for(var r=0;r<t.entries.length;r++)if(null!=t.entries[r].key.equals&&t.entries[r].key.equals(13)||13===t.entries[r].key)return void(t.entries[r].value=n);t.entries.push({key:13,value:n,getKey:function(){return this.key},getValue:function(){return this.value}})}(n.arrowTypes_$LI$(),0,mxConstants.ARROW_BLOCK),function(t,e,n){null==t.entries&&(t.entries=[]);for(var r=0;r<t.entries.length;r++)if(null!=t.entries[r].key.equals&&t.entries[r].key.equals(14)||14===t.entries[r].key)return void(t.entries[r].value=n);t.entries.push({key:14,value:n,getKey:function(){return this.key},getValue:function(){return this.value}})}(n.arrowTypes_$LI$(),0,n.ARROW_NO_FILL_MARKER+mxConstants.ARROW_BLOCK),function(t,e,n){null==t.entries&&(t.entries=[]);for(var r=0;r<t.entries.length;r++)if(null!=t.entries[r].key.equals&&t.entries[r].key.equals(17)||17===t.entries[r].key)return void(t.entries[r].value=n);t.entries.push({key:17,value:n,getKey:function(){return this.key},getValue:function(){return this.value}})}(n.arrowTypes_$LI$(),0,n.ARROW_NO_FILL_MARKER+mxConstants.ARROW_CLASSIC),function(t,e,n){null==t.entries&&(t.entries=[]);for(var r=0;r<t.entries.length;r++)if(null!=t.entries[r].key.equals&&t.entries[r].key.equals(20)||20===t.entries[r].key)return void(t.entries[r].value=n);t.entries.push({key:20,value:n,getKey:function(){return this.key},getValue:function(){return this.value}})}(n.arrowTypes_$LI$(),0,n.ARROW_NO_FILL_MARKER+mxConstants.ARROW_OVAL),function(t,e,n){null==t.entries&&(t.entries=[]);for(var r=0;r<t.entries.length;r++)if(null!=t.entries[r].key.equals&&t.entries[r].key.equals(22)||22===t.entries[r].key)return void(t.entries[r].value=n);t.entries.push({key:22,value:n,getKey:function(){return this.key},getValue:function(){return this.value}})}(n.arrowTypes_$LI$(),0,n.ARROW_NO_FILL_MARKER+"diamond"),function(t,e,n){null==t.entries&&(t.entries=[]);for(var r=0;r<t.entries.length;r++)if(null!=t.entries[r].key.equals&&t.entries[r].key.equals(23)||23===t.entries[r].key)return void(t.entries[r].value=n);t.entries.push({key:23,value:n,getKey:function(){return this.key},getValue:function(){return this.value}})}(n.arrowTypes_$LI$(),0,"dash"),function(t,e,n){null==t.entries&&(t.entries=[]);for(var r=0;r<t.entries.length;r++)if(null!=t.entries[r].key.equals&&t.entries[r].key.equals(24)||24===t.entries[r].key)return void(t.entries[r].value=n);t.entries.push({key:24,value:n,getKey:function(){return this.key},getValue:function(){return this.value}})}(n.arrowTypes_$LI$(),0,"ERone"),function(t,e,n){null==t.entries&&(t.entries=[]);for(var r=0;r<t.entries.length;r++)if(null!=t.entries[r].key.equals&&t.entries[r].key.equals(25)||25===t.entries[r].key)return void(t.entries[r].value=n);t.entries.push({key:25,value:n,getKey:function(){return this.key},getValue:function(){return this.value}})}(n.arrowTypes_$LI$(),0,"ERmandOne"),function(t,e,n){null==t.entries&&(t.entries=[]);for(var r=0;r<t.entries.length;r++)if(null!=t.entries[r].key.equals&&t.entries[r].key.equals(27)||27===t.entries[r].key)return void(t.entries[r].value=n);t.entries.push({key:27,value:n,getKey:function(){return this.key},getValue:function(){return this.value}})}(n.arrowTypes_$LI$(),0,"ERmany"),function(t,e,n){null==t.entries&&(t.entries=[]);for(var r=0;r<t.entries.length;r++)if(null!=t.entries[r].key.equals&&t.entries[r].key.equals(28)||28===t.entries[r].key)return void(t.entries[r].value=n);t.entries.push({key:28,value:n,getKey:function(){return this.key},getValue:function(){return this.value}})}(n.arrowTypes_$LI$(),0,"ERoneToMany"),function(t,e,n){null==t.entries&&(t.entries=[]);for(var r=0;r<t.entries.length;r++)if(null!=t.entries[r].key.equals&&t.entries[r].key.equals(29)||29===t.entries[r].key)return void(t.entries[r].value=n);t.entries.push({key:29,value:n,getKey:function(){return this.key},getValue:function(){return this.value}})}(n.arrowTypes_$LI$(),0,"ERzeroToMany"),function(t,e,n){null==t.entries&&(t.entries=[]);for(var r=0;r<t.entries.length;r++)if(null!=t.entries[r].key.equals&&t.entries[r].key.equals(30)||30===t.entries[r].key)return void(t.entries[r].value=n);t.entries.push({key:30,value:n,getKey:function(){return this.key},getValue:function(){return this.value}})}(n.arrowTypes_$LI$(),0,"ERzeroToOne"),function(t,e,n){null==t.entries&&(t.entries=[]);for(var r=0;r<t.entries.length;r++)if(null!=t.entries[r].key.equals&&t.entries[r].key.equals(6)||6===t.entries[r].key)return void(t.entries[r].value=n);t.entries.push({key:6,value:n,getKey:function(){return this.key},getValue:function(){return this.value}})}(n.arrowTypes_$LI$(),0,mxConstants.ARROW_BLOCK),function(t,e,n){null==t.entries&&(t.entries=[]);for(var r=0;r<t.entries.length;r++)if(null!=t.entries[r].key.equals&&t.entries[r].key.equals(7)||7===t.entries[r].key)return void(t.entries[r].value=n);t.entries.push({key:7,value:n,getKey:function(){return this.key},getValue:function(){return this.value}})}(n.arrowTypes_$LI$(),0,mxConstants.ARROW_OPEN),function(t,e,n){null==t.entries&&(t.entries=[]);for(var r=0;r<t.entries.length;r++)if(null!=t.entries[r].key.equals&&t.entries[r].key.equals(8)||8===t.entries[r].key)return void(t.entries[r].value=n);t.entries.push({key:8,value:n,getKey:function(){return this.key},getValue:function(){return this.value}})}(n.arrowTypes_$LI$(),0,mxConstants.ARROW_CLASSIC),function(t,e,n){null==t.entries&&(t.entries=[]);for(var r=0;r<t.entries.length;r++)if(null!=t.entries[r].key.equals&&t.entries[r].key.equals(9)||9===t.entries[r].key)return void(t.entries[r].value=n);t.entries.push({key:9,value:n,getKey:function(){return this.key},getValue:function(){return this.value}})}(n.arrowTypes_$LI$(),0,"openAsync"),function(t,e,n){null==t.entries&&(t.entries=[]);for(var r=0;r<t.entries.length;r++)if(null!=t.entries[r].key.equals&&t.entries[r].key.equals(11)||11===t.entries[r].key)return void(t.entries[r].value=n);t.entries.push({key:11,value:n,getKey:function(){return this.key},getValue:function(){return this.value}})}(n.arrowTypes_$LI$(),0,"diamond"),function(t,e,n){null==t.entries&&(t.entries=[]);for(var r=0;r<t.entries.length;r++)if(null!=t.entries[r].key.equals&&t.entries[r].key.equals(12)||12===t.entries[r].key)return void(t.entries[r].value=n);t.entries.push({key:12,value:n,getKey:function(){return this.key},getValue:function(){return this.value}})}(n.arrowTypes_$LI$(),0,mxConstants.ARROW_OPEN),function(t,e,n){null==t.entries&&(t.entries=[]);for(var r=0;r<t.entries.length;r++)if(null!=t.entries[r].key.equals&&t.entries[r].key.equals(15)||15===t.entries[r].key)return void(t.entries[r].value=n);t.entries.push({key:15,value:n,getKey:function(){return this.key},getValue:function(){return this.value}})}(n.arrowTypes_$LI$(),0,n.ARROW_NO_FILL_MARKER+mxConstants.ARROW_BLOCK),function(t,e,n){null==t.entries&&(t.entries=[]);for(var r=0;r<t.entries.length;r++)if(null!=t.entries[r].key.equals&&t.entries[r].key.equals(16)||16===t.entries[r].key)return void(t.entries[r].value=n);t.entries.push({key:16,value:n,getKey:function(){return this.key},getValue:function(){return this.value}})}(n.arrowTypes_$LI$(),0,n.ARROW_NO_FILL_MARKER+mxConstants.ARROW_BLOCK),function(t,e,n){null==t.entries&&(t.entries=[]);for(var r=0;r<t.entries.length;r++)if(null!=t.entries[r].key.equals&&t.entries[r].key.equals(18)||18===t.entries[r].key)return void(t.entries[r].value=n);t.entries.push({key:18,value:n,getKey:function(){return this.key},getValue:function(){return this.value}})}(n.arrowTypes_$LI$(),0,n.ARROW_NO_FILL_MARKER+mxConstants.ARROW_BLOCK),function(t,e,n){null==t.entries&&(t.entries=[]);for(var r=0;r<t.entries.length;r++)if(null!=t.entries[r].key.equals&&t.entries[r].key.equals(19)||19===t.entries[r].key)return void(t.entries[r].value=n);t.entries.push({key:19,value:n,getKey:function(){return this.key},getValue:function(){return this.value}})}(n.arrowTypes_$LI$(),0,n.ARROW_NO_FILL_MARKER+mxConstants.ARROW_CLASSIC),function(t,e,n){null==t.entries&&(t.entries=[]);for(var r=0;r<t.entries.length;r++)if(null!=t.entries[r].key.equals&&t.entries[r].key.equals(21)||21===t.entries[r].key)return void(t.entries[r].value=n);t.entries.push({key:21,value:n,getKey:function(){return this.key},getValue:function(){return this.value}})}(n.arrowTypes_$LI$(),0,n.ARROW_NO_FILL_MARKER+"diamond"),function(t,e,n){null==t.entries&&(t.entries=[]);for(var r=0;r<t.entries.length;r++)if(null!=t.entries[r].key.equals&&t.entries[r].key.equals(26)||26===t.entries[r].key)return void(t.entries[r].value=n);t.entries.push({key:26,value:n,getKey:function(){return this.key},getValue:function(){return this.value}})}(n.arrowTypes_$LI$(),0,"ERmandOne"),function(t,e,n){null==t.entries&&(t.entries=[]);for(var r=0;r<t.entries.length;r++)if(null!=t.entries[r].key.equals&&t.entries[r].key.equals(31)||31===t.entries[r].key)return void(t.entries[r].value=n);t.entries.push({key:31,value:n,getKey:function(){return this.key},getValue:function(){return this.value}})}(n.arrowTypes_$LI$(),0,n.ARROW_NO_FILL_MARKER+mxConstants.ARROW_OVAL),function(t,e,n){null==t.entries&&(t.entries=[]);for(var r=0;r<t.entries.length;r++)if(null!=t.entries[r].key.equals&&t.entries[r].key.equals(32)||32===t.entries[r].key)return void(t.entries[r].value=n);t.entries.push({key:32,value:n,getKey:function(){return this.key},getValue:function(){return this.value}})}(n.arrowTypes_$LI$(),0,n.ARROW_NO_FILL_MARKER+mxConstants.ARROW_OVAL),function(t,e,n){null==t.entries&&(t.entries=[]);for(var r=0;r<t.entries.length;r++)if(null!=t.entries[r].key.equals&&t.entries[r].key.equals(33)||33===t.entries[r].key)return void(t.entries[r].value=n);t.entries.push({key:33,value:n,getKey:function(){return this.key},getValue:function(){return this.value}})}(n.arrowTypes_$LI$(),0,n.ARROW_NO_FILL_MARKER+mxConstants.ARROW_OVAL),function(t,e,n){null==t.entries&&(t.entries=[]);for(var r=0;r<t.entries.length;r++)if(null!=t.entries[r].key.equals&&t.entries[r].key.equals(34)||34===t.entries[r].key)return void(t.entries[r].value=n);t.entries.push({key:34,value:n,getKey:function(){return this.key},getValue:function(){return this.value}})}(n.arrowTypes_$LI$(),0,n.ARROW_NO_FILL_MARKER+mxConstants.ARROW_OVAL),function(t,e,n){null==t.entries&&(t.entries=[]);for(var r=0;r<t.entries.length;r++)if(null!=t.entries[r].key.equals&&t.entries[r].key.equals(35)||35===t.entries[r].key)return void(t.entries[r].value=n);t.entries.push({key:35,value:n,getKey:function(){return this.key},getValue:function(){return this.value}})}(n.arrowTypes_$LI$(),0,mxConstants.ARROW_OVAL),function(t,e,n){null==t.entries&&(t.entries=[]);for(var r=0;r<t.entries.length;r++)if(null!=t.entries[r].key.equals&&t.entries[r].key.equals(36)||36===t.entries[r].key)return void(t.entries[r].value=n);t.entries.push({key:36,value:n,getKey:function(){return this.key},getValue:function(){return this.value}})}(n.arrowTypes_$LI$(),0,mxConstants.ARROW_OVAL),function(t,e,n){null==t.entries&&(t.entries=[]);for(var r=0;r<t.entries.length;r++)if(null!=t.entries[r].key.equals&&t.entries[r].key.equals(37)||37===t.entries[r].key)return void(t.entries[r].value=n);t.entries.push({key:37,value:n,getKey:function(){return this.key},getValue:function(){return this.value}})}(n.arrowTypes_$LI$(),0,mxConstants.ARROW_OVAL),function(t,e,n){null==t.entries&&(t.entries=[]);for(var r=0;r<t.entries.length;r++)if(null!=t.entries[r].key.equals&&t.entries[r].key.equals(38)||38===t.entries[r].key)return void(t.entries[r].value=n);t.entries.push({key:38,value:n,getKey:function(){return this.key},getValue:function(){return this.value}})}(n.arrowTypes_$LI$(),0,mxConstants.ARROW_OVAL),function(t,e,n){null==t.entries&&(t.entries=[]);for(var r=0;r<t.entries.length;r++)if(null!=t.entries[r].key.equals&&t.entries[r].key.equals(39)||39===t.entries[r].key)return void(t.entries[r].value=n);t.entries.push({key:39,value:n,getKey:function(){return this.key},getValue:function(){return this.value}})}(n.arrowTypes_$LI$(),0,mxConstants.ARROW_BLOCK),function(t,e,n){null==t.entries&&(t.entries=[]);for(var r=0;r<t.entries.length;r++)if(null!=t.entries[r].key.equals&&t.entries[r].key.equals(40)||40===t.entries[r].key)return void(t.entries[r].value=n);t.entries.push({key:40,value:n,getKey:function(){return this.key},getValue:function(){return this.value}})}(n.arrowTypes_$LI$(),0,n.ARROW_NO_FILL_MARKER+mxConstants.ARROW_BLOCK),function(t,e,n){null==t.entries&&(t.entries=[]);for(var r=0;r<t.entries.length;r++)if(null!=t.entries[r].key.equals&&t.entries[r].key.equals(41)||41===t.entries[r].key)return void(t.entries[r].value=n);t.entries.push({key:41,value:n,getKey:function(){return this.key},getValue:function(){return this.value}})}(n.arrowTypes_$LI$(),0,n.ARROW_NO_FILL_MARKER+mxConstants.ARROW_OVAL),function(t,e,n){null==t.entries&&(t.entries=[]);for(var r=0;r<t.entries.length;r++)if(null!=t.entries[r].key.equals&&t.entries[r].key.equals(42)||42===t.entries[r].key)return void(t.entries[r].value=n);t.entries.push({key:42,value:n,getKey:function(){return this.key},getValue:function(){return this.value}})}(n.arrowTypes_$LI$(),0,mxConstants.ARROW_OVAL),function(t,e,n){null==t.entries&&(t.entries=[]);for(var r=0;r<t.entries.length;r++)if(null!=t.entries[r].key.equals&&t.entries[r].key.equals(43)||43===t.entries[r].key)return void(t.entries[r].value=n);t.entries.push({key:43,value:n,getKey:function(){return this.key},getValue:function(){return this.value}})}(n.arrowTypes_$LI$(),0,mxConstants.ARROW_OPEN),function(t,e,n){null==t.entries&&(t.entries=[]);for(var r=0;r<t.entries.length;r++)if(null!=t.entries[r].key.equals&&t.entries[r].key.equals(44)||44===t.entries[r].key)return void(t.entries[r].value=n);t.entries.push({key:44,value:n,getKey:function(){return this.key},getValue:function(){return this.value}})}(n.arrowTypes_$LI$(),0,mxConstants.ARROW_OPEN),function(t,e,n){null==t.entries&&(t.entries=[]);for(var r=0;r<t.entries.length;r++)if(null!=t.entries[r].key.equals&&t.entries[r].key.equals(45)||45===t.entries[r].key)return void(t.entries[r].value=n);t.entries.push({key:45,value:n,getKey:function(){return this.key},getValue:function(){return this.value}})}(n.arrowTypes_$LI$(),0,mxConstants.ARROW_OPEN)},n.__com_mxgraph_io_vsdx_VsdxShape_LOGGER_$LI$=function(){return n.__static_initialize(),null==n.__com_mxgraph_io_vsdx_VsdxShape_LOGGER&&(n.__com_mxgraph_io_vsdx_VsdxShape_LOGGER={}),n.__com_mxgraph_io_vsdx_VsdxShape_LOGGER},n.prototype.getShapeNode=function(t){var e,n,r=(e=this.cellElements)[n=t]?e[n]:null;return null==r&&null!=this.masterShape?this.masterShape.getCellElement$java_lang_String(t):r},n.prototype.getTextLabel=function(){var e;if(e=this.getValue(this.getCellElement$java_lang_String(t.mxgraph.io.vsdx.mxVsdxConstants.HIDE_TEXT),"0"),"1".equals?"1".equals(e):"1"===e)return null;var n=this.getTextChildren();if(null==n&&null!=this.masterShape&&(n=this.masterShape.getTextChildren()),!this.htmlLabels){var r=this.getText();return null==r&&null!=this.masterShape?this.masterShape.getText():r}return null!=n?(this.styleMap[mxConstants.STYLE_VERTICAL_ALIGN]=this.getAlignVertical(),this.styleMap[mxConstants.STYLE_ALIGN]=this.getHorizontalAlign("0",!1),this.getHtmlTextContent(n)):null},n.prototype.getIndex=function(t){var e=t.getAttribute("IX")||"";return 0===e.length?"0":e},n.prototype.initLabels=function(e){this.paragraphs={};for(var n,r,i=null,s=null,a=null,o=0;o<e.length;o++){var l=null,u=e.item(o);switch(u.nodeName){case"cp":var h=u;i=this.getIndex(h);break;case"tp":h=u,this.getIndex(h);break;case"pp":h=u,s=this.getIndex(h);break;case"fld":h=u,a=this.getIndex(h);break;case"#text":l=u.textContent;var g=(n=this.paragraphs)[r=s]?n[r]:null;null==g?(g=new t.mxgraph.io.vsdx.Paragraph(l,i,s,a),this.paragraphs[s]=g):g.addText(l,i,a)}}},n.prototype.createHybridLabel=function(t){var e,n,r=(e=this.paragraphs)[n=t]?e[n]:null;this.styleMap[mxConstants.STYLE_ALIGN]=this.getHorizontalAlign(t,!1),this.styleMap[mxConstants.STYLE_SPACING_LEFT]=this.getIndentLeft(t),this.styleMap[mxConstants.STYLE_SPACING_RIGHT]=this.getIndentRight(t),this.styleMap[mxConstants.STYLE_SPACING_TOP]=this.getSpBefore(t),this.styleMap[mxConstants.STYLE_SPACING_BOTTOM]=this.getSpAfter(t),this.styleMap[mxConstants.STYLE_VERTICAL_ALIGN]=this.getAlignVertical(),this.styleMap.fontColor=this.getTextColor(t),this.styleMap.fontSize=this.getTextSize(t),this.styleMap.fontFamily=this.getTextFont(t);var i=this.isBold(t)?mxConstants.FONT_BOLD:0;i|=this.isItalic(t)?mxConstants.FONT_ITALIC:0,i|=this.isUnderline(t)?mxConstants.FONT_UNDERLINE:0,this.styleMap.fontStyle=new String(i).toString();for(var s=r.numValues(),a=null,o=0;o<s;o++){var l=r.getValue(o);if(0===l.length&&null!=this.fields){var u=r.getField(o);null!=u&&(l=function(t,e){return t[e]?t[e]:null}(this.fields,u),null==l&&null!=this.masterShape&&null!=this.masterShape.fields&&(l=function(t,e){return t[e]?t[e]:null}(this.masterShape.fields,u)))}null!=l&&(a=null==a?l:a+l)}return a},n.prototype.getHtmlTextContent=function(e){var n,r,i,s="",a=!0,o=!1,l=!1;function u(e){if(e=t.mxgraph.io.vsdx.mxVsdxUtils.htmlEntities(e),l&&(e="<li>"+e,l=!1),o){var n=e.split("\n");n[n.length-1]||(n.pop(),l=!0),e=n.join("</li><li>")}else e=e.replace(new RegExp("\n","g"),"<br/>").replace(new RegExp(t.mxgraph.io.vsdx.Shape.UNICODE_LINE_SEP,"g"),"<br/>");return this.getTextCharFormated(e)}if(null!=e&&e.length>0)for(var h=0;h<e.length;h++){var g=e.item(h);if((i=g.nodeName)&&i.equals?i.equals("cp"):"cp"===i){var c=g;this.cp=this.getIndex(c)}else if(function(t,e){return t&&t.equals?t.equals("tp"):"tp"===t}(g.nodeName))c=g,this.tp=this.getIndex(c);else if(function(t,e){return t&&t.equals?t.equals("pp"):"pp"===t}(g.nodeName)){c=g,this.pp=this.getIndex(c),o&&(s+="</li></ul>"),a?a=!1:s+="</p>",s+=this.getTextParagraphFormated("<p>");var x=this.getPPList(this.pp);l=o=null!=x,s+=o?x:""}else if(function(t,e){return t&&t.equals?t.equals("fld"):"fld"===t}(g.nodeName)){c=g,this.fld=this.getIndex(c);var m=null;null!=this.fields&&(m=(n=this.fields)[r=this.fld]?n[r]:null),null==m&&null!=this.masterShape&&null!=this.masterShape.fields&&(m=function(t,e){return t[e]?t[e]:null}(this.masterShape.fields,this.fld)),null!=m&&(s+=u.call(this,m))}else(function(t,e){return t&&t.equals?t.equals(e):t===e})(g.nodeName,"#text")&&(m=g.textContent,s+=u.call(this,m))}return o&&(s+="</li></ul>"),s+=a?"":"</p>",t.mxgraph.io.vsdx.mxVsdxUtils.surroundByTags(s,"div","font-size: 1px")},n.prototype.isConnectorBigNameU=function(t){return e="60 degree single",void 0===n&&(n=0),t.substr(n,e.length)===e||function(t,e,n){return void 0===n&&(n=0),t.substr(n,e.length)===e}(t,"45 degree single")||function(t,e,n){return void 0===n&&(n=0),t.substr(n,e.length)===e}(t,"45 degree double")||function(t,e,n){return void 0===n&&(n=0),t.substr(n,e.length)===e}(t,"60 degree double")||function(t,e,n){return void 0===n&&(n=0),t.substr(n,e.length)===e}(t,"45 degree  tail")||function(t,e,n){return void 0===n&&(n=0),t.substr(n,e.length)===e}(t,"60 degree  tail")||function(t,e,n){return void 0===n&&(n=0),t.substr(n,e.length)===e}(t,"45 degree tail")||function(t,e,n){return void 0===n&&(n=0),t.substr(n,e.length)===e}(t,"60 degree tail")||function(t,e,n){return void 0===n&&(n=0),t.substr(n,e.length)===e}(t,"Flexi-arrow 2")||function(t,e,n){return void 0===n&&(n=0),t.substr(n,e.length)===e}(t,"Flexi-arrow 1")||function(t,e,n){return void 0===n&&(n=0),t.substr(n,e.length)===e}(t,"Flexi-arrow 3")||function(t,e,n){return void 0===n&&(n=0),t.substr(n,e.length)===e}(t,"Double flexi-arrow")||function(t,e,n){return void 0===n&&(n=0),t.substr(n,e.length)===e}(t,"Fancy arrow");var e,n},n.prototype.isVertex=function(){return this.vertex},n.prototype.getOriginPoint=function(e,n){var r=this.getPinX(),i=this.getPinY(),s=this.getLocPinY(),a=this.getLocPinX(),o=this.getScreenNumericalValue$org_w3c_dom_Element$double(this.getShapeNode(t.mxgraph.io.vsdx.mxVsdxConstants.WIDTH),0),l=this.getScreenNumericalValue$org_w3c_dom_Element$double(this.getShapeNode(t.mxgraph.io.vsdx.mxVsdxConstants.HEIGHT),0),u=r-a,h=e-(i+(l-s));if(n&&(s!==l/2||a!==o/2)&&0!==this.rotation){var g=o/2-a,c=s-l/2,x=Math.cos(function(t){return t*Math.PI/180}(360-this.rotation)),m=Math.sin(function(t){return t*Math.PI/180}(360-this.rotation));return new mxPoint(u+g-(g*x-c*m),g*m+c*x+h-c)}return new mxPoint(u,h)},n.prototype.getDimensions=function(){var e=this.getScreenNumericalValue$org_w3c_dom_Element$double(this.getShapeNode(t.mxgraph.io.vsdx.mxVsdxConstants.WIDTH),0),n=this.getScreenNumericalValue$org_w3c_dom_Element$double(this.getShapeNode(t.mxgraph.io.vsdx.mxVsdxConstants.HEIGHT),0);return new mxPoint(0===e&&n>0?1:e,0===n&&e>0?1:n)},n.prototype.getPinX=function(){return this.getScreenNumericalValue$org_w3c_dom_Element$double(this.getShapeNode(t.mxgraph.io.vsdx.mxVsdxConstants.PIN_X),0)},n.prototype.getPinY=function(){return this.getScreenNumericalValue$org_w3c_dom_Element$double(this.getShapeNode(t.mxgraph.io.vsdx.mxVsdxConstants.PIN_Y),0)},n.prototype.getLocPinX=function(){return this.getScreenNumericalValue$org_w3c_dom_Element$double(this.getShapeNode(t.mxgraph.io.vsdx.mxVsdxConstants.LOC_PIN_X),0)},n.prototype.getLocPinY=function(){return this.getScreenNumericalValue$org_w3c_dom_Element$double(this.getShapeNode(t.mxgraph.io.vsdx.mxVsdxConstants.LOC_PIN_Y),0)},n.prototype.getOpacity=function(t){var e=100;return this.isGroup()&&(e=0),e=100-100*(e=this.getValueAsDouble(this.getCellElement$java_lang_String(t),0)),e=Math.max(e,0),Math.min(e,100)},n.prototype.getGradient=function(){var e,n;if(n=this.getValue(this.getCellElement$java_lang_String(t.mxgraph.io.vsdx.mxVsdxConstants.FILL_GRADIENT_ENABLED),"0"),"1".equals?"1".equals(n):"1"===n){var r=(e=this.sections).FillGradient?e.FillGradient:null;if(null!=r){var i=t.mxgraph.io.vsdx.mxVsdxUtils.getDirectChildNamedElements(r.elem,"Row"),s=this.getColor(r.getIndexedCell(i[i.length-1].getAttribute("IX"),"GradientStopColor"));if(null!=s&&0!==s.length)return s}}var a="",o=this.getValue(this.getCellElement$java_lang_String(t.mxgraph.io.vsdx.mxVsdxConstants.FILL_PATTERN),"0");if(parseInt(o)>=25)a=this.getColor(this.getCellElement$java_lang_String(t.mxgraph.io.vsdx.mxVsdxConstants.FILL_BKGND));else{var l=this.getTheme();if(null!=l){var u=l.getFillGraientColor(this.getQuickStyleVals());null!=u&&(a=u.toHexStr())}}return a},n.prototype.getGradientDirection=function(){var e,n="",r=this.getValue(this.getCellElement$java_lang_String(t.mxgraph.io.vsdx.mxVsdxConstants.FILL_PATTERN),"0");return((e=r)&&e.equals?e.equals("25"):"25"===e)?n=mxConstants.DIRECTION_EAST:function(t,e){return t&&t.equals?t.equals("27"):"27"===t}(r)?n=mxConstants.DIRECTION_WEST:function(t,e){return t&&t.equals?t.equals("28"):"28"===t}(r)?n=mxConstants.DIRECTION_SOUTH:function(t,e){return t&&t.equals?t.equals("30"):"30"===t}(r)&&(n=mxConstants.DIRECTION_NORTH),n},n.prototype.calcRotation=function(){var e=parseFloat(this.getValue(this.getCellElement$java_lang_String(t.mxgraph.io.vsdx.mxVsdxConstants.ANGLE),"0"));return e=180*e/Math.PI,360-100*(e%=360)/100},n.prototype.propagateRotation=function(t){this.rotation+=t,this.rotation%=360,this.rotation=100*this.rotation/100},n.prototype.getTopSpacing=function(){var t=this.getTextTopMargin();return 100*(t/2-2.8)/100},n.prototype.getBottomSpacing=function(){var t=this.getTextBottomMargin();return 100*(t/2-2.8)/100},n.prototype.getLeftSpacing=function(){var t=this.getTextLeftMargin();return 100*(t/2-2.8)/100},n.prototype.getRightSpacing=function(){var t=this.getTextRightMargin();return 100*(t/2-2.8)/100},n.prototype.getLabelRotation=function(){var e=!0,n=this.calcRotation(),r=parseFloat(this.getValue(this.getCellElement$java_lang_String(t.mxgraph.io.vsdx.mxVsdxConstants.TXT_ANGLE),"0"));return r=180*r/Math.PI,r-=n,Math.abs(r)<45||Math.abs(r)>270||(e=!1),e},n.prototype.getHyperlink=function(){var t=this.getCellElement$java_lang_String$java_lang_String$java_lang_String("Address",null,"Hyperlink"),e=this.getValue(t,""),n=this.getCellElement$java_lang_String$java_lang_String$java_lang_String("SubAddress",null,"Hyperlink");return{extLink:e,pageLink:this.getValue(n,"")}},n.prototype.getProperties=function(){var e=[];if(this.sections&&this.sections.Property)for(var n=t.mxgraph.io.vsdx.mxVsdxUtils.getDirectChildNamedElements(this.sections.Property.elem,"Row"),r=0;r<n.length;r++)for(var i=n[r],s=i.getAttribute("N"),a=t.mxgraph.io.vsdx.mxVsdxUtils.getDirectChildElements(i),o=0;o<a.length;o++){var l=a[o];if("Value"==l.getAttribute("N")){e.push({key:s,val:l.getAttribute("V")});break}}return e},n.prototype.getStyleFromShape=function(){this.styleMap[t.mxgraph.io.vsdx.mxVsdxConstants.VSDX_ID]=this.getId().toString(),this.rotation=Math.round(this.rotation),0!==this.rotation&&(this.styleMap[mxConstants.STYLE_ROTATION]=""+this.rotation);var e,n=this.getFillColor();((e=n)&&e.equals?e.equals(""):""===e)?this.styleMap[mxConstants.STYLE_FILLCOLOR]="none":this.styleMap[mxConstants.STYLE_FILLCOLOR]=n;var r=this.getId();this.styleDebug("ID = "+r+" , Fill Color = "+n);var i=this.getGradient();if(function(t,e){return t&&t.equals?t.equals(""):""===t}(i))this.styleMap[mxConstants.STYLE_GRADIENTCOLOR]="none";else{this.styleMap[mxConstants.STYLE_GRADIENTCOLOR]=i;var s=this.getGradientDirection();(function(t,e){return t&&t.equals?t.equals(""):""===t})(s)||function(t,e){return t&&t.equals?t.equals(e):t===e}(s,mxConstants.DIRECTION_SOUTH)||(this.styleMap[mxConstants.STYLE_GRADIENT_DIRECTION]=s)}var a=this.getOpacity(t.mxgraph.io.vsdx.mxVsdxConstants.FILL_FOREGND_TRANS);a<100&&(this.styleMap[mxConstants.STYLE_FILL_OPACITY]=""+a),(a=this.getOpacity(t.mxgraph.io.vsdx.mxVsdxConstants.LINE_COLOR_TRANS))<100&&(this.styleMap[mxConstants.STYLE_STROKE_OPACITY]=""+a);var o,l,u,h,g=this.getForm();for(var c in g.hasOwnProperty(mxConstants.STYLE_SHAPE)&&(o="image;",void 0===l&&(l=0),((u=g)[h=mxConstants.STYLE_SHAPE]?u[h]:null).substr(l,o.length)===o)&&(this.styleMap[mxConstants.STYLE_WHITE_SPACE]="wrap"),g)this.styleMap[c]=g[c];if(this.isDashed()){this.styleMap[mxConstants.STYLE_DASHED]="1";var x=this.getDashPattern();null!=x&&(this.styleMap[mxConstants.STYLE_DASH_PATTERN]=x)}var m=this.getStrokeColor(),p=this.getStrokeTransparency();this.styleDebug("ID = "+r+" , Color = "+m+" , stroke transparency = "+p),function(t,e){return t&&t.equals?t.equals(""):""===t}(m)||1===p||(this.styleMap[mxConstants.STYLE_STROKECOLOR]=m);var d=0|Math.round(this.getLineWidth());1!==d&&(this.styleMap[mxConstants.STYLE_STROKEWIDTH]=""+d),this.isShadow()&&(this.styleMap[mxConstants.STYLE_SHADOW]=t.mxgraph.io.vsdx.mxVsdxConstants.TRUE);var v=0|Math.round(this.getTopSpacing());0!==v&&(this.styleMap[mxConstants.STYLE_SPACING_TOP]=""+v);var y=0|Math.round(this.getBottomSpacing());0!==y&&(this.styleMap[mxConstants.STYLE_SPACING_BOTTOM]=""+y);var f=0|Math.round(this.getLeftSpacing());0!==f&&(this.styleMap[mxConstants.STYLE_SPACING_LEFT]=""+f);var _=0|Math.round(this.getRightSpacing());0!==_&&(this.styleMap[mxConstants.STYLE_SPACING_RIGHT]=""+_);var S=this.getDirection(g);S!==mxConstants.DIRECTION_EAST&&(this.styleMap[mxConstants.STYLE_DIRECTION]=S);var C,I=this.getValue(this.getCellElement$java_lang_String(t.mxgraph.io.vsdx.mxVsdxConstants.FLIP_X),"0"),L=this.getValue(this.getCellElement$java_lang_String(t.mxgraph.io.vsdx.mxVsdxConstants.FLIP_Y),"0");return C=I,("1".equals?"1".equals(C):"1"===C)&&(this.styleMap[mxConstants.STYLE_FLIPH]="1"),function(t,e){return"1".equals?"1".equals(e):"1"===e}(0,L)&&(this.styleMap[mxConstants.STYLE_FLIPV]="1"),this.resolveCommonStyles(),this.styleMap},n.prototype.getDashPattern=function(){var e,n,i=null,s=this.getValue(this.getCellElement$java_lang_String(t.mxgraph.io.vsdx.mxVsdxConstants.LINE_PATTERN),"0");if(n="Themed",(e=s)&&e.equals?e.equals(n):e===n){var a=this.getTheme();null!=a&&(i=this.isVertex()?a.getLineDashPattern$com_mxgraph_io_vsdx_theme_QuickStyleVals(this.getQuickStyleVals()):a.getConnLineDashPattern(this.getQuickStyleVals()))}else i=r.Style.getLineDashPattern(parseInt(s));if(null!=i&&0!=i.length){for(var o={str:"",toString:function(){return this.str}},l=function(t){var e,n=i[t];(e=o).str=e.str.concat(n.toFixed(2)+" ")},u=0;u<i.length;u++)l(u);return o.str.trim()}return null},n.prototype.isDashed=function(){var e,n,r=this.getValue(this.getCellElement$java_lang_String(t.mxgraph.io.vsdx.mxVsdxConstants.LINE_PATTERN),"0");if(n="Themed",(e=r)&&e.equals?e.equals(n):e===n){var i=this.getTheme();if(null!=i)return this.isVertex()?i.isLineDashed$com_mxgraph_io_vsdx_theme_QuickStyleVals(this.getQuickStyleVals()):i.isConnLineDashed(this.getQuickStyleVals())}else if(!function(t,e){return t&&t.equals?t.equals("0"):"0"===t}(r)&&!function(t,e){return t&&t.equals?t.equals("1"):"1"===t}(r))return!0;return!1},n.prototype.getLineWidth=function(){var e,n,r=this.getValue(this.getCellElement$java_lang_String(t.mxgraph.io.vsdx.mxVsdxConstants.LINE_WEIGHT),"1"),i=1;try{if(n="Themed",(e=r)&&e.equals?e.equals(n):e===n){var s=this.getTheme();null!=s&&(i=(this.isVertex()?s.getLineWidth$com_mxgraph_io_vsdx_theme_QuickStyleVals(this.getQuickStyleVals()):s.getConnLineWidth(this.getQuickStyleVals()))/1e4)}else i=parseFloat(r),i=this.getScreenNumericalValue$double(i)}catch(t){}return i<1&&(i*=2),i},n.prototype.getStartArrowSize=function(){var e,r,i=this.getValue(this.getCellElement$java_lang_String(t.mxgraph.io.vsdx.mxVsdxConstants.BEGIN_ARROW_SIZE),"4");try{var s=4;if(r="Themed",(e=i)&&e.equals?e.equals(r):e===r){var a=this.getTheme();null!=a&&(s=this.isVertex()?a.getStartSize(this.getQuickStyleVals()):a.getConnStartSize(this.getQuickStyleVals()))}else s=parseFloat(i);return n.arrowSizes_$LI$()[s]}catch(t){}return 4},n.prototype.getFinalArrowSize=function(){var e,r,i=this.getValue(this.getCellElement$java_lang_String(t.mxgraph.io.vsdx.mxVsdxConstants.END_ARROW_SIZE),"4");try{var s=4;if(r="Themed",(e=i)&&e.equals?e.equals(r):e===r){var a=this.getTheme();null!=a&&(s=this.isVertex()?a.getEndSize(this.getQuickStyleVals()):a.getConnEndSize(this.getQuickStyleVals()))}else s=parseFloat(i);return n.arrowSizes_$LI$()[s]}catch(t){}return 4},n.prototype.getRounding=function(){var e,n,r=this.getValue(this.getCellElement$java_lang_String(t.mxgraph.io.vsdx.mxVsdxConstants.ROUNDING),"0");return n=r,((e="Themed").equals?e.equals(n):e===n)&&(r="0"),parseFloat(r)},n.prototype.isShadow=function(){var e,n,r=this.getValue(this.getCellElement$java_lang_String(t.mxgraph.io.vsdx.mxVsdxConstants.SHDW_PATTERN),"0");if(n="Themed",(e=r)&&e.equals?e.equals(n):e===n);else if(!function(t,e){return t&&t.equals?t.equals("0"):"0"===t}(r))return!0;return!1},n.prototype.getEdgeStyle$java_util_Map=function(t){var e,n,r,i,s={};return i="mxgraph.lean_mapping.electronic_info_flow_edge",((r=(e=t)[n=mxConstants.STYLE_SHAPE]?e[n]:null)&&r.equals?r.equals(i):r===i)?(s[mxConstants.STYLE_EDGE]=mxConstants.NONE,s):(s[mxConstants.STYLE_EDGE]=mxConstants.EDGESTYLE_ELBOW,s)},n.prototype.getEdgeStyle=function(t){if(null!=t&&t instanceof Object||null===t)return this.getEdgeStyle$java_util_Map(t);if(void 0===t)return this.getEdgeStyle$();throw new Error("invalid overload")},n.prototype.getMasterId=function(){return this.shape.hasAttribute(t.mxgraph.io.vsdx.mxVsdxConstants.MASTER)?this.shape.getAttribute(t.mxgraph.io.vsdx.mxVsdxConstants.MASTER):null},n.prototype.getShapeMasterId=function(){return this.shape.hasAttribute(t.mxgraph.io.vsdx.mxVsdxConstants.MASTER_SHAPE)?this.shape.getAttribute(t.mxgraph.io.vsdx.mxVsdxConstants.MASTER_SHAPE):null},n.prototype.isGroup=function(){return e="Group",(t=this.shape.getAttribute("Type"))&&t.equals?t.equals(e):t===e;var t,e},n.getType=function(t){return t.getAttribute("Type")},n.prototype.getMaster=function(){return this.master},n.prototype.getNameU=function(){var e,n=this.shape.getAttribute(t.mxgraph.io.vsdx.mxVsdxConstants.NAME_U)||"";return null!=n&&!((e=n)&&e.equals?e.equals(""):""===e)||null==this.masterShape||(n=this.masterShape.getNameU()),n},n.prototype.getName=function(){var e,n=this.shape.getAttribute(t.mxgraph.io.vsdx.mxVsdxConstants.NAME);return null!=n&&!((e=n)&&e.equals?e.equals(""):""===e)||null==this.masterShape||(n=this.masterShape.getName()),n},n.prototype.getMasterName=function(){return this.shapeName},n.prototype.setLabelOffset=function(e,n){var r,i,s,a="",o="";if(this.shape.hasAttribute(t.mxgraph.io.vsdx.mxVsdxConstants.NAME_U)&&(a=this.shape.getAttribute(t.mxgraph.io.vsdx.mxVsdxConstants.NAME_U)),null!=this.getMaster()&&null!=this.getMaster().getMasterElement()&&this.getMaster().getMasterElement().hasAttribute(t.mxgraph.io.vsdx.mxVsdxConstants.NAME_U)&&(o=this.getMaster().getMasterElement().getAttribute(t.mxgraph.io.vsdx.mxVsdxConstants.NAME_U)),i="Organizational unit",void 0===s&&(s=0),a.substr(s,i.length)===i||function(t,e,n){return void 0===n&&(n=0),t.substr(n,e.length)===e}(o,"Organizational unit")){var l=null,u="0.0",h=null,g="-0.4";null!=(L=this.shape.getElementsByTagName(t.mxgraph.io.vsdx.mxVsdxConstants.CONTROL).item(0))&&(u=(l=L.getElementsByTagName(t.mxgraph.io.vsdx.mxVsdxConstants.X).item(0)).hasAttribute("F")?l.getAttribute("F"):l.textContent,g=(h=L.getElementsByTagName(t.mxgraph.io.vsdx.mxVsdxConstants.Y).item(0)).hasAttribute("F")?h.getAttribute("F"):h.textContent);var c=e.getGeometry();u=(u=u.split("Width/2+").join("")).split("DL").join(""),g=g.split("Height*").join(""),((r=u)&&r.equals?r.equals("Inh"):"Inh"===r)&&(u="0.0"),function(t,e){return t&&t.equals?t.equals("Inh"):"Inh"===t}(g)&&(g="-0.4"),-1!=g.indexOf("txtHeight")&&(g="-0.4");for(var x=n.split(";"),m="",p=0;p<x.length;p++){var d=x[p];(function(t,e,n){return void 0===n&&(n=0),t.substr(n,e.length)===e})(d=d.trim(),"tabHeight=")&&(m=d.split("tabHeight=").join(""))}(function(t,e){return t&&t.equals?t.equals(""):""===t})(m)&&(m="20");var v=parseFloat(m),y=parseFloat(u),f=parseFloat(g),_=c.height,S=.1*c.width+100*y,C=_-_*f-v/2,I=new mxPoint(S,C);e.getGeometry().offset=I}else if(function(t,e,n){return void 0===n&&(n=0),t.substr(n,e.length)===e}(a,"Domain 3D")||function(t,e,n){return void 0===n&&(n=0),t.substr(n,e.length)===e}(o,"Domain 3D")){var L;l=null,u="0.0",h=null,g="-0.4",null!=(L=this.shape.getElementsByTagName(t.mxgraph.io.vsdx.mxVsdxConstants.CONTROL).item(0))&&(u=(l=L.getElementsByTagName(t.mxgraph.io.vsdx.mxVsdxConstants.X).item(0)).getAttribute("F")||"",g=(h=L.getElementsByTagName(t.mxgraph.io.vsdx.mxVsdxConstants.Y).item(0)).getAttribute("F")||"");var A=e.getGeometry();u=(u=u.split("Width/2+").join("")).split("DL").join(""),g=g.split("Height*").join(""),(function(t,e){return t&&t.equals?t.equals("Inh"):"Inh"===t}(u)||function(t,e){return t&&t.equals?t.equals(""):""===t}(u))&&(u="0.0"),(function(t,e){return t&&t.equals?t.equals("Inh"):"Inh"===t}(g)||function(t,e){return t&&t.equals?t.equals(""):""===t}(g))&&(g="-0.4"),-1!=g.indexOf("txtHeight")&&(g="-0.4"),y=parseFloat(u),f=parseFloat(g),_=A.height,S=.1*A.width+100*y,C=_-_*f,I=new mxPoint(S,C),e.getGeometry().offset=I}},n.prototype.getForm=function(){var e,r,i,s={};if(!this.isVertex())return this.getEdgeStyle();try{var a=n.getType(this.getShape());if(this.styleDebug("shape type = "+a),null!=this.imageData||(r=t.mxgraph.io.vsdx.mxVsdxConstants.FOREIGN,i=a,(r&&r.equals?r.equals(i):r===i)&&null!=this.masterShape&&null!=this.masterShape.imageData)){var o=null!=this.imageData?this.imageData:this.masterShape.imageData;s.shape="image",s.aspect="fixed";var l=(e=o).iType?e.iType:null,u=function(t,e){return t[e]?t[e]:null}(o,"iData"),h=parseFloat(this.getValue(this.getCellElement$java_lang_String("ImgOffsetX"),"0")),g=parseFloat(this.getValue(this.getCellElement$java_lang_String("ImgOffsetY"),"0")),c=parseFloat(this.getValue(this.getCellElement$java_lang_String("ImgWidth"),"0")),x=parseFloat(this.getValue(this.getCellElement$java_lang_String("ImgHeight"),"0")),m=parseFloat(this.getValue(this.getCellElement$java_lang_String("Width"),"0")),p=parseFloat(this.getValue(this.getCellElement$java_lang_String("Height"),"0"));return 0!=h||0!=g?this.toBeCroppedImg={imgOffsetX:h,imgOffsetY:g,imgWidth:c,imgHeight:x,width:m,height:p,iType:l,iData:u}:s.image="data:image/"+l+","+u,s}var d=this.parseGeom();if(function(t,e){return t&&t.equals?t.equals(""):""===t}(d))return this.styleDebug("No geom found"),s;var v=Graph.compress(d);s[mxConstants.STYLE_SHAPE]="stencil("+v+")"}catch(t){console.error(t.message,t)}return s},n.prototype.isOff_page_reference=function(){var t,e,n=this.getNameU();return e="Off-page reference",!(!((t=n)&&t.equals?t.equals(e):t===e)&&!function(t,e){return t&&t.equals?t.equals(e):t===e}(n,"Lined/Shaded process"))},n.prototype.isExternal_process=function(){return e="External process",(t=this.shapeName)&&t.equals?t.equals(e):t===e;var t,e},n.prototype.getDirection=function(t){var e,n=mxResources.get("mxOffset"+this.shapeName);return null==n||((e=n)&&e.equals?e.equals("0"):"0"===e)||function(t,e){return t&&t.equals?t.equals(""):""===t}(n)?mxConstants.DIRECTION_EAST:function(t,e){return t&&t.equals?t.equals("1"):"1"===t}(n)?mxConstants.DIRECTION_SOUTH:function(t,e){return t&&t.equals?t.equals("2"):"2"===t}(n)?mxConstants.DIRECTION_WEST:function(t,e){return t&&t.equals?t.equals("3"):"3"===t}(n)?mxConstants.DIRECTION_NORTH:mxConstants.DIRECTION_EAST},n.prototype.isSubproces=function(){return e="Subproces",(t=this.shapeName)&&t.equals?t.equals(e):t===e;var t,e},n.prototype.getEdgeStyle$=function(){return{edgeStyle:"none"}},n.prototype.getChildShapes=function(){return this.childShapes},n.prototype.setChildShapes=function(t){this.childShapes=t},n.prototype.isDisplacedLabel=function(){var e,n,r,i,s=this.getAttribute(t.mxgraph.io.vsdx.mxVsdxConstants.TXT_PIN_X,"F",""),a=this.getAttribute(t.mxgraph.io.vsdx.mxVsdxConstants.TXT_PIN_Y,"F",""),o=this.getAttribute(t.mxgraph.io.vsdx.mxVsdxConstants.TXT_WIDTH,"F",""),l=this.getAttribute(t.mxgraph.io.vsdx.mxVsdxConstants.TXT_HEIGHT,"F","");return null!=this.masterShape&&((""===s||((e=s.toLowerCase())&&e.equals?e.equals("inh"):"inh"===e))&&(s=this.masterShape.getAttribute(t.mxgraph.io.vsdx.mxVsdxConstants.TXT_PIN_X,"F","")),(""===a||function(t,e){return t&&t.equals?t.equals("inh"):"inh"===t}(a.toLowerCase()))&&(a=this.masterShape.getAttribute(t.mxgraph.io.vsdx.mxVsdxConstants.TXT_PIN_Y,"F","")),(""===o||function(t,e){return t&&t.equals?t.equals("inh"):"inh"===t}(o.toLowerCase()))&&(o=this.masterShape.getAttribute(t.mxgraph.io.vsdx.mxVsdxConstants.TXT_WIDTH,"F","")),(""===l||function(t,e){return t&&t.equals?t.equals("inh"):"inh"===t}(l.toLowerCase()))&&(l=this.masterShape.getAttribute(t.mxgraph.io.vsdx.mxVsdxConstants.TXT_HEIGHT,"F",""))),!(function(t,e){return t&&t.equals?t.equals(e):t===e}(s.toLowerCase(),"width*0.5")&&function(t,e){return t&&t.equals?t.equals(e):t===e}(a.toLowerCase(),"height*0.5")&&function(t,e){return t&&t.equals?t.equals(e):t===e}(o.toLowerCase(),"width*1")&&function(t,e){return t&&t.equals?t.equals(e):t===e}(l.toLowerCase(),"height*1")||(n=s.toLowerCase(),r="width*",void 0===i&&(i=0),!(n.substr(i,r.length)===r&&function(t,e,n){return void 0===n&&(n=0),t.substr(n,e.length)===e}(a.toLowerCase(),"height*")&&function(t,e,n){return void 0===n&&(n=0),t.substr(n,e.length)===e}(o.toLowerCase(),"width*")&&function(t,e,n){return void 0===n&&(n=0),t.substr(n,e.length)===e}(l.toLowerCase(),"height*")||function(t,e,n){return void 0===n&&(n=0),t.substr(n,e.length)===e}(s.toLowerCase(),"controls.row_")||function(t,e,n){return void 0===n&&(n=0),t.substr(n,e.length)===e}(a.toLowerCase(),"controls.row_"))))},n.prototype.isVerticalLabel=function(){var t=this.getAttribute("TextDirection","V","");return t||null==this.masterShape||(t=this.masterShape.getAttribute("TextDirection","V","")),"1"==t},n.prototype.isRotatedLabel=function(){if(this.isVerticalLabel())return!0;var e,n=this.getAttribute(t.mxgraph.io.vsdx.mxVsdxConstants.TXT_ANGLE,"V","");return null!=this.masterShape&&((e=n)&&e.equals?e.equals(""):""===e)&&(n=this.masterShape.getAttribute(t.mxgraph.io.vsdx.mxVsdxConstants.TXT_ANGLE,"V","")),!(function(t,e){return t&&t.equals?t.equals("0"):"0"===t}(n)||function(t,e){return t&&t.equals?t.equals("0.0"):"0.0"===t}(n)||function(t,e){return t&&t.equals?t.equals(""):""===t}(n))},n.prototype.setRootShape=function(t){this.rootShape=t},n.prototype.getRootShape=function(){return this.rootShape},n.prototype.getStartXY=function(e){var n=Math.floor(Math.round(100*this.getScreenNumericalValue$org_w3c_dom_Element$double(this.getCellElement$java_lang_String(t.mxgraph.io.vsdx.mxVsdxConstants.BEGIN_X),0))/100),r=Math.floor(Math.round(100*(e-this.getScreenNumericalValue$org_w3c_dom_Element$double(this.getCellElement$java_lang_String(t.mxgraph.io.vsdx.mxVsdxConstants.BEGIN_Y),0)))/100);return new mxPoint(n,r)},n.prototype.getEndXY=function(e){var n=Math.floor(Math.round(100*this.getScreenNumericalValue$org_w3c_dom_Element$double(this.getCellElement$java_lang_String(t.mxgraph.io.vsdx.mxVsdxConstants.END_X),0))/100),r=Math.floor(Math.round(100*(e-this.getScreenNumericalValue$org_w3c_dom_Element$double(this.getCellElement$java_lang_String(t.mxgraph.io.vsdx.mxVsdxConstants.END_Y),0)))/100);return new mxPoint(n,r)},n.prototype.getRoutingPoints=function(t,e,n){return null!=this.geomList?this.geomList.getRoutingPoints(t,e,n):null},n.prototype.getControlPoints=function(e){var n=this.getStartXY(e),r=this.getEndXY(e),i=[];if(null!=this.shape){var s=this.shape.getElementsByTagName(t.mxgraph.io.vsdx.mxVsdxConstants.GEOM);if(s.length>0){var a=s.item(0).getElementsByTagName(t.mxgraph.io.vsdx.mxVsdxConstants.NURBS_TO).item(0).getElementsByTagName("E").item(0);if(null!=a){for(var o=a.getAttribute("F")||"",l=(o=(o=(o=(o=o.replace(new RegExp("NURBS\\(","g"),"")).replace(new RegExp("\\)","g"),"")).replace(new RegExp(",","g")," ")).replace(new RegExp("\\s\\s","g")," ")).split(" "),u=function(t){for(var e=[];t-- >0;)e.push(0);return e}(l.length),h=0;h<l.length;h++)u[h]=parseFloat(l[h]);for(h=2;h+4<l.length;h+=4){var g,c=new mxPoint,x=u[h+2],m=u[h+3],p=Math.abs(r.x-n.x),d=Math.min(100,p);g=n.x+d*x,c.x=Math.floor(Math.round(100*g)/100),c.y=Math.floor(Math.round(100*(n.y-100*m))/100),i.push(c)}return i}return null}}return null},n.prototype.getStyleFromEdgeShape=function(e){this.styleMap[t.mxgraph.io.vsdx.mxVsdxConstants.VSDX_ID]=this.getId().toString();var r,i=this.getForm();if(null!=i&&!((r=i)&&r.equals?r.equals(""):""===r))for(var s in i)this.styleMap[s]=i[s];if(this.isDashed()){this.styleMap[mxConstants.STYLE_DASHED]="1";var a=this.getDashPattern();null!=a&&(this.styleMap[mxConstants.STYLE_DASH_PATTERN]=a)}var o,l,u,h=this.getEdgeMarker(!0);null!=h&&(o=h,l=n.ARROW_NO_FILL_MARKER,void 0===u&&(u=0),o.substr(u,l.length)===l&&(h=h.substring(n.ARROW_NO_FILL_MARKER.length),this.styleMap[mxConstants.STYLE_STARTFILL]="0"),this.styleMap[mxConstants.STYLE_STARTARROW]=h);var g=this.getEdgeMarker(!1);null!=g&&(function(t,e,n){return void 0===n&&(n=0),t.substr(n,e.length)===e}(g,n.ARROW_NO_FILL_MARKER)&&(g=g.substring(n.ARROW_NO_FILL_MARKER.length),this.styleMap[mxConstants.STYLE_ENDFILL]="0"),this.styleMap[mxConstants.STYLE_ENDARROW]=g);var c=0|Math.round(this.getStartArrowSize());6!==c&&(this.styleMap[mxConstants.STYLE_STARTSIZE]=""+c);var x=0|Math.round(this.getFinalArrowSize());6!==x&&(this.styleMap[mxConstants.STYLE_ENDSIZE]=""+x);var m=0|Math.round(this.getLineWidth());1!==m&&(this.styleMap[mxConstants.STYLE_STROKEWIDTH]=""+m);var p=this.getStrokeColor();if(function(t,e){return t&&t.equals?t.equals(""):""===t}(p)||(this.styleMap[mxConstants.STYLE_STROKECOLOR]=p),this.isShadow()&&(this.styleMap[mxConstants.STYLE_SHADOW]=t.mxgraph.io.vsdx.mxVsdxConstants.TRUE),this.isConnectorBigNameU(this.getNameU())){this.styleMap[mxConstants.STYLE_SHAPE]=mxConstants.SHAPE_ARROW;var d=this.getFillColor();(function(t,e){return t&&t.equals?t.equals(""):""===t})(d)||(this.styleMap[mxConstants.STYLE_FILLCOLOR]=d)}var v=0|Math.round(this.getTopSpacing());this.styleMap[mxConstants.STYLE_SPACING_TOP]=""+v;var y=0|Math.round(this.getBottomSpacing());this.styleMap[mxConstants.STYLE_SPACING_BOTTOM]=""+y;var f=0|Math.round(this.getLeftSpacing());this.styleMap[mxConstants.STYLE_SPACING_LEFT]=""+f;var _=0|Math.round(this.getRightSpacing());this.styleMap[mxConstants.STYLE_SPACING_RIGHT]=""+_;var S=this.getAlignVertical();return this.styleMap[mxConstants.STYLE_VERTICAL_ALIGN]=S,this.styleMap.html="1",this.resolveCommonStyles(),this.styleMap},n.prototype.resolveCommonStyles=function(){var e,n=this.getTextBkgndColor(this.getCellElement$java_lang_String(t.mxgraph.io.vsdx.mxVsdxConstants.TEXT_BKGND));return((e=n)&&e.equals?e.equals(""):""===e)||"1"==this.getValue(this.getCellElement$java_lang_String("TextBkgndTrans"),"0")||(this.styleMap[mxConstants.STYLE_LABEL_BACKGROUNDCOLOR]=n),this.styleMap[mxConstants.STYLE_ROUNDED]=this.getRounding()>0?t.mxgraph.io.vsdx.mxVsdxConstants.TRUE:t.mxgraph.io.vsdx.mxVsdxConstants.FALSE,this.styleMap},n.prototype.getEdgeMarker=function(e){var r,i,s=this.getValue(this.getCellElement$java_lang_String(e?t.mxgraph.io.vsdx.mxVsdxConstants.BEGIN_ARROW:t.mxgraph.io.vsdx.mxVsdxConstants.END_ARROW),"0"),a=0;try{if(i="Themed",(r=s)&&r.equals?r.equals(i):r===i){var o=this.getTheme();null!=o&&(a=this.isVertex()?o.getEdgeMarker(e,this.getQuickStyleVals()):o.getConnEdgeMarker(e,this.getQuickStyleVals()))}else a=parseInt(s)}catch(t){}var l=function(t,e){null==t.entries&&(t.entries=[]);for(var n=0;n<t.entries.length;n++)if(null!=t.entries[n].key.equals&&t.entries[n].key.equals(e)||t.entries[n].key===e)return t.entries[n].value;return null}(n.arrowTypes_$LI$(),a);return a>0&&null==l&&(l=function(t,e){null==t.entries&&(t.entries=[]);for(var n=0;n<t.entries.length;n++)if(null!=t.entries[n].key.equals&&t.entries[n].key.equals(1)||1===t.entries[n].key)return t.entries[n].value;return null}(n.arrowTypes_$LI$())),l},n.prototype.getCellElement$java_lang_String=function(t){var n=e.prototype.getCellElement$java_lang_String.call(this,t);return null==n&&null!=this.masterShape?this.masterShape.getCellElement$java_lang_String(t):n},n.prototype.getCellElement$java_lang_String$java_lang_String$java_lang_String=function(t,n,r){var i=e.prototype.getCellElement$java_lang_String$java_lang_String$java_lang_String.call(this,t,n,r);return null==i&&null!=this.masterShape?this.masterShape.getCellElement$java_lang_String$java_lang_String$java_lang_String(t,n,r):i},n.prototype.getCellElement=function(t,e,n){if("string"!=typeof t&&null!==t||"string"!=typeof e&&null!==e||"string"!=typeof n&&null!==n){if("string"!=typeof t&&null!==t||void 0!==e||void 0!==n)throw new Error("invalid overload");return this.getCellElement$java_lang_String(t)}return this.getCellElement$java_lang_String$java_lang_String$java_lang_String(t,e,n)},n.prototype.createLabelSubShape=function(e,n){var r=this.getScreenNumericalValue$org_w3c_dom_Element$double(this.getShapeNode(t.mxgraph.io.vsdx.mxVsdxConstants.TXT_WIDTH),this.getWidth()),i=this.getScreenNumericalValue$org_w3c_dom_Element$double(this.getShapeNode(t.mxgraph.io.vsdx.mxVsdxConstants.TXT_HEIGHT),this.getHeight()),s=this.getScreenNumericalValue$org_w3c_dom_Element$double(this.getShapeNode(t.mxgraph.io.vsdx.mxVsdxConstants.TXT_LOC_PIN_X),r/2),a=this.getScreenNumericalValue$org_w3c_dom_Element$double(this.getShapeNode(t.mxgraph.io.vsdx.mxVsdxConstants.TXT_LOC_PIN_Y),i/2),o=this.getScreenNumericalValue$org_w3c_dom_Element$double(this.getShapeNode(t.mxgraph.io.vsdx.mxVsdxConstants.TXT_PIN_X),s),l=this.getScreenNumericalValue$org_w3c_dom_Element$double(this.getShapeNode(t.mxgraph.io.vsdx.mxVsdxConstants.TXT_PIN_Y),a),u=this.getValueAsDouble(this.getShapeNode(t.mxgraph.io.vsdx.mxVsdxConstants.TXT_ANGLE),0),h=this.getTextLabel();if(null!=h&&0!==h.length){var g=mxUtils.clone(this.getStyleMap())||{};g[mxConstants.STYLE_FILLCOLOR]=mxConstants.NONE,g[mxConstants.STYLE_STROKECOLOR]=mxConstants.NONE,g[mxConstants.STYLE_GRADIENTCOLOR]=mxConstants.NONE,g.hasOwnProperty("align")||(g.align="center"),g.hasOwnProperty("verticalAlign")||(g.verticalAlign="middle"),g.hasOwnProperty("whiteSpace")||(g.whiteSpace="wrap"),delete g.shape,delete g.image,this.isVerticalLabel()&&(u+=Math.PI+.01,g.horizontal="0");var c=this.getRotation();if(0!==u){var x=360-function(t){return 180*t/Math.PI}(u);0!=(x=Math.round((x+c)%360*100)/100)&&(g.rotation=""+x)}var m="text;"+t.mxgraph.io.vsdx.mxVsdxUtils.getStyleString(g,"="),p=n.getGeometry().height-(l+i-a),d=o-s;if(c>0){var v=new mxGeometry(d,p,r,i),y=n.getGeometry(),f=y.width/2,_=y.height/2;t.mxgraph.online.Utils.rotatedGeometry(v,c,f,_),d=v.x,p=v.y}return e.insertVertex(n,null,h,Math.round(100*d)/100,Math.round(100*p)/100,Math.round(100*r)/100,Math.round(100*i)/100,m+";html=1;")}return null},n.prototype.getLblEdgeOffset=function(e,n){if(null!=n&&n.length>1){var r=new mxCellState;r.absolutePoints=n,e.updateEdgeBounds(r);var i=e.getPoint(r),s=n[0],a=n[n.length-1],o=this.getScreenNumericalValue$org_w3c_dom_Element$double(this.getShapeNode(t.mxgraph.io.vsdx.mxVsdxConstants.TXT_WIDTH),this.getWidth()),l=this.getScreenNumericalValue$org_w3c_dom_Element$double(this.getShapeNode(t.mxgraph.io.vsdx.mxVsdxConstants.TXT_HEIGHT),this.getHeight()),u=this.getScreenNumericalValue$org_w3c_dom_Element$double(this.getShapeNode(t.mxgraph.io.vsdx.mxVsdxConstants.TXT_LOC_PIN_X),0),h=this.getScreenNumericalValue$org_w3c_dom_Element$double(this.getShapeNode(t.mxgraph.io.vsdx.mxVsdxConstants.TXT_LOC_PIN_Y),0),g=this.getScreenNumericalValue$org_w3c_dom_Element$double(this.getShapeNode(t.mxgraph.io.vsdx.mxVsdxConstants.TXT_PIN_X),0),c=this.getScreenNumericalValue$org_w3c_dom_Element$double(this.getShapeNode(t.mxgraph.io.vsdx.mxVsdxConstants.TXT_PIN_Y),0),x=(this.getHeight()-(s.y-a.y))/2+s.y-i.y-(c-h+l/2),m=g-u+o/2+(s.x-i.x);return Math.abs(m)>1e11?null:new mxPoint(Math.floor(Math.round(100*m)/100),Math.floor(Math.round(100*x)/100))}return null},n.prototype.getShapeIndex=function(){return this.shapeIndex},n.prototype.setShapeIndex=function(t){this.shapeIndex=t},n}(t.mxgraph.io.vsdx.Shape)).__static_initialized=!1,i.ARROW_NO_FILL_MARKER="0",i.maxDp=2,i.USE_SHAPE_MATCH=!1,i.stencilTemplate='<shape h="htemplate" w="wtemplate" aspect="variable" strokewidth="inherit"><connections></connections><background></background><foreground></foreground></shape>',r.VsdxShape=i,i.__class="com.mxgraph.io.vsdx.VsdxShape"}(com||(com={})),function(t){var e,n,r;e=t.mxgraph||(t.mxgraph={}),n=e.online||(e.online={}),(r=function(){function e(){}return e.__static_initialize=function(){e.__static_initialized||(e.__static_initialized=!0,e.__static_initializer_0())},e.CA_$LI$=function(){return e.__static_initialize(),null==e.CA&&(e.CA="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split("")),e.CA},e.IA_$LI$=function(){return e.__static_initialize(),null==e.IA&&(e.IA=function(t){for(var e=[];t-- >0;)e.push(0);return e}(256)),e.IA},e.__static_initializer_0=function(){!function(t,e){for(var n=0;n<t.length;n++)t[n]=-1}(e.IA_$LI$());for(var t=0,n=e.CA_$LI$().length;t<n;t++)e.IA_$LI$()[e.CA_$LI$()[t].charCodeAt(0)]=t;e.IA_$LI$()["=".charCodeAt(0)]=0},e.encodeToChar=function(t,n,r){var i=null!=t?t.length-n:0;if(0===i)return new Array(0);for(var s=3*(i/3|0),a=1+((i-1)/3|0)<<2,o=a+(r?((a-1)/76|0)<<1:0),l=new Array(o),u=n,h=0,g=0;u<s+n;){var c=(255&t[u++])<<16|(255&t[u++])<<8|255&t[u++];l[h++]=e.CA_$LI$()[c>>>18&63],l[h++]=e.CA_$LI$()[c>>>12&63],l[h++]=e.CA_$LI$()[c>>>6&63],l[h++]=e.CA_$LI$()[63&c],r&&19==++g&&h<o-2&&(l[h++]="\r",l[h++]="\n",g=0)}var x=i-s;return x>0&&(c=(255&t[s+n])<<10|(2===x?(255&t[i+n-1])<<2:0),l[o-4]=e.CA_$LI$()[c>>12],l[o-3]=e.CA_$LI$()[c>>>6&63],l[o-2]=2===x?e.CA_$LI$()[63&c]:"=",l[o-1]="="),l},e.decode$char_A=function(t){var n=null!=t?t.length:0;if(0===n)return[];for(var r=0,i=0;i<n;i++)e.IA_$LI$()[t[i].charCodeAt(0)]<0&&r++;if((n-r)%4!=0)return null;var s=0;for(i=n;i>1&&e.IA_$LI$()[t[--i].charCodeAt(0)]<=0;)(function(t){return null==t.charCodeAt?t:t.charCodeAt(0)})(t[i])=="=".charCodeAt(0)&&s++;for(var a=(6*(n-r)>>3)-s,o=function(t){for(var e=[];t-- >0;)e.push(0);return e}(a),l=0,u=0;u<a;){i=0;for(var h=0;h<4;h++){var g=e.IA_$LI$()[t[l++].charCodeAt(0)];g>=0?i|=g<<18-6*h:h--}o[u++]=i>>16|0,u<a&&(o[u++]=i>>8|0,u<a&&(o[u++]=0|i))}return o},e.decode=function(e){if(null!=e&&e instanceof Array&&(0==e.length||null==e[0]||"string"==typeof e[0])||null===e)return t.mxgraph.online.mxBase64.decode$char_A(e);if(null!=e&&e instanceof Array&&(0==e.length||null==e[0]||"number"==typeof e[0])||null===e)return t.mxgraph.online.mxBase64.decode$byte_A(e);if("string"==typeof e||null===e)return t.mxgraph.online.mxBase64.decode$java_lang_String(e);throw new Error("invalid overload")},e.decodeFast$char_A=function(t){var n=t.length;if(0===n)return[];for(var r=0,i=n-1;r<i&&e.IA_$LI$()[t[r].charCodeAt(0)]<0;)r++;for(;i>0&&e.IA_$LI$()[t[i].charCodeAt(0)]<0;)i--;for(var s,a=(null==(s=t[i]).charCodeAt?s:s.charCodeAt(0))=="=".charCodeAt(0)?function(t){return null==t.charCodeAt?t:t.charCodeAt(0)}(t[i-1])=="=".charCodeAt(0)?2:1:0,o=i-r+1,l=n>76?(function(t){return null==t.charCodeAt?t:t.charCodeAt(0)}(t[76])=="\r".charCodeAt(0)?o/78|0:0)<<1:0,u=(6*(o-l)>>3)-a,h=function(t){for(var e=[];t-- >0;)e.push(0);return e}(u),g=0,c=0,x=3*(u/3|0);g<x;){var m=e.IA_$LI$()[t[r++].charCodeAt(0)]<<18|e.IA_$LI$()[t[r++].charCodeAt(0)]<<12|e.IA_$LI$()[t[r++].charCodeAt(0)]<<6|e.IA_$LI$()[t[r++].charCodeAt(0)];h[g++]=m>>16|0,h[g++]=m>>8|0,h[g++]=0|m,l>0&&19==++c&&(r+=2,c=0)}if(g<u){m=0;for(var p=0;r<=i-a;p++)m|=e.IA_$LI$()[t[r++].charCodeAt(0)]<<18-6*p;for(var d=16;g<u;d-=8)h[g++]=m>>d|0}return h},e.decodeFast=function(e){if(null!=e&&e instanceof Array&&(0==e.length||null==e[0]||"string"==typeof e[0])||null===e)return t.mxgraph.online.mxBase64.decodeFast$char_A(e);if(null!=e&&e instanceof Array&&(0==e.length||null==e[0]||"number"==typeof e[0])||null===e)return t.mxgraph.online.mxBase64.decodeFast$byte_A(e);if("string"==typeof e||null===e)return t.mxgraph.online.mxBase64.decodeFast$java_lang_String(e);throw new Error("invalid overload")},e.encodeToByte=function(t,n){var r=null!=t?t.length:0;if(0===r)return[];for(var i=3*(r/3|0),s=1+((r-1)/3|0)<<2,a=s+(n?((s-1)/76|0)<<1:0),o=function(t){for(var e=[];t-- >0;)e.push(0);return e}(a),l=0,u=0,h=0;l<i;){var g=(255&t[l++])<<16|(255&t[l++])<<8|255&t[l++];o[u++]=e.CA_$LI$()[g>>>18&63].charCodeAt(0),o[u++]=e.CA_$LI$()[g>>>12&63].charCodeAt(0),o[u++]=e.CA_$LI$()[g>>>6&63].charCodeAt(0),o[u++]=e.CA_$LI$()[63&g].charCodeAt(0),n&&19==++h&&u<a-2&&(o[u++]="\r".charCodeAt(0),o[u++]="\n".charCodeAt(0),h=0)}var c=r-i;return c>0&&(g=(255&t[i])<<10|(2===c?(255&t[r-1])<<2:0),o[a-4]=e.CA_$LI$()[g>>12].charCodeAt(0),o[a-3]=e.CA_$LI$()[g>>>6&63].charCodeAt(0),o[a-2]=2===c?e.CA_$LI$()[63&g].charCodeAt(0):"=".charCodeAt(0),o[a-1]="=".charCodeAt(0)),o},e.decode$byte_A=function(t){for(var n=t.length,r=0,i=0;i<n;i++)e.IA_$LI$()[255&t[i]]<0&&r++;if((n-r)%4!=0)return null;var s=0;for(i=n;i>1&&e.IA_$LI$()[255&t[--i]]<=0;)t[i]=="=".charCodeAt(0)&&s++;for(var a=(6*(n-r)>>3)-s,o=function(t){for(var e=[];t-- >0;)e.push(0);return e}(a),l=0,u=0;u<a;){i=0;for(var h=0;h<4;h++){var g=e.IA_$LI$()[255&t[l++]];g>=0?i|=g<<18-6*h:h--}o[u++]=i>>16|0,u<a&&(o[u++]=i>>8|0,u<a&&(o[u++]=0|i))}return o},e.decodeFast$byte_A=function(t){var n=t.length;if(0===n)return[];for(var r=0,i=n-1;r<i&&e.IA_$LI$()[255&t[r]]<0;)r++;for(;i>0&&e.IA_$LI$()[255&t[i]]<0;)i--;for(var s=t[i]=="=".charCodeAt(0)?t[i-1]=="=".charCodeAt(0)?2:1:0,a=i-r+1,o=n>76?(t[76]=="\r".charCodeAt(0)?a/78|0:0)<<1:0,l=(6*(a-o)>>3)-s,u=function(t){for(var e=[];t-- >0;)e.push(0);return e}(l),h=0,g=0,c=3*(l/3|0);h<c;){var x=e.IA_$LI$()[t[r++]]<<18|e.IA_$LI$()[t[r++]]<<12|e.IA_$LI$()[t[r++]]<<6|e.IA_$LI$()[t[r++]];u[h++]=x>>16|0,u[h++]=x>>8|0,u[h++]=0|x,o>0&&19==++g&&(r+=2,g=0)}if(h<l){x=0;for(var m=0;r<=i-s;m++)x|=e.IA_$LI$()[t[r++]]<<18-6*m;for(var p=16;h<l;p-=8)u[h++]=x>>p|0}return u},e.encodeToString=function(t,n,r){return e.encodeToChar(t,n,r).join("")},e.decode$java_lang_String=function(t){var n=null!=t?t.length:0;if(0===n)return[];for(var r=0,i=0;i<n;i++)e.IA_$LI$()[t.charAt(i).charCodeAt(0)]<0&&r++;if((n-r)%4!=0)return null;var s=0;for(i=n;i>1&&e.IA_$LI$()[t.charAt(--i).charCodeAt(0)]<=0;)(function(t){return null==t.charCodeAt?t:t.charCodeAt(0)})(t.charAt(i))=="=".charCodeAt(0)&&s++;for(var a=(6*(n-r)>>3)-s,o=function(t){for(var e=[];t-- >0;)e.push(0);return e}(a),l=0,u=0;u<a;){i=0;for(var h=0;h<4;h++){var g=e.IA_$LI$()[t.charAt(l++).charCodeAt(0)];g>=0?i|=g<<18-6*h:h--}o[u++]=i>>16|0,u<a&&(o[u++]=i>>8|0,u<a&&(o[u++]=0|i))}return o},e.decodeFast$java_lang_String=function(t){var n=t.length;if(0===n)return[];for(var r,i=0,s=n-1;i<s&&e.IA_$LI$()[255&(r=t.charAt(i),null==r.charCodeAt?r:r.charCodeAt(0))]<0;)i++;for(;s>0&&e.IA_$LI$()[255&function(t){return null==t.charCodeAt?t:t.charCodeAt(0)}(t.charAt(s))]<0;)s--;for(var a=function(t){return null==t.charCodeAt?t:t.charCodeAt(0)}(t.charAt(s))=="=".charCodeAt(0)?function(t){return null==t.charCodeAt?t:t.charCodeAt(0)}(t.charAt(s-1))=="=".charCodeAt(0)?2:1:0,o=s-i+1,l=n>76?(function(t){return null==t.charCodeAt?t:t.charCodeAt(0)}(t.charAt(76))=="\r".charCodeAt(0)?o/78|0:0)<<1:0,u=(6*(o-l)>>3)-a,h=function(t){for(var e=[];t-- >0;)e.push(0);return e}(u),g=0,c=0,x=3*(u/3|0);g<x;){var m=e.IA_$LI$()[t.charAt(i++).charCodeAt(0)]<<18|e.IA_$LI$()[t.charAt(i++).charCodeAt(0)]<<12|e.IA_$LI$()[t.charAt(i++).charCodeAt(0)]<<6|e.IA_$LI$()[t.charAt(i++).charCodeAt(0)];h[g++]=m>>16|0,h[g++]=m>>8|0,h[g++]=0|m,l>0&&19==++c&&(i+=2,c=0)}if(g<u){m=0;for(var p=0;i<=s-a;p++)m|=e.IA_$LI$()[t.charAt(i++).charCodeAt(0)]<<18-6*p;for(var d=16;g<u;d-=8)h[g++]=m>>d|0}return h},e}()).__static_initialized=!1,n.mxBase64=r,r.__class="com.mxgraph.online.mxBase64"}(com||(com={})),com.mxgraph.online.mxBase64.IA_$LI$(),com.mxgraph.online.mxBase64.CA_$LI$(),com.mxgraph.online.mxBase64.__static_initialize(),com.mxgraph.io.vsdx.VsdxShape.__com_mxgraph_io_vsdx_VsdxShape_LOGGER_$LI$(),com.mxgraph.io.vsdx.VsdxShape.arrowTypes_$LI$(),com.mxgraph.io.vsdx.VsdxShape.arrowSizes_$LI$(),com.mxgraph.io.vsdx.VsdxShape.OFFSET_ARRAY_$LI$(),com.mxgraph.io.vsdx.VsdxShape.__static_initialize(),com.mxgraph.io.vsdx.Shape.UNICODE_LINE_SEP_$LI$(),com.mxgraph.io.vsdx.Style.lineDashPatterns_$LI$(),com.mxgraph.io.vsdx.Style.styleTypes_$LI$(),com.mxgraph.io.vsdx.Style.__static_initialize(),com.mxgraph.online.Constants.MAX_AREA_$LI$(),com.mxgraph.io.vsdx.theme.Color.NONE_$LI$(),com.mxgraph.io.vsdx.mxVsdxUtils.conversionFactor_$LI$(),com.mxgraph.io.vsdx.mxVsdxTheme.colorIds_$LI$(),com.mxgraph.io.vsdx.mxVsdxTheme.themesIds_$LI$(),com.mxgraph.io.vsdx.mxVsdxTheme.__static_initialize(),com.mxgraph.io.vsdx.mxVsdxConstants.MY_SET_$LI$(),com.mxgraph.io.vsdx.mxVsdxConstants.SET_VALUES_$LI$(),com.mxgraph.io.vsdx.mxPropertiesManager.defaultColors_$LI$(),com.mxgraph.io.vsdx.mxPropertiesManager.__static_initialize(),com.mxgraph.io.mxVsdxCodec.vsdxPlaceholder_$LI$(),com.mxgraph.io.mxVsdxCodec.parsererrorNS_$LI$(),EditorUi.prototype.doImportVisio=function(t,e,n,r){null!=(r=r||t.name)&&/(\.vs(x|sx?))($|\?)/i.test(r)?new com.mxgraph.io.mxVssxCodec(this).decodeVssx(t,e,null,n):new com.mxgraph.io.mxVsdxCodec(this).decodeVsdx(t,e,null,n)};