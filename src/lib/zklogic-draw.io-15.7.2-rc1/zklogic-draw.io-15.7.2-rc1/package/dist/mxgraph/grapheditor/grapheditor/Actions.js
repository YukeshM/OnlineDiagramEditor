function Actions(e){this.editorUi=e,this.actions=new Object,this.init()}function Action(e,t,n,l,i){mxEventSource.call(this),this.label=e,this.funct=this.createFunction(t),this.enabled=null==n||n,this.iconCls=l,this.shortcut=i,this.visible=!0}Actions.prototype.init=function(){var e=this.editorUi,t=e.editor,n=t.graph,l=function(){return Action.prototype.isEnabled.apply(this,arguments)&&n.isEnabled()};function i(e){n.escape();var t=n.deleteCells(n.getDeletableCells(n.getSelectionCells()),e);null!=t&&n.setSelectionCells(t)}function o(){if(!n.isSelectionEmpty()){n.getModel().beginUpdate();try{for(var e=n.getSelectionCells(),t=0;t<e.length;t++)n.cellLabelChanged(e[t],"")}finally{n.getModel().endUpdate()}}}this.addAction("new...",(function(){n.openLink(e.getUrl())})),this.addAction("open...",(function(){window.openNew=!0,window.openKey="open",e.openFile()})),this.addAction("smartFit",(function(){n.popupMenuHandler.hideMenu();var t=n.view.scale,l=n.view.translate.x,i=n.view.translate.y;e.actions.get("resetView").funct(),Math.abs(t-n.view.scale)<1e-5&&l==n.view.translate.x&&i==n.view.translate.y&&e.actions.get(n.pageVisible?"fitPage":"fitWindow").funct()})),this.addAction("keyPressEnter",(function(){n.isEnabled()&&(n.isSelectionEmpty()?e.actions.get("smartFit").funct():n.startEditingAtCell())})),this.addAction("import...",(function(){window.openNew=!1,window.openKey="import",window.openFile=new OpenFile(mxUtils.bind(this,(function(){e.hideDialog()}))),window.openFile.setConsumer(mxUtils.bind(this,(function(e,n){try{var l=mxUtils.parseXml(e);t.graph.setSelectionCells(t.graph.importGraphModel(l.documentElement))}catch(e){mxUtils.alert(mxResources.get("invalidOrMissingFile")+": "+e.message)}}))),e.showDialog(new OpenDialog(this).container,320,220,!0,!0,(function(){window.openFile=null}))})).isEnabled=l,this.addAction("save",(function(){e.saveFile(!1)}),null,null,Editor.ctrlKey+"+S").isEnabled=l,this.addAction("saveAs...",(function(){e.saveFile(!0)}),null,null,Editor.ctrlKey+"+Shift+S").isEnabled=l,this.addAction("export...",(function(){e.showDialog(new ExportDialog(e).container,300,340,!0,!0)})),this.addAction("editDiagram...",(function(){var t=new EditDiagramDialog(e);e.showDialog(t.container,620,420,!0,!1),t.init()})),this.addAction("pageSetup...",(function(){e.showDialog(new PageSetupDialog(e).container,320,240,!0,!0)})).isEnabled=l,this.addAction("print...",(function(){e.showDialog(new PrintDialog(e).container,300,180,!0,!0)}),null,"sprite-print",Editor.ctrlKey+"+P"),this.addAction("preview",(function(){mxUtils.show(n,null,10,10)})),this.addAction("undo",(function(){e.undo()}),null,"sprite-undo",Editor.ctrlKey+"+Z"),this.addAction("redo",(function(){e.redo()}),null,"sprite-redo",mxClient.IS_WIN?Editor.ctrlKey+"+Y":Editor.ctrlKey+"+Shift+Z"),this.addAction("cut",(function(){var t=null;try{null!=(t=e.copyXml())&&n.removeCells(t,!1)}catch(e){}null==t&&mxClipboard.cut(n)}),null,"sprite-cut",Editor.ctrlKey+"+X"),this.addAction("copy",(function(){try{e.copyXml()}catch(e){}try{mxClipboard.copy(n)}catch(t){e.handleError(t)}}),null,"sprite-copy",Editor.ctrlKey+"+C"),this.addAction("paste",(function(){if(n.isEnabled()&&!n.isCellLocked(n.getDefaultParent())){var t=!1;try{Editor.enableNativeCipboard&&(e.readGraphModelFromClipboard((function(t){if(null!=t){n.getModel().beginUpdate();try{e.pasteXml(t,!0)}finally{n.getModel().endUpdate()}}else mxClipboard.paste(n)})),t=!0)}catch(e){}t||mxClipboard.paste(n)}}),!1,"sprite-paste",Editor.ctrlKey+"+V"),this.addAction("pasteHere",(function(t){function l(e){if(null!=e){for(var t=!0,l=0;l<e.length&&t;l++)t=t&&n.model.isEdge(e[l]);var i=n.view.translate,o=n.view.scale,s=i.x,a=i.y,d=null;if(1==e.length&&t){var r=n.getCellGeometry(e[0]);null!=r&&(d=r.getTerminalPoint(!0))}if(null!=(d=null!=d?d:n.getBoundingBoxFromGeometry(e,t))){var c=Math.round(n.snap(n.popupMenuHandler.triggerX/o-s)),u=Math.round(n.snap(n.popupMenuHandler.triggerY/o-a));n.cellsMoved(e,c-d.x,u-d.y)}}}function i(){n.getModel().beginUpdate();try{l(mxClipboard.paste(n))}finally{n.getModel().endUpdate()}}if(n.isEnabled()&&!n.isCellLocked(n.getDefaultParent())){var o=!1;try{Editor.enableNativeCipboard&&(e.readGraphModelFromClipboard((function(t){if(null!=t){n.getModel().beginUpdate();try{l(e.pasteXml(t,!0))}finally{n.getModel().endUpdate()}}else i()})),o=!0)}catch(e){}o||i()}})),this.addAction("copySize",(function(){var t=n.getSelectionCell();if(n.isEnabled()&&null!=t&&n.getModel().isVertex(t)){var l=n.getCellGeometry(t);null!=l&&(e.copiedSize=new mxRectangle(l.x,l.y,l.width,l.height))}}),null,null,"Alt+Shift+X"),this.addAction("pasteSize",(function(){if(n.isEnabled()&&!n.isSelectionEmpty()&&null!=e.copiedSize){n.getModel().beginUpdate();try{for(var t=n.getResizableCells(n.getSelectionCells()),l=0;l<t.length;l++)if(n.getModel().isVertex(t[l])){var i=n.getCellGeometry(t[l]);null!=i&&((i=i.clone()).width=e.copiedSize.width,i.height=e.copiedSize.height,n.getModel().setGeometry(t[l],i))}}finally{n.getModel().endUpdate()}}}),null,null,"Alt+Shift+V"),this.addAction("copyData",(function(){var t=n.getSelectionCell()||n.getModel().getRoot();if(n.isEnabled()&&null!=t){var l=t.cloneValue();null==l||isNaN(l.nodeType)||(e.copiedValue=l)}}),null,null,"Alt+Shift+B"),this.addAction("pasteData",(function(t,l){t=null!=l?l:t;var i=n.getModel();function o(e,l){var o=i.getValue(e);(l=e.cloneValue(l)).removeAttribute("placeholders"),null==o||isNaN(o.nodeType)||l.setAttribute("placeholders",o.getAttribute("placeholders")),null!=t&&mxEvent.isShiftDown(t)||l.setAttribute("label",n.convertValueToString(e)),i.setValue(e,l)}if(n.isEnabled()&&!n.isSelectionEmpty()&&null!=e.copiedValue){i.beginUpdate();try{var s=n.getEditableCells(n.getSelectionCells());if(0==s.length)o(i.getRoot(),e.copiedValue);else for(var a=0;a<s.length;a++)o(s[a],e.copiedValue)}finally{i.endUpdate()}}}),null,null,"Alt+Shift+E"),this.addAction("delete",(function(e,t){null!=(e=null!=t?t:e)&&mxEvent.isShiftDown(e)?o():i(null!=e&&(mxEvent.isControlDown(e)||mxEvent.isMetaDown(e)||mxEvent.isAltDown(e)))}),null,null,"Delete"),this.addAction("deleteAll",(function(){i(!0)})),this.addAction("deleteLabels",(function(){o()}),null,null,Editor.ctrlKey+"+Delete"),this.addAction("duplicate",(function(){try{n.setSelectionCells(n.duplicateCells()),n.scrollCellToVisible(n.getSelectionCell())}catch(t){e.handleError(t)}}),null,null,Editor.ctrlKey+"+D"),this.put("turn",new Action(mxResources.get("turn")+" / "+mxResources.get("reverse"),(function(e,t){e=null!=t?t:e,n.turnShapes(n.getResizableCells(n.getSelectionCells()),null!=e&&mxEvent.isShiftDown(e))}),null,null,mxClient.IS_SF?null:Editor.ctrlKey+"+R")),this.put("selectConnections",new Action(mxResources.get("selectEdges"),(function(e){var t=n.getSelectionCell();n.isEnabled()&&null!=t&&n.addSelectionCells(n.getEdges(t))}))),this.addAction("selectVertices",(function(){n.selectVertices(null,!0)}),null,null,Editor.ctrlKey+"+Shift+I"),this.addAction("selectEdges",(function(){n.selectEdges()}),null,null,Editor.ctrlKey+"+Shift+E"),this.addAction("selectAll",(function(){n.selectAll(null,!0)}),null,null,Editor.ctrlKey+"+A"),this.addAction("selectNone",(function(){n.clearSelection()}),null,null,Editor.ctrlKey+"+Shift+A"),this.addAction("lockUnlock",(function(){if(!n.isSelectionEmpty()){n.getModel().beginUpdate();try{var e=n.getSelectionCells(),t=n.getCurrentCellStyle(n.getSelectionCell()),l=1==mxUtils.getValue(t,mxConstants.STYLE_EDITABLE,1)?0:1;n.setCellStyles(mxConstants.STYLE_MOVABLE,l,e),n.setCellStyles(mxConstants.STYLE_RESIZABLE,l,e),n.setCellStyles(mxConstants.STYLE_ROTATABLE,l,e),n.setCellStyles(mxConstants.STYLE_DELETABLE,l,e),n.setCellStyles(mxConstants.STYLE_EDITABLE,l,e),n.setCellStyles("connectable",l,e)}finally{n.getModel().endUpdate()}}}),null,null,Editor.ctrlKey+"+L"),this.addAction("home",(function(){n.home()}),null,null,"Shift+Home"),this.addAction("exitGroup",(function(){n.exitGroup()}),null,null,Editor.ctrlKey+"+Shift+Home"),this.addAction("enterGroup",(function(){n.enterGroup()}),null,null,Editor.ctrlKey+"+Shift+End"),this.addAction("collapse",(function(){n.foldCells(!0)}),null,null,Editor.ctrlKey+"+Home"),this.addAction("expand",(function(){n.foldCells(!1)}),null,null,Editor.ctrlKey+"+End"),this.addAction("toFront",(function(){n.orderCells(!1)}),null,null,Editor.ctrlKey+"+Shift+F"),this.addAction("toBack",(function(){n.orderCells(!0)}),null,null,Editor.ctrlKey+"+Shift+B"),this.addAction("bringForward",(function(e){n.orderCells(!1,null,!0)})),this.addAction("sendBackward",(function(e){n.orderCells(!0,null,!0)})),this.addAction("group",(function(){if(n.isEnabled()){var e=mxUtils.sortCells(n.getSelectionCells(),!0);1!=e.length||n.isTable(e[0])||n.isTableRow(e[0])?(e=n.getCellsForGroup(e)).length>1&&n.setSelectionCell(n.groupCells(null,0,e)):n.setCellStyles("container","1")}}),null,null,Editor.ctrlKey+"+G"),this.addAction("ungroup",(function(){if(n.isEnabled()){var e=n.getEditableCells(n.getSelectionCells());n.model.beginUpdate();try{var t=n.ungroupCells();if(null!=e)for(var l=0;l<e.length;l++)n.model.contains(e[l])&&(0==n.model.getChildCount(e[l])&&n.model.isVertex(e[l])&&n.setCellStyles("container","0",[e[l]]),t.push(e[l]))}finally{n.model.endUpdate()}t.length>0&&n.setSelectionCells(t)}}),null,null,Editor.ctrlKey+"+Shift+U"),this.addAction("removeFromGroup",(function(){if(n.isEnabled()){var e=n.getSelectionCells();if(null!=e){for(var t=[],l=0;l<e.length;l++)n.isTableRow(e[l])||n.isTableCell(e[l])||t.push(e[l]);n.removeCellsFromParent(t)}}})),this.addAction("edit",(function(){n.isEnabled()&&n.startEditingAtCell()}),null,null,"F2/Enter"),this.addAction("editData...",(function(){var t=n.getSelectionCell()||n.getModel().getRoot();e.showDataDialog(t)}),null,null,Editor.ctrlKey+"+M"),this.addAction("editTooltip...",(function(){var t=n.getSelectionCell();if(n.isEnabled()&&null!=t&&n.isCellEditable(t)){var l="";if(mxUtils.isNode(t.value)){var i=null;Graph.translateDiagram&&null!=Graph.diagramLanguage&&t.value.hasAttribute("tooltip_"+Graph.diagramLanguage)&&(i=t.value.getAttribute("tooltip_"+Graph.diagramLanguage)),null==i&&(i=t.value.getAttribute("tooltip")),null!=i&&(l=i)}var o=new TextareaDialog(e,mxResources.get("editTooltip")+":",l,(function(e){n.setTooltipForCell(t,e)}));e.showDialog(o.container,320,200,!0,!0),o.init()}}),null,null,"Alt+Shift+T"),this.addAction("openLink",(function(){var e=n.getLinkForCell(n.getSelectionCell());null!=e&&n.openLink(e)})),this.addAction("editLink...",(function(){var t=n.getSelectionCell();if(n.isEnabled()&&null!=t&&n.isCellEditable(t)){var l=n.getLinkForCell(t)||"";e.showLinkDialog(l,mxResources.get("apply"),(function(e,l,i){e=mxUtils.trim(e),n.setLinkForCell(t,e.length>0?e:null),n.setAttributeForCell(t,"linkTarget",i)}),!0,n.getLinkTargetForCell(t))}}),null,null,"Alt+Shift+L"),this.put("insertImage",new Action(mxResources.get("image")+"...",(function(){n.isEnabled()&&!n.isCellLocked(n.getDefaultParent())&&(n.clearSelection(),e.actions.get("image").funct())}))).isEnabled=l,this.put("insertLink",new Action(mxResources.get("link")+"...",(function(){n.isEnabled()&&!n.isCellLocked(n.getDefaultParent())&&e.showLinkDialog("",mxResources.get("insert"),(function(e,t,l){if((e=mxUtils.trim(e)).length>0){var i=null,o=n.getLinkTitle(e);null!=t&&t.length>0&&(i=t[0].iconUrl,(o=(o=t[0].name||t[0].type).charAt(0).toUpperCase()+o.substring(1)).length>30&&(o=o.substring(0,30)+"..."));var s=new mxCell(o,new mxGeometry(0,0,100,40),"fontColor=#0000EE;fontStyle=4;rounded=1;overflow=hidden;"+(null!=i?"shape=label;imageWidth=16;imageHeight=16;spacingLeft=26;align=left;image="+i:"spacing=10;"));s.vertex=!0;var a=n.getCenterInsertPoint(n.getBoundingBoxFromGeometry([s],!0));s.geometry.x=a.x,s.geometry.y=a.y,n.setAttributeForCell(s,"linkTarget",l),n.setLinkForCell(s,e),n.cellSizeUpdated(s,!0),n.getModel().beginUpdate();try{s=n.addCell(s),n.fireEvent(new mxEventObject("cellsInserted","cells",[s]))}finally{n.getModel().endUpdate()}n.setSelectionCell(s),n.scrollCellToVisible(n.getSelectionCell())}}),!0)}))).isEnabled=l,this.addAction("link...",mxUtils.bind(this,(function(){if(n.isEnabled())if(n.cellEditor.isContentEditing()){var t=n.getSelectedElement(),l=n.getParentByName(t,"A",n.cellEditor.textarea),i="";if(null==l&&null!=t&&null!=t.getElementsByTagName)for(var o=t.getElementsByTagName("a"),s=0;s<o.length&&null==l;s++)o[s].textContent==t.textContent&&(l=o[s]);null!=l&&"A"==l.nodeName&&(i=l.getAttribute("href")||"",n.selectNode(l));var a=n.cellEditor.saveSelection();e.showLinkDialog(i,mxResources.get("apply"),mxUtils.bind(this,(function(e){n.cellEditor.restoreSelection(a),null!=e&&n.insertLink(e)})))}else n.isSelectionEmpty()?this.get("insertLink").funct():this.get("editLink").funct()}))).isEnabled=l,this.addAction("autosize",(function(){var e=n.getSelectionCells();if(null!=e){n.getModel().beginUpdate();try{for(var t=0;t<e.length;t++){var l=e[t];n.getModel().getChildCount(l)>0?n.updateGroupBounds([l],0,!0):n.updateCellSize(l)}}finally{n.getModel().endUpdate()}}}),null,null,Editor.ctrlKey+"+Shift+Y"),this.addAction("formattedText",(function(){n.stopEditing();var t=n.getCommonStyle(n.getSelectionCells()),l="1"==mxUtils.getValue(t,"html","0")?null:"1";n.getModel().beginUpdate();try{for(var i=n.getEditableCells(n.getSelectionCells()),o=0;o<i.length;o++)if(state=n.getView().getState(i[o]),null!=state){var s=mxUtils.getValue(state.style,"html","0");if("1"==s&&null==l){var a=n.convertValueToString(state.cell);"0"!=mxUtils.getValue(state.style,"nl2Br","1")&&(a=a.replace(/\n/g,"").replace(/<br\s*.?>/g,"\n"));var d=document.createElement("div");d.innerHTML=n.sanitizeHtml(a),a=mxUtils.extractTextWithWhitespace(d.childNodes),n.cellLabelChanged(state.cell,a),n.setCellStyles("html",l,[i[o]])}else"0"==s&&"1"==l&&(a=mxUtils.htmlEntities(n.convertValueToString(state.cell),!1),"0"!=mxUtils.getValue(state.style,"nl2Br","1")&&(a=a.replace(/\n/g,"<br/>")),n.cellLabelChanged(state.cell,n.sanitizeHtml(a)),n.setCellStyles("html",l,[i[o]]))}e.fireEvent(new mxEventObject("styleChanged","keys",["html"],"values",[null!=l?l:"0"],"cells",i))}finally{n.getModel().endUpdate()}})),this.addAction("wordWrap",(function(){var e=n.getView().getState(n.getSelectionCell()),t="wrap";n.stopEditing(),null!=e&&"wrap"==e.style[mxConstants.STYLE_WHITE_SPACE]&&(t=null),n.setCellStyles(mxConstants.STYLE_WHITE_SPACE,t)})),this.addAction("rotation",(function(){var t="0",l=n.getView().getState(n.getSelectionCell());null!=l&&(t=l.style[mxConstants.STYLE_ROTATION]||t);var i=new FilenameDialog(e,t,mxResources.get("apply"),(function(e){null!=e&&e.length>0&&n.setCellStyles(mxConstants.STYLE_ROTATION,e)}),mxResources.get("enterValue")+" ("+mxResources.get("rotation")+" 0-360)");e.showDialog(i.container,375,80,!0,!0),i.init()})),this.addAction("resetView",(function(){n.zoomTo(1),e.resetScrollbars()}),null,null,"Enter/Home"),this.addAction("zoomIn",(function(t){n.isFastZoomEnabled()?n.lazyZoom(!0,!0,e.buttonZoomDelay):n.zoomIn()}),null,null,Editor.ctrlKey+" + (Numpad) / Alt+Mousewheel"),this.addAction("zoomOut",(function(t){n.isFastZoomEnabled()?n.lazyZoom(!1,!0,e.buttonZoomDelay):n.zoomOut()}),null,null,Editor.ctrlKey+" - (Numpad) / Alt+Mousewheel"),this.addAction("fitWindow",(function(){var t=n.isSelectionEmpty()?n.getGraphBounds():n.getBoundingBox(n.getSelectionCells()),l=n.view.translate,i=n.view.scale;if(t.x=t.x/i-l.x,t.y=t.y/i-l.y,t.width/=i,t.height/=i,null!=n.backgroundImage&&(t=mxRectangle.fromRectangle(t)).add(new mxRectangle(0,0,n.backgroundImage.width,n.backgroundImage.height)),0==t.width||0==t.height)n.zoomTo(1),e.resetScrollbars();else{var o=Editor.fitWindowBorders;null!=o&&(t.x-=o.x,t.y-=o.y,t.width+=o.width+o.x,t.height+=o.height+o.y),n.fitWindow(t)}}),null,null,Editor.ctrlKey+"+Shift+H"),this.addAction("fitPage",mxUtils.bind(this,(function(){n.pageVisible||this.get("pageView").funct();var e=n.pageFormat,t=n.pageScale,l=n.container.clientWidth-10,i=n.container.clientHeight-10,o=Math.floor(20*Math.min(l/e.width/t,i/e.height/t))/20;if(n.zoomTo(o),mxUtils.hasScrollbars(n.container)){var s=n.getPagePadding();n.container.scrollTop=s.y*n.view.scale-1,n.container.scrollLeft=Math.min(s.x*n.view.scale,(n.container.scrollWidth-n.container.clientWidth)/2)-1}})),null,null,Editor.ctrlKey+"+J"),this.addAction("fitTwoPages",mxUtils.bind(this,(function(){n.pageVisible||this.get("pageView").funct();var e=n.pageFormat,t=n.pageScale,l=n.container.clientWidth-10,i=n.container.clientHeight-10,o=Math.floor(20*Math.min(l/(2*e.width)/t,i/e.height/t))/20;if(n.zoomTo(o),mxUtils.hasScrollbars(n.container)){var s=n.getPagePadding();n.container.scrollTop=Math.min(s.y,(n.container.scrollHeight-n.container.clientHeight)/2),n.container.scrollLeft=Math.min(s.x,(n.container.scrollWidth-n.container.clientWidth)/2)}})),null,null,Editor.ctrlKey+"+Shift+J"),this.addAction("fitPageWidth",mxUtils.bind(this,(function(){n.pageVisible||this.get("pageView").funct();var e=n.pageFormat,t=n.pageScale,l=n.container.clientWidth-10,i=Math.floor(20*l/e.width/t)/20;if(n.zoomTo(i),mxUtils.hasScrollbars(n.container)){var o=n.getPagePadding();n.container.scrollLeft=Math.min(o.x*n.view.scale,(n.container.scrollWidth-n.container.clientWidth)/2)}}))),this.put("customZoom",new Action(mxResources.get("custom")+"...",mxUtils.bind(this,(function(){var e=new FilenameDialog(this.editorUi,parseInt(100*n.getView().getScale()),mxResources.get("apply"),mxUtils.bind(this,(function(e){var t=parseInt(e);!isNaN(t)&&t>0&&n.zoomTo(t/100)})),mxResources.get("zoom")+" (%)");this.editorUi.showDialog(e.container,300,80,!0,!0),e.init()})),null,null,Editor.ctrlKey+"+0")),this.addAction("pageScale...",mxUtils.bind(this,(function(){var t=new FilenameDialog(this.editorUi,parseInt(100*n.pageScale),mxResources.get("apply"),mxUtils.bind(this,(function(t){var l=parseInt(t);if(!isNaN(l)&&l>0){var i=new ChangePageSetup(e,null,null,null,l/100);i.ignoreColor=!0,i.ignoreImage=!0,n.model.execute(i)}})),mxResources.get("pageScale")+" (%)");this.editorUi.showDialog(t.container,300,80,!0,!0),t.init()})));var s=null;(s=this.addAction("grid",(function(){n.setGridEnabled(!n.isGridEnabled()),n.defaultGridEnabled=n.isGridEnabled(),e.fireEvent(new mxEventObject("gridEnabledChanged"))}),null,null,Editor.ctrlKey+"+Shift+G")).setToggleAction(!0),s.setSelectedCallback((function(){return n.isGridEnabled()})),s.setEnabled(!1),(s=this.addAction("guides",(function(){n.graphHandler.guidesEnabled=!n.graphHandler.guidesEnabled,e.fireEvent(new mxEventObject("guidesEnabledChanged"))}))).setToggleAction(!0),s.setSelectedCallback((function(){return n.graphHandler.guidesEnabled})),s.setEnabled(!1),(s=this.addAction("tooltips",(function(){n.tooltipHandler.setEnabled(!n.tooltipHandler.isEnabled()),e.fireEvent(new mxEventObject("tooltipsEnabledChanged"))}))).setToggleAction(!0),s.setSelectedCallback((function(){return n.tooltipHandler.isEnabled()})),(s=this.addAction("collapseExpand",(function(){var t=new ChangePageSetup(e);t.ignoreColor=!0,t.ignoreImage=!0,t.foldingEnabled=!n.foldingEnabled,n.model.execute(t)}))).setToggleAction(!0),s.setSelectedCallback((function(){return n.foldingEnabled})),s.isEnabled=l,(s=this.addAction("scrollbars",(function(){e.setScrollbars(!e.hasScrollbars())}))).setToggleAction(!0),s.setSelectedCallback((function(){return n.scrollbars})),(s=this.addAction("pageView",mxUtils.bind(this,(function(){e.setPageVisible(!n.pageVisible)})))).setToggleAction(!0),s.setSelectedCallback((function(){return n.pageVisible})),(s=this.addAction("connectionArrows",(function(){n.connectionArrowsEnabled=!n.connectionArrowsEnabled,e.fireEvent(new mxEventObject("connectionArrowsChanged"))}),null,null,"Alt+Shift+A")).setToggleAction(!0),s.setSelectedCallback((function(){return n.connectionArrowsEnabled})),(s=this.addAction("connectionPoints",(function(){n.setConnectable(!n.connectionHandler.isEnabled()),e.fireEvent(new mxEventObject("connectionPointsChanged"))}),null,null,"Alt+Shift+P")).setToggleAction(!0),s.setSelectedCallback((function(){return n.connectionHandler.isEnabled()})),(s=this.addAction("copyConnect",(function(){n.connectionHandler.setCreateTarget(!n.connectionHandler.isCreateTarget()),e.fireEvent(new mxEventObject("copyConnectChanged"))}))).setToggleAction(!0),s.setSelectedCallback((function(){return n.connectionHandler.isCreateTarget()})),s.isEnabled=l,(s=this.addAction("autosave",(function(){e.editor.setAutosave(!e.editor.autosave)}))).setToggleAction(!0),s.setSelectedCallback((function(){return e.editor.autosave})),s.isEnabled=l,s.visible=!1,this.addAction("help",(function(){var e="";mxResources.isLanguageSupported(mxClient.language)&&(e="_"+mxClient.language),n.openLink(RESOURCES_PATH+"/help"+e+".html")}));var a=!1;this.put("about",new Action(mxResources.get("about")+" Graph Editor...",(function(){a||(e.showDialog(new AboutDialog(e).container,320,280,!0,!0,(function(){a=!1})),a=!0)})));var d=mxUtils.bind(this,(function(e,t,l,i){return this.addAction(e,(function(){if(null!=l&&n.cellEditor.isContentEditing())l();else{n.stopEditing(!1),n.getModel().beginUpdate();try{var e=n.getEditableCells(n.getSelectionCells());n.toggleCellStyleFlags(mxConstants.STYLE_FONTSTYLE,t,e),(t&mxConstants.FONT_BOLD)==mxConstants.FONT_BOLD?n.updateLabelElements(e,(function(e){e.style.fontWeight=null,"B"==e.nodeName&&n.replaceElement(e)})):(t&mxConstants.FONT_ITALIC)==mxConstants.FONT_ITALIC?n.updateLabelElements(e,(function(e){e.style.fontStyle=null,"I"==e.nodeName&&n.replaceElement(e)})):(t&mxConstants.FONT_UNDERLINE)==mxConstants.FONT_UNDERLINE&&n.updateLabelElements(e,(function(e){e.style.textDecoration=null,"U"==e.nodeName&&n.replaceElement(e)}));for(var i=0;i<e.length;i++)0==n.model.getChildCount(e[i])&&n.autoSizeCell(e[i],!1)}finally{n.getModel().endUpdate()}}}),null,null,i)}));d("bold",mxConstants.FONT_BOLD,(function(){document.execCommand("bold",!1,null)}),Editor.ctrlKey+"+B"),d("italic",mxConstants.FONT_ITALIC,(function(){document.execCommand("italic",!1,null)}),Editor.ctrlKey+"+I"),d("underline",mxConstants.FONT_UNDERLINE,(function(){document.execCommand("underline",!1,null)}),Editor.ctrlKey+"+U"),this.addAction("fontColor...",(function(){e.menus.pickColor(mxConstants.STYLE_FONTCOLOR,"forecolor","000000")})),this.addAction("strokeColor...",(function(){e.menus.pickColor(mxConstants.STYLE_STROKECOLOR)})),this.addAction("fillColor...",(function(){e.menus.pickColor(mxConstants.STYLE_FILLCOLOR)})),this.addAction("gradientColor...",(function(){e.menus.pickColor(mxConstants.STYLE_GRADIENTCOLOR)})),this.addAction("backgroundColor...",(function(){e.menus.pickColor(mxConstants.STYLE_LABEL_BACKGROUNDCOLOR,"backcolor")})),this.addAction("borderColor...",(function(){e.menus.pickColor(mxConstants.STYLE_LABEL_BORDERCOLOR)})),this.addAction("vertical",(function(){e.menus.toggleStyle(mxConstants.STYLE_HORIZONTAL,!0)})),this.addAction("shadow",(function(){e.menus.toggleStyle(mxConstants.STYLE_SHADOW)})),this.addAction("solid",(function(){n.getModel().beginUpdate();try{n.setCellStyles(mxConstants.STYLE_DASHED,null),n.setCellStyles(mxConstants.STYLE_DASH_PATTERN,null),e.fireEvent(new mxEventObject("styleChanged","keys",[mxConstants.STYLE_DASHED,mxConstants.STYLE_DASH_PATTERN],"values",[null,null],"cells",n.getSelectionCells()))}finally{n.getModel().endUpdate()}})),this.addAction("dashed",(function(){n.getModel().beginUpdate();try{n.setCellStyles(mxConstants.STYLE_DASHED,"1"),n.setCellStyles(mxConstants.STYLE_DASH_PATTERN,null),e.fireEvent(new mxEventObject("styleChanged","keys",[mxConstants.STYLE_DASHED,mxConstants.STYLE_DASH_PATTERN],"values",["1",null],"cells",n.getSelectionCells()))}finally{n.getModel().endUpdate()}})),this.addAction("dotted",(function(){n.getModel().beginUpdate();try{n.setCellStyles(mxConstants.STYLE_DASHED,"1"),n.setCellStyles(mxConstants.STYLE_DASH_PATTERN,"1 4"),e.fireEvent(new mxEventObject("styleChanged","keys",[mxConstants.STYLE_DASHED,mxConstants.STYLE_DASH_PATTERN],"values",["1","1 4"],"cells",n.getSelectionCells()))}finally{n.getModel().endUpdate()}})),this.addAction("sharp",(function(){n.getModel().beginUpdate();try{n.setCellStyles(mxConstants.STYLE_ROUNDED,"0"),n.setCellStyles(mxConstants.STYLE_CURVED,"0"),e.fireEvent(new mxEventObject("styleChanged","keys",[mxConstants.STYLE_ROUNDED,mxConstants.STYLE_CURVED],"values",["0","0"],"cells",n.getSelectionCells()))}finally{n.getModel().endUpdate()}})),this.addAction("rounded",(function(){n.getModel().beginUpdate();try{n.setCellStyles(mxConstants.STYLE_ROUNDED,"1"),n.setCellStyles(mxConstants.STYLE_CURVED,"0"),e.fireEvent(new mxEventObject("styleChanged","keys",[mxConstants.STYLE_ROUNDED,mxConstants.STYLE_CURVED],"values",["1","0"],"cells",n.getSelectionCells()))}finally{n.getModel().endUpdate()}})),this.addAction("toggleRounded",(function(){if(!n.isSelectionEmpty()&&n.isEnabled()){n.getModel().beginUpdate();try{var t=n.getSelectionCells(),l=n.getCurrentCellStyle(t[0]),i="1"==mxUtils.getValue(l,mxConstants.STYLE_ROUNDED,"0")?"0":"1";n.setCellStyles(mxConstants.STYLE_ROUNDED,i),n.setCellStyles(mxConstants.STYLE_CURVED,null),e.fireEvent(new mxEventObject("styleChanged","keys",[mxConstants.STYLE_ROUNDED,mxConstants.STYLE_CURVED],"values",[i,"0"],"cells",n.getSelectionCells()))}finally{n.getModel().endUpdate()}}})),this.addAction("curved",(function(){n.getModel().beginUpdate();try{n.setCellStyles(mxConstants.STYLE_ROUNDED,"0"),n.setCellStyles(mxConstants.STYLE_CURVED,"1"),e.fireEvent(new mxEventObject("styleChanged","keys",[mxConstants.STYLE_ROUNDED,mxConstants.STYLE_CURVED],"values",["0","1"],"cells",n.getSelectionCells()))}finally{n.getModel().endUpdate()}})),this.addAction("collapsible",(function(){var t=n.view.getState(n.getSelectionCell()),l="1";null!=t&&null!=n.getFoldingImage(t)&&(l="0"),n.setCellStyles("collapsible",l),e.fireEvent(new mxEventObject("styleChanged","keys",["collapsible"],"values",[l],"cells",n.getSelectionCells()))})),this.addAction("editStyle...",mxUtils.bind(this,(function(){var e=n.getEditableCells(n.getSelectionCells());if(null!=e&&e.length>0){var t=n.getModel(),l=new TextareaDialog(this.editorUi,mxResources.get("editStyle")+":",t.getStyle(e[0])||"",(function(t){null!=t&&n.setCellStyle(mxUtils.trim(t),e)}),null,null,400,220);this.editorUi.showDialog(l.container,420,300,!0,!0),l.init()}})),null,null,Editor.ctrlKey+"+E"),this.addAction("setAsDefaultStyle",(function(){n.isEnabled()&&!n.isSelectionEmpty()&&e.setDefaultStyle(n.getSelectionCell())}),null,null,Editor.ctrlKey+"+Shift+D"),this.addAction("clearDefaultStyle",(function(){n.isEnabled()&&e.clearDefaultStyle()}),null,null,Editor.ctrlKey+"+Shift+R"),this.addAction("addWaypoint",(function(){var e=n.getSelectionCell();if(null!=e&&n.getModel().isEdge(e)){var l=t.graph.selectionCellsHandler.getHandler(e);if(l instanceof mxEdgeHandler){for(var i=n.view.translate,o=n.view.scale,s=i.x,a=i.y,d=n.getModel().getParent(e),r=n.getCellGeometry(d);n.getModel().isVertex(d)&&null!=r;)s+=r.x,a+=r.y,d=n.getModel().getParent(d),r=n.getCellGeometry(d);var c=Math.round(n.snap(n.popupMenuHandler.triggerX/o-s)),u=Math.round(n.snap(n.popupMenuHandler.triggerY/o-a));l.addPointAt(l.state,c,u)}}})),this.addAction("removeWaypoint",(function(){var t=e.actions.get("removeWaypoint");null!=t.handler&&t.handler.removePoint(t.handler.state,t.index)})),this.addAction("clearWaypoints",(function(e,t){e=null!=t?t:e;var l=n.getSelectionCells();if(null!=l){l=n.getEditableCells(n.addAllEdges(l)),n.getModel().beginUpdate();try{for(var i=0;i<l.length;i++){var o=l[i];if(n.getModel().isEdge(o)){var s=n.getCellGeometry(o);null!=t&&mxEvent.isShiftDown(e)?(n.setCellStyles(mxConstants.STYLE_EXIT_X,null,[o]),n.setCellStyles(mxConstants.STYLE_EXIT_Y,null,[o]),n.setCellStyles(mxConstants.STYLE_ENTRY_X,null,[o]),n.setCellStyles(mxConstants.STYLE_ENTRY_Y,null,[o])):null!=s&&((s=s.clone()).points=null,s.x=0,s.y=0,s.offset=null,n.getModel().setGeometry(o,s))}}}finally{n.getModel().endUpdate()}}}),null,null,"Alt+Shift+C"),s=this.addAction("subscript",mxUtils.bind(this,(function(){n.cellEditor.isContentEditing()&&document.execCommand("subscript",!1,null)})),null,null,Editor.ctrlKey+"+,"),s=this.addAction("superscript",mxUtils.bind(this,(function(){n.cellEditor.isContentEditing()&&document.execCommand("superscript",!1,null)})),null,null,Editor.ctrlKey+"+."),this.addAction("image...",(function(){if(n.isEnabled()&&!n.isCellLocked(n.getDefaultParent())){var t=mxResources.get("image")+" ("+mxResources.get("url")+"):",l=n.getView().getState(n.getSelectionCell()),i="";null!=l&&(i=l.style[mxConstants.STYLE_IMAGE]||i);var o=n.cellEditor.saveSelection();e.showImageDialog(t,i,(function(e,t,l){if(n.cellEditor.isContentEditing())n.cellEditor.restoreSelection(o),n.insertImage(e,t,l);else{var i=n.getSelectionCells();if(null!=e&&(e.length>0||i.length>0)){var s=null;n.getModel().beginUpdate();try{if(0==i.length){i=[n.insertVertex(n.getDefaultParent(),null,"",0,0,t,l,"shape=image;imageAspect=0;aspect=fixed;verticalLabelPosition=bottom;verticalAlign=top;")];var a=n.getCenterInsertPoint(n.getBoundingBoxFromGeometry(i,!0));i[0].geometry.x=a.x,i[0].geometry.y=a.y,s=i,n.fireEvent(new mxEventObject("cellsInserted","cells",s))}n.setCellStyles(mxConstants.STYLE_IMAGE,e.length>0?e:null,i);var d=n.getCurrentCellStyle(i[0]);if("image"!=d[mxConstants.STYLE_SHAPE]&&"label"!=d[mxConstants.STYLE_SHAPE]?n.setCellStyles(mxConstants.STYLE_SHAPE,"image",i):0==e.length&&n.setCellStyles(mxConstants.STYLE_SHAPE,null,i),1==n.getSelectionCount()&&null!=t&&null!=l){var r=i[0],c=n.getModel().getGeometry(r);null!=c&&((c=c.clone()).width=t,c.height=l,n.getModel().setGeometry(r,c))}}finally{n.getModel().endUpdate()}null!=s&&(n.setSelectionCells(s),n.scrollCellToVisible(s[0]))}}}),n.cellEditor.isContentEditing(),!n.cellEditor.isContentEditing())}})).isEnabled=l,(s=this.addAction("layers",mxUtils.bind(this,(function(){null==this.layersWindow?(this.layersWindow=new LayersWindow(e,document.body.offsetWidth-280,120,212,200),this.layersWindow.window.addListener("show",mxUtils.bind(this,(function(){e.fireEvent(new mxEventObject("layers")),this.layersWindow.window.fit()}))),this.layersWindow.window.addListener("hide",(function(){e.fireEvent(new mxEventObject("layers"))})),this.layersWindow.window.setVisible(!0),e.fireEvent(new mxEventObject("layers")),this.layersWindow.init()):this.layersWindow.window.setVisible(!this.layersWindow.window.isVisible())})),null,null,Editor.ctrlKey+"+Shift+L")).setToggleAction(!0),s.setSelectedCallback(mxUtils.bind(this,(function(){return null!=this.layersWindow&&this.layersWindow.window.isVisible()}))),(s=this.addAction("formatPanel",mxUtils.bind(this,(function(){e.toggleFormatPanel()})),null,null,Editor.ctrlKey+"+Shift+P")).setToggleAction(!0),s.setSelectedCallback(mxUtils.bind(this,(function(){return e.formatWidth>0}))),(s=this.addAction("outline",mxUtils.bind(this,(function(){null==this.outlineWindow?(this.outlineWindow=new OutlineWindow(e,e.container.offsetWidth-260,100,180,180),this.outlineWindow.window.addListener("show",mxUtils.bind(this,(function(){e.fireEvent(new mxEventObject("outline")),this.outlineWindow.window.fit()}))),this.outlineWindow.window.addListener("hide",(function(){e.fireEvent(new mxEventObject("outline"))})),this.outlineWindow.window.setVisible(!0),e.fireEvent(new mxEventObject("outline"))):this.outlineWindow.window.setVisible(!this.outlineWindow.window.isVisible())})),null,null,Editor.ctrlKey+"+Shift+O")).setToggleAction(!0),s.setSelectedCallback(mxUtils.bind(this,(function(){return null!=this.outlineWindow&&this.outlineWindow.window.isVisible()})))},Actions.prototype.addAction=function(e,t,n,l,i){var o;return"..."==e.substring(e.length-3)?(e=e.substring(0,e.length-3),o=mxResources.get(e)+"..."):o=mxResources.get(e),this.put(e,new Action(o,t,n,l,i))},Actions.prototype.put=function(e,t){return this.actions[e]=t,t},Actions.prototype.get=function(e){return this.actions[e]},mxUtils.extend(Action,mxEventSource),Action.prototype.createFunction=function(e){return e},Action.prototype.setEnabled=function(e){this.enabled!=e&&(this.enabled=e,this.fireEvent(new mxEventObject("stateChanged")))},Action.prototype.isEnabled=function(){return this.enabled},Action.prototype.setToggleAction=function(e){this.toggleAction=e},Action.prototype.setSelectedCallback=function(e){this.selectedCallback=e},Action.prototype.isSelected=function(){return this.selectedCallback()};