function Menubar(e,t){this.editorUi=e,this.container=t}function Menu(e,t){mxEventSource.call(this),this.funct=e,this.enabled=null==t||t}Menus=function(e){this.editorUi=e,this.menus=new Object,this.init(),mxClient.IS_SVG||((new Image).src=this.checkmarkImage)},Menus.prototype.defaultFont="Helvetica",Menus.prototype.defaultFontSize="12",Menus.prototype.defaultMenuItems=["file","edit","view","arrange","extras","help"],Menus.prototype.defaultFonts=["Helvetica","Verdana","Times New Roman","Garamond","Comic Sans MS","Courier New","Georgia","Lucida Console","Tahoma"],Menus.prototype.init=function(){var e=this.editorUi,t=e.editor.graph,n=mxUtils.bind(t,t.isEnabled);this.customFonts=[],this.customFontSizes=[],this.put("fontFamily",new Menu(mxUtils.bind(this,(function(n,i){for(var l=mxUtils.bind(this,(function(l){this.styleChange(n,l,[mxConstants.STYLE_FONTFAMILY],[l],null,i,(function(){document.execCommand("fontname",!1,l),e.fireEvent(new mxEventObject("styleChanged","keys",[mxConstants.STYLE_FONTFAMILY],"values",[l],"cells",[t.cellEditor.getEditingCell()]))}),(function(){t.updateLabelElements(t.getSelectionCells(),(function(e){e.removeAttribute("face"),e.style.fontFamily=null,"PRE"==e.nodeName&&t.replaceElement(e,"div")}))})).firstChild.nextSibling.style.fontFamily=l})),s=0;s<this.defaultFonts.length;s++)l(this.defaultFonts[s]);if(n.addSeparator(i),this.customFonts.length>0){for(s=0;s<this.customFonts.length;s++)l(this.customFonts[s]);n.addSeparator(i),n.addItem(mxResources.get("reset"),null,mxUtils.bind(this,(function(){this.customFonts=[],this.editorUi.fireEvent(new mxEventObject("customFontsChanged"))})),i),n.addSeparator(i)}this.promptChange(n,mxResources.get("custom")+"...","",mxConstants.DEFAULT_FONTFAMILY,mxConstants.STYLE_FONTFAMILY,i,!0,mxUtils.bind(this,(function(e){mxUtils.indexOf(this.customFonts,e)<0&&(this.customFonts.push(e),this.editorUi.fireEvent(new mxEventObject("customFontsChanged")))})))})))),this.put("formatBlock",new Menu(mxUtils.bind(this,(function(e,n){function i(i,l){return e.addItem(i,null,mxUtils.bind(this,(function(){null!=t.cellEditor.textarea&&(t.cellEditor.textarea.focus(),document.execCommand("formatBlock",!1,"<"+l+">"))})),n)}i(mxResources.get("normal"),"p"),i("","h1").firstChild.nextSibling.innerHTML='<h1 style="margin:0px;">'+mxResources.get("heading")+" 1</h1>",i("","h2").firstChild.nextSibling.innerHTML='<h2 style="margin:0px;">'+mxResources.get("heading")+" 2</h2>",i("","h3").firstChild.nextSibling.innerHTML='<h3 style="margin:0px;">'+mxResources.get("heading")+" 3</h3>",i("","h4").firstChild.nextSibling.innerHTML='<h4 style="margin:0px;">'+mxResources.get("heading")+" 4</h4>",i("","h5").firstChild.nextSibling.innerHTML='<h5 style="margin:0px;">'+mxResources.get("heading")+" 5</h5>",i("","h6").firstChild.nextSibling.innerHTML='<h6 style="margin:0px;">'+mxResources.get("heading")+" 6</h6>",i("","pre").firstChild.nextSibling.innerHTML='<pre style="margin:0px;">'+mxResources.get("formatted")+"</pre>",i("","blockquote").firstChild.nextSibling.innerHTML='<blockquote style="margin-top:0px;margin-bottom:0px;">'+mxResources.get("blockquote")+"</blockquote>"})))),this.put("fontSize",new Menu(mxUtils.bind(this,(function(n,i){var l=[6,8,9,10,11,12,14,18,24,36,48,72];mxUtils.indexOf(l,this.defaultFontSize)<0&&(l.push(this.defaultFontSize),l.sort((function(e,t){return e-t})));for(var s=mxUtils.bind(this,(function(n){if(null!=t.cellEditor.textarea){document.execCommand("fontSize",!1,"3");for(var i=t.cellEditor.textarea.getElementsByTagName("font"),l=0;l<i.length;l++)if("3"==i[l].getAttribute("size")){i[l].removeAttribute("size"),i[l].style.fontSize=n+"px";break}e.fireEvent(new mxEventObject("styleChanged","keys",[mxConstants.STYLE_FONTSIZE],"values",[n],"cells",[t.cellEditor.getEditingCell()]))}})),o=mxUtils.bind(this,(function(e){this.styleChange(n,e,[mxConstants.STYLE_FONTSIZE],[e],null,i,(function(){s(e)}))})),r=0;r<l.length;r++)o(l[r]);if(n.addSeparator(i),this.customFontSizes.length>0){var u=0;for(r=0;r<this.customFontSizes.length;r++)mxUtils.indexOf(l,this.customFontSizes[r])<0&&(o(this.customFontSizes[r]),u++);u>0&&n.addSeparator(i),n.addItem(mxResources.get("reset"),null,mxUtils.bind(this,(function(){this.customFontSizes=[]})),i),n.addSeparator(i)}var a=null;this.promptChange(n,mxResources.get("custom")+"...","("+mxResources.get("points")+")",this.defaultFontSize,mxConstants.STYLE_FONTSIZE,i,!0,mxUtils.bind(this,(function(e){null!=a&&null!=t.cellEditor.textarea&&(t.cellEditor.textarea.focus(),t.cellEditor.restoreSelection(a)),null!=e&&e.length>0&&(this.customFontSizes.push(e),s(e))})),null,(function(){return a=t.cellEditor.saveSelection(),!1}))})))),this.put("direction",new Menu(mxUtils.bind(this,(function(e,n){e.addItem(mxResources.get("flipH"),null,(function(){t.toggleCellStyles(mxConstants.STYLE_FLIPH,!1)}),n),e.addItem(mxResources.get("flipV"),null,(function(){t.toggleCellStyles(mxConstants.STYLE_FLIPV,!1)}),n),this.addMenuItems(e,["-","rotation"],n)})))),this.put("align",new Menu(mxUtils.bind(this,(function(e,n){e.addItem(mxResources.get("leftAlign"),null,(function(){t.alignCells(mxConstants.ALIGN_LEFT)}),n),e.addItem(mxResources.get("center"),null,(function(){t.alignCells(mxConstants.ALIGN_CENTER)}),n),e.addItem(mxResources.get("rightAlign"),null,(function(){t.alignCells(mxConstants.ALIGN_RIGHT)}),n),e.addSeparator(n),e.addItem(mxResources.get("topAlign"),null,(function(){t.alignCells(mxConstants.ALIGN_TOP)}),n),e.addItem(mxResources.get("middle"),null,(function(){t.alignCells(mxConstants.ALIGN_MIDDLE)}),n),e.addItem(mxResources.get("bottomAlign"),null,(function(){t.alignCells(mxConstants.ALIGN_BOTTOM)}),n)})))),this.put("distribute",new Menu(mxUtils.bind(this,(function(e,n){e.addItem(mxResources.get("horizontal"),null,(function(){t.distributeCells(!0)}),n),e.addItem(mxResources.get("vertical"),null,(function(){t.distributeCells(!1)}),n)})))),this.put("line",new Menu(mxUtils.bind(this,(function(e,n){var i=t.view.getState(t.getSelectionCell());if(null!=i){var l=mxUtils.getValue(i.style,mxConstants.STYLE_SHAPE);"arrow"!=l&&(this.edgeStyleChange(e,"",[mxConstants.STYLE_EDGE,mxConstants.STYLE_CURVED,mxConstants.STYLE_NOEDGESTYLE],[null,null,null],"geIcon geSprite geSprite-straight",n,!0).setAttribute("title",mxResources.get("straight")),this.edgeStyleChange(e,"",[mxConstants.STYLE_EDGE,mxConstants.STYLE_CURVED,mxConstants.STYLE_NOEDGESTYLE],["orthogonalEdgeStyle",null,null],"geIcon geSprite geSprite-orthogonal",n,!0).setAttribute("title",mxResources.get("orthogonal")),this.edgeStyleChange(e,"",[mxConstants.STYLE_EDGE,mxConstants.STYLE_ELBOW,mxConstants.STYLE_CURVED,mxConstants.STYLE_NOEDGESTYLE],["elbowEdgeStyle",null,null,null],"geIcon geSprite geSprite-horizontalelbow",n,!0).setAttribute("title",mxResources.get("simple")),this.edgeStyleChange(e,"",[mxConstants.STYLE_EDGE,mxConstants.STYLE_ELBOW,mxConstants.STYLE_CURVED,mxConstants.STYLE_NOEDGESTYLE],["elbowEdgeStyle","vertical",null,null],"geIcon geSprite geSprite-verticalelbow",n,!0).setAttribute("title",mxResources.get("simple")),this.edgeStyleChange(e,"",[mxConstants.STYLE_EDGE,mxConstants.STYLE_ELBOW,mxConstants.STYLE_CURVED,mxConstants.STYLE_NOEDGESTYLE],["isometricEdgeStyle",null,null,null],"geIcon geSprite geSprite-horizontalisometric",n,!0).setAttribute("title",mxResources.get("isometric")),this.edgeStyleChange(e,"",[mxConstants.STYLE_EDGE,mxConstants.STYLE_ELBOW,mxConstants.STYLE_CURVED,mxConstants.STYLE_NOEDGESTYLE],["isometricEdgeStyle","vertical",null,null],"geIcon geSprite geSprite-verticalisometric",n,!0).setAttribute("title",mxResources.get("isometric")),"connector"==l&&this.edgeStyleChange(e,"",[mxConstants.STYLE_EDGE,mxConstants.STYLE_CURVED,mxConstants.STYLE_NOEDGESTYLE],["orthogonalEdgeStyle","1",null],"geIcon geSprite geSprite-curved",n,!0).setAttribute("title",mxResources.get("curved")),this.edgeStyleChange(e,"",[mxConstants.STYLE_EDGE,mxConstants.STYLE_CURVED,mxConstants.STYLE_NOEDGESTYLE],["entityRelationEdgeStyle",null,null],"geIcon geSprite geSprite-entity",n,!0).setAttribute("title",mxResources.get("entityRelation"))),e.addSeparator(n),this.styleChange(e,"",[mxConstants.STYLE_SHAPE,mxConstants.STYLE_STARTSIZE,mxConstants.STYLE_ENDSIZE,"width"],[null,null,null,null],"geIcon geSprite geSprite-connection",n,!0,null,!0).setAttribute("title",mxResources.get("line")),this.styleChange(e,"",[mxConstants.STYLE_SHAPE,mxConstants.STYLE_STARTSIZE,mxConstants.STYLE_ENDSIZE,"width"],["link",null,null,null],"geIcon geSprite geSprite-linkedge",n,!0,null,!0).setAttribute("title",mxResources.get("link")),this.styleChange(e,"",[mxConstants.STYLE_SHAPE,mxConstants.STYLE_STARTSIZE,mxConstants.STYLE_ENDSIZE,"width"],["flexArrow",null,null,null],"geIcon geSprite geSprite-arrow",n,!0,null,!0).setAttribute("title",mxResources.get("arrow")),this.styleChange(e,"",[mxConstants.STYLE_SHAPE,mxConstants.STYLE_STARTSIZE,mxConstants.STYLE_ENDSIZE,"width"],["arrow",null,null,null],"geIcon geSprite geSprite-simplearrow",n,!0,null,!0).setAttribute("title",mxResources.get("simpleArrow"))}})))),this.put("layout",new Menu(mxUtils.bind(this,(function(e,n){var i=mxUtils.bind(this,(function(e,t){var n=new FilenameDialog(this.editorUi,e,mxResources.get("apply"),(function(e){t(parseFloat(e))}),mxResources.get("spacing"));this.editorUi.showDialog(n.container,300,80,!0,!0),n.init()}));e.addItem(mxResources.get("horizontalFlow"),null,mxUtils.bind(this,(function(){var e=new mxHierarchicalLayout(t,mxConstants.DIRECTION_WEST);this.editorUi.executeLayout((function(){var n=t.getSelectionCells();e.execute(t.getDefaultParent(),0==n.length?null:n)}),!0)})),n),e.addItem(mxResources.get("verticalFlow"),null,mxUtils.bind(this,(function(){var e=new mxHierarchicalLayout(t,mxConstants.DIRECTION_NORTH);this.editorUi.executeLayout((function(){var n=t.getSelectionCells();e.execute(t.getDefaultParent(),0==n.length?null:n)}),!0)})),n),e.addSeparator(n),e.addItem(mxResources.get("horizontalTree"),null,mxUtils.bind(this,(function(){var e=t.getSelectionCell(),n=null;if(null==e||0==t.getModel().getChildCount(e)?0==t.getModel().getEdgeCount(e)&&(n=t.findTreeRoots(t.getDefaultParent())):n=t.findTreeRoots(e),null!=n&&n.length>0&&(e=n[0]),null!=e){var l=new mxCompactTreeLayout(t,!0);l.edgeRouting=!1,l.levelDistance=30,i(l.levelDistance,mxUtils.bind(this,(function(n){l.levelDistance=n,this.editorUi.executeLayout((function(){l.execute(t.getDefaultParent(),e)}),!0)})))}})),n),e.addItem(mxResources.get("verticalTree"),null,mxUtils.bind(this,(function(){var e=t.getSelectionCell(),n=null;if(null==e||0==t.getModel().getChildCount(e)?0==t.getModel().getEdgeCount(e)&&(n=t.findTreeRoots(t.getDefaultParent())):n=t.findTreeRoots(e),null!=n&&n.length>0&&(e=n[0]),null!=e){var l=new mxCompactTreeLayout(t,!1);l.edgeRouting=!1,l.levelDistance=30,i(l.levelDistance,mxUtils.bind(this,(function(n){l.levelDistance=n,this.editorUi.executeLayout((function(){l.execute(t.getDefaultParent(),e)}),!0)})))}})),n),e.addItem(mxResources.get("radialTree"),null,mxUtils.bind(this,(function(){var e=t.getSelectionCell(),n=null;if(null==e||0==t.getModel().getChildCount(e)?0==t.getModel().getEdgeCount(e)&&(n=t.findTreeRoots(t.getDefaultParent())):n=t.findTreeRoots(e),null!=n&&n.length>0&&(e=n[0]),null!=e){var l=new mxRadialTreeLayout(t,!1);l.levelDistance=80,l.autoRadius=!0,i(l.levelDistance,mxUtils.bind(this,(function(n){l.levelDistance=n,this.editorUi.executeLayout((function(){l.execute(t.getDefaultParent(),e),t.isSelectionEmpty()||(e=t.getModel().getParent(e),t.getModel().isVertex(e)&&t.updateGroupBounds([e],2*t.gridSize,!0))}),!0)})))}})),n),e.addSeparator(n),e.addItem(mxResources.get("organic"),null,mxUtils.bind(this,(function(){var e=new mxFastOrganicLayout(t);i(e.forceConstant,mxUtils.bind(this,(function(n){e.forceConstant=n,this.editorUi.executeLayout((function(){var n=t.getSelectionCell();null!=n&&0!=t.getModel().getChildCount(n)||(n=t.getDefaultParent()),e.execute(n),t.getModel().isVertex(n)&&t.updateGroupBounds([n],2*t.gridSize,!0)}),!0)})))})),n),e.addItem(mxResources.get("circle"),null,mxUtils.bind(this,(function(){var e=new mxCircleLayout(t);this.editorUi.executeLayout((function(){var n=t.getSelectionCell();null!=n&&0!=t.getModel().getChildCount(n)||(n=t.getDefaultParent()),e.execute(n),t.getModel().isVertex(n)&&t.updateGroupBounds([n],2*t.gridSize,!0)}),!0)})),n)})))),this.put("navigation",new Menu(mxUtils.bind(this,(function(e,t){this.addMenuItems(e,["home","-","exitGroup","enterGroup","-","expand","collapse","-","collapsible"],t)})))),this.put("arrange",new Menu(mxUtils.bind(this,(function(e,t){this.addMenuItems(e,["toFront","toBack","bringForward","sendBackward","-"],t),this.addSubmenu("direction",e,t),this.addMenuItems(e,["turn","-"],t),this.addSubmenu("align",e,t),this.addSubmenu("distribute",e,t),e.addSeparator(t),this.addSubmenu("navigation",e,t),this.addSubmenu("insert",e,t),this.addSubmenu("layout",e,t),this.addMenuItems(e,["-","group","ungroup","removeFromGroup","-","clearWaypoints","autosize"],t)})))).isEnabled=n,this.put("insert",new Menu(mxUtils.bind(this,(function(e,t){this.addMenuItems(e,["insertLink","insertImage"],t)})))),this.put("view",new Menu(mxUtils.bind(this,(function(e,t){this.addMenuItems(e,(null!=this.editorUi.format?["formatPanel"]:[]).concat(["outline","layers","-","pageView","pageScale","-","scrollbars","tooltips","-","grid","guides","-","connectionArrows","connectionPoints","-","resetView","zoomIn","zoomOut"],t))})))),this.put("viewPanels",new Menu(mxUtils.bind(this,(function(e,t){null!=this.editorUi.format&&this.addMenuItems(e,["formatPanel"],t),this.addMenuItems(e,["outline","layers"],t)})))),this.put("viewZoom",new Menu(mxUtils.bind(this,(function(e,n){this.addMenuItems(e,["resetView","-"],n);for(var i=[.25,.5,.75,1,1.25,1.5,2,3,4],l=0;l<i.length;l++)!function(i){e.addItem(100*i+"%",null,(function(){t.zoomTo(i)}),n)}(i[l]);this.addMenuItems(e,["-","fitWindow","fitPageWidth","fitPage","fitTwoPages","-","customZoom"],n)})))),this.put("file",new Menu(mxUtils.bind(this,(function(e,t){this.addMenuItems(e,["new","open","-","save","saveAs","-","import","export","-","pageSetup","print"],t)})))),this.put("edit",new Menu(mxUtils.bind(this,(function(e,t){this.addMenuItems(e,["undo","redo","-","cut","copy","paste","delete","-","duplicate","-","editData","editTooltip","-","editStyle","-","edit","-","editLink","openLink","-","selectVertices","selectEdges","selectAll","selectNone","-","lockUnlock"])})))),this.put("extras",new Menu(mxUtils.bind(this,(function(e,t){this.addMenuItems(e,["copyConnect","collapseExpand","-","editDiagram"])})))),this.put("help",new Menu(mxUtils.bind(this,(function(e,t){this.addMenuItems(e,["help","-","about"])}))))},Menus.prototype.put=function(e,t){return this.menus[e]=t,t},Menus.prototype.get=function(e){return this.menus[e]},Menus.prototype.addSubmenu=function(e,t,n,i){var l=this.get(e);if(null!=l){var s=l.isEnabled();if(t.showDisabled||s){var o=t.addItem(i||mxResources.get(e),null,null,n,null,s);this.addMenu(e,t,o)}}},Menus.prototype.addMenu=function(e,t,n){var i=this.get(e);null!=i&&(t.showDisabled||i.isEnabled())&&this.get(e).execute(t,n)},Menus.prototype.addInsertTableCellItem=function(e,t){var n=this.editorUi.editor.graph,i=n.getSelectionCell(),l=n.getCurrentCellStyle(i),s=n.isTable(i)||n.isTableRow(i)||n.isTableCell(i),o=n.isStack(i)||n.isStackChild(i),r=s,u=s;if(o&&(r=!(u="0"==(l=n.isStack(i)?l:n.getCellStyle(n.model.getParent(i))).horizontalStack)),null!=t||!s&&!o)this.addInsertTableItem(e,mxUtils.bind(this,(function(e,t,i,l,s){var o=s||mxEvent.isControlDown(e)||mxEvent.isMetaDown(e)?n.createCrossFunctionalSwimlane(t,i,null,null,l||mxEvent.isShiftDown(e)?"Cross-Functional Flowchart":null):n.createTable(t,i,null,null,l||mxEvent.isShiftDown(e)?"Table":null),r=mxEvent.isAltDown(e)?n.getFreeInsertPoint():n.getCenterInsertPoint(n.getBoundingBoxFromGeometry([o],!0)),u=null;n.getModel().beginUpdate();try{u=n.importCells([o],r.x,r.y),n.fireEvent(new mxEventObject("cellsInserted","cells",n.model.getDescendants(u[0])))}finally{n.getModel().endUpdate()}null!=u&&u.length>0&&(n.scrollCellToVisible(u[0]),n.setSelectionCells(u))})),t);else{if(r){var a=e.addItem(mxResources.get("insertColumnBefore"),null,mxUtils.bind(this,(function(){try{o?n.insertLane(i,!0):n.insertTableColumn(i,!0)}catch(e){this.editorUi.handleError(e)}})),null,"geIcon geSprite geSprite-insertcolumnbefore");a.setAttribute("title",mxResources.get("insertColumnBefore")),(a=e.addItem(mxResources.get("insertColumnAfter"),null,mxUtils.bind(this,(function(){try{o?n.insertLane(i,!1):n.insertTableColumn(i,!1)}catch(e){this.editorUi.handleError(e)}})),null,"geIcon geSprite geSprite-insertcolumnafter")).setAttribute("title",mxResources.get("insertColumnAfter")),(a=e.addItem(mxResources.get("deleteColumn"),null,mxUtils.bind(this,(function(){if(null!=i)try{o?n.deleteLane(i):n.deleteTableColumn(i)}catch(e){this.editorUi.handleError(e)}})),null,"geIcon geSprite geSprite-deletecolumn")).setAttribute("title",mxResources.get("deleteColumn"))}u&&((a=e.addItem(mxResources.get("insertRowBefore"),null,mxUtils.bind(this,(function(){try{o?n.insertLane(i,!0):n.insertTableRow(i,!0)}catch(e){this.editorUi.handleError(e)}})),null,"geIcon geSprite geSprite-insertrowbefore")).setAttribute("title",mxResources.get("insertRowBefore")),(a=e.addItem(mxResources.get("insertRowAfter"),null,mxUtils.bind(this,(function(){try{o?n.insertLane(i,!1):n.insertTableRow(i,!1)}catch(e){this.editorUi.handleError(e)}})),null,"geIcon geSprite geSprite-insertrowafter")).setAttribute("title",mxResources.get("insertRowAfter")),(a=e.addItem(mxResources.get("deleteRow"),null,mxUtils.bind(this,(function(){try{o?n.deleteLane(i):n.deleteTableRow(i)}catch(e){this.editorUi.handleError(e)}})),null,"geIcon geSprite geSprite-deleterow")).setAttribute("title",mxResources.get("deleteRow")))}},Menus.prototype.addInsertTableItem=function(e,t,n,i){i=null==i||i,t=null!=t?t:mxUtils.bind(this,(function(e,t,n){var i=this.editorUi.editor.graph,l=i.getParentByName(mxEvent.getSource(e),"TD");if(null!=l&&null!=i.cellEditor.textarea){i.getParentByName(l,"TR");for(var s=i.cellEditor.textarea.getElementsByTagName("table"),o=[],r=0;r<s.length;r++)o.push(s[r]);i.container.focus(),i.pasteHtmlAtCaret(function(e,t){for(var n=["<table>"],i=0;i<e;i++){n.push("<tr>");for(var l=0;l<t;l++)n.push("<td><br></td>");n.push("</tr>")}return n.push("</table>"),n.join("")}(t,n));var u=i.cellEditor.textarea.getElementsByTagName("table");if(u.length==o.length+1)for(r=u.length-1;r>=0;r--)if(0==r||u[r]!=o[r-1]){i.selectNode(u[r].rows[0].cells[0]);break}}}));var l=this.editorUi.editor.graph,s=null,o=null;null==n&&(e.div.className+=" geToolbarMenu",e.labels=!1);var r=e.addItem("",null,null,n,null,null,null,!0);r.firstChild.style.fontSize=Menus.prototype.defaultFontSize+"px",r.firstChild.innerHTML="";var u=document.createElement("input");u.setAttribute("id","geTitleOption"),u.setAttribute("type","checkbox");var a=document.createElement("label");mxUtils.write(a,mxResources.get("title")),a.setAttribute("for","geTitleOption"),mxEvent.addGestureListeners(a,null,null,mxUtils.bind(this,(function(e){mxEvent.consume(e)}))),mxEvent.addGestureListeners(u,null,null,mxUtils.bind(this,(function(e){mxEvent.consume(e)})));var d=document.createElement("input");d.setAttribute("id","geContainerOption"),d.setAttribute("type","checkbox");var c=document.createElement("label");mxUtils.write(c,mxResources.get("container")),c.setAttribute("for","geContainerOption"),mxEvent.addGestureListeners(c,null,null,mxUtils.bind(this,(function(e){mxEvent.consume(e)}))),mxEvent.addGestureListeners(d,null,null,mxUtils.bind(this,(function(e){mxEvent.consume(e)}))),i&&(r.firstChild.appendChild(u),r.firstChild.appendChild(a),mxUtils.br(r.firstChild),r.firstChild.appendChild(d),r.firstChild.appendChild(c),mxUtils.br(r.firstChild),mxUtils.br(r.firstChild));var m=function(e,t){var n=document.createElement("table");n.setAttribute("border","1"),n.style.borderCollapse="collapse",n.style.borderStyle="solid",n.setAttribute("cellPadding","8");for(var i=0;i<5;i++)for(var l=n.insertRow(i),s=0;s<5;s++)l.insertCell(-1);return n}();r.firstChild.appendChild(m);var g=document.createElement("div");function h(e){var t=!1;if(null!=(o=l.getParentByName(mxEvent.getSource(e),"TD"))){s=l.getParentByName(o,"TR");var n=mxEvent.isMouseEvent(e)?2:4;!function(e,t,n){for(var i=e.rows.length;i<t;i++)for(var l=e.insertRow(i),s=0;s<e.rows[0].cells.length;s++)l.insertCell(-1);for(i=0;i<e.rows.length;i++)for(s=(l=e.rows[i]).cells.length;s<n;s++)l.insertCell(-1)}(m,Math.min(20,s.sectionRowIndex+n),Math.min(20,o.cellIndex+n)),g.innerHTML=o.cellIndex+1+"x"+(s.sectionRowIndex+1);for(var i=0;i<m.rows.length;i++)for(var r=m.rows[i],u=0;u<r.cells.length;u++){var a=r.cells[u];i==s.sectionRowIndex&&u==o.cellIndex&&(t="blue"==a.style.backgroundColor),i<=s.sectionRowIndex&&u<=o.cellIndex?a.style.backgroundColor="blue":a.style.backgroundColor="transparent"}}return mxEvent.consume(e),t}g.style.padding="4px",g.innerHTML="1x1",r.firstChild.appendChild(g),mxEvent.addGestureListeners(m,null,null,mxUtils.bind(this,(function(e){var n=h(e);null!=o&&null!=s&&n&&(t(e,s.sectionRowIndex+1,o.cellIndex+1,u.checked,d.checked),window.setTimeout(mxUtils.bind(this,(function(){this.editorUi.hideCurrentMenu()})),0))}))),mxEvent.addListener(m,"mouseover",h)},Menus.prototype.edgeStyleChange=function(e,t,n,i,l,s,o,r){return this.showIconOnly(e.addItem(t,r,mxUtils.bind(this,(function(){var e=this.editorUi.editor.graph;e.stopEditing(!1),e.getModel().beginUpdate();try{for(var t=e.getSelectionCells(),l=[],s=0;s<t.length;s++){var r=t[s];if(e.getModel().isEdge(r)){if(o){var u=e.getCellGeometry(r);null!=u&&((u=u.clone()).points=null,e.getModel().setGeometry(r,u))}for(var a=0;a<n.length;a++)e.setCellStyles(n[a],i[a],[r]);l.push(r)}}this.editorUi.fireEvent(new mxEventObject("styleChanged","keys",n,"values",i,"cells",l))}finally{e.getModel().endUpdate()}})),s,l))},Menus.prototype.showIconOnly=function(e){var t=e.getElementsByTagName("td");for(i=0;i<t.length;i++)"mxPopupMenuItem"==t[i].getAttribute("class")&&(t[i].style.display="none");return e},Menus.prototype.styleChange=function(e,t,n,i,l,s,o,r,u){var a=this.createStyleChangeFunction(n,i),d=e.addItem(t,null,mxUtils.bind(this,(function(){var e=this.editorUi.editor.graph;null!=o&&e.cellEditor.isContentEditing()?o():a(r)})),s,l);return u&&this.showIconOnly(d),d},Menus.prototype.createStyleChangeFunction=function(e,t){return mxUtils.bind(this,(function(n){var i=this.editorUi.editor.graph;i.stopEditing(!1),i.getModel().beginUpdate();try{for(var l=i.getEditableCells(i.getSelectionCells()),s=!1,o=0;o<e.length;o++)i.setCellStyles(e[o],t[o],l),e[o]==mxConstants.STYLE_ALIGN&&i.updateLabelElements(l,(function(e){e.removeAttribute("align"),e.style.textAlign=null})),e[o]!=mxConstants.STYLE_FONTFAMILY&&"fontSource"!=e[o]||(s=!0);if(s)for(var r=0;r<l.length;r++)0==i.model.getChildCount(l[r])&&i.autoSizeCell(l[r],!1);null!=n&&n(),this.editorUi.fireEvent(new mxEventObject("styleChanged","keys",e,"values",t,"cells",l))}finally{i.getModel().endUpdate()}}))},Menus.prototype.promptChange=function(e,t,n,i,l,s,o,r,u,a){return e.addItem(t,null,mxUtils.bind(this,(function(){var e=this.editorUi.editor.graph,t=i,s=e.getView().getState(e.getSelectionCell());null!=s&&(t=s.style[l]||t);var o=null==a||a(),u=new FilenameDialog(this.editorUi,t,mxResources.get("apply"),mxUtils.bind(this,(function(t){if(null!=t&&t.length>0){if(o){e.getModel().beginUpdate();try{e.stopEditing(!1),e.setCellStyles(l,t)}finally{e.getModel().endUpdate()}}null!=r&&r(t)}})),mxResources.get("enterValue")+(n.length>0?" "+n:""),null,null,null,null,(function(){null!=r&&null!=a&&r(null)}));this.editorUi.showDialog(u.container,300,80,!0,!0),u.init()})),s,u,o)},Menus.prototype.pickColor=function(e,t,n){var i=this.editorUi,l=i.editor.graph,s=226+17*(Math.ceil(ColorDialog.prototype.presetColors.length/12)+Math.ceil(ColorDialog.prototype.defaultColors.length/12));if(null!=t&&l.cellEditor.isContentEditing()){var o=l.cellEditor.saveSelection(),r=new ColorDialog(this.editorUi,n||l.shapeForegroundColor,mxUtils.bind(this,(function(e){l.cellEditor.restoreSelection(o),document.execCommand(t,!1,e!=mxConstants.NONE?e:"transparent");var n={forecolor:mxConstants.STYLE_FONTCOLOR,backcolor:mxConstants.STYLE_LABEL_BACKGROUNDCOLOR}[t];null!=n&&i.fireEvent(new mxEventObject("styleChanged","keys",[n],"values",[e],"cells",[l.cellEditor.getEditingCell()]))})),(function(){l.cellEditor.restoreSelection(o)}));this.editorUi.showDialog(r.container,230,s,!0,!0),r.init()}else{null==this.colorDialog&&(this.colorDialog=new ColorDialog(this.editorUi)),this.colorDialog.currentColorKey=e;var u=l.getView().getState(l.getSelectionCell()),a=mxConstants.NONE;null!=u&&(a=u.style[e]||a),a==mxConstants.NONE?(a=l.shapeBackgroundColor.substring(1),this.colorDialog.picker.fromString(a),this.colorDialog.colorInput.value=mxConstants.NONE):this.colorDialog.picker.fromString(mxUtils.rgba2hex(a)),this.editorUi.showDialog(this.colorDialog.container,230,s,!0,!0),this.colorDialog.init()}},Menus.prototype.toggleStyle=function(e,t){var n=this.editorUi.editor.graph,i=n.toggleCellStyles(e,t);this.editorUi.fireEvent(new mxEventObject("styleChanged","keys",[e],"values",[i],"cells",n.getSelectionCells()))},Menus.prototype.addMenuItem=function(e,t,n,i,l,s){var o=this.editorUi.actions.get(t);if(null!=o&&(e.showDisabled||o.isEnabled())&&o.visible){var r=e.addItem(s||o.label,null,(function(e){o.funct(i,e)}),n,l,o.isEnabled());return o.toggleAction&&o.isSelected()&&e.addCheckmark(r,Editor.checkmarkImage),this.addShortcut(r,o),r}return null},Menus.prototype.addShortcut=function(e,t){if(null!=t.shortcut){var n=e.firstChild.nextSibling.nextSibling,i=document.createElement("span");i.style.color="gray",mxUtils.write(i,t.shortcut),n.appendChild(i)}},Menus.prototype.addMenuItems=function(e,t,n,i,l){for(var s=0;s<t.length;s++)"-"==t[s]?e.addSeparator(n):this.addMenuItem(e,t[s],n,i,null!=l?l[s]:null)},Menus.prototype.createPopupMenu=function(e,t,n){e.smartSeparators=!0,this.addPopupMenuHistoryItems(e,t,n),this.addPopupMenuEditItems(e,t,n),this.addPopupMenuStyleItems(e,t,n),this.addPopupMenuArrangeItems(e,t,n),this.addPopupMenuCellItems(e,t,n),this.addPopupMenuSelectionItems(e,t,n)},Menus.prototype.addPopupMenuHistoryItems=function(e,t,n){this.editorUi.editor.graph.isSelectionEmpty()&&this.addMenuItems(e,["undo","redo"],null,n)},Menus.prototype.addPopupMenuEditItems=function(e,t,n){this.editorUi.editor.graph.isSelectionEmpty()?this.addMenuItems(e,["pasteHere"],null,n):this.addMenuItems(e,["delete","-","cut","copy","-","duplicate"],null,n)},Menus.prototype.addPopupMenuStyleItems=function(e,t,n){1==this.editorUi.editor.graph.getSelectionCount()?this.addMenuItems(e,["-","setAsDefaultStyle"],null,n):this.editorUi.editor.graph.isSelectionEmpty()&&this.addMenuItems(e,["-","clearDefaultStyle"],null,n)},Menus.prototype.addPopupMenuArrangeItems=function(e,t,n){var i=this.editorUi.editor.graph;i.getEditableCells(i.getSelectionCells()).length>0&&(this.addMenuItems(e,["-","toFront","toBack"],null,n),1==i.getSelectionCount()&&this.addMenuItems(e,["bringForward","sendBackward"],null,n)),i.getSelectionCount()>1?this.addMenuItems(e,["-","group"],null,n):1==i.getSelectionCount()&&!i.getModel().isEdge(t)&&!i.isSwimlane(t)&&i.getModel().getChildCount(t)>0&&i.isCellEditable(t)&&this.addMenuItems(e,["-","ungroup"],null,n)},Menus.prototype.addPopupMenuCellItems=function(e,t,n){var i=this.editorUi.editor.graph,l=i.view.getState(t);if(e.addSeparator(),null!=l){var s=!1;if(1==i.getSelectionCount()&&i.getModel().isEdge(t)&&(e.addSeparator(),this.addSubmenu("line",e)),i.getModel().isEdge(t)&&"entityRelationEdgeStyle"!=mxUtils.getValue(l.style,mxConstants.STYLE_EDGE,null)&&"arrow"!=mxUtils.getValue(l.style,mxConstants.STYLE_SHAPE,null)){var o=i.selectionCellsHandler.getHandler(t),r=!1;if(o instanceof mxEdgeHandler&&null!=o.bends&&o.bends.length>2){var u=o.getHandleForEvent(i.updateMouseEvent(new mxMouseEvent(n)));if(u>0&&u<o.bends.length-1&&(null==o.bends[u]||null==o.bends[u].node||""==o.bends[u].node.style.opacity)){var a=this.editorUi.actions.get("removeWaypoint");a.handler=o,a.index=u,r=!0}}e.addSeparator(),this.addMenuItem(e,"turn",null,n,null,mxResources.get("reverse")),this.addMenuItems(e,[r?"removeWaypoint":"addWaypoint"],null,n);var d=i.getModel().getGeometry(t);s=null!=d&&null!=d.points&&d.points.length>0}1==i.getSelectionCount()&&(s||i.getModel().isVertex(t)&&i.getModel().getEdgeCount(t)>0)&&this.addMenuItems(e,["-","clearWaypoints"],null,n),1==i.getSelectionCount()&&i.isCellEditable(t)&&this.addPopupMenuCellEditItems(e,t,n)}},Menus.prototype.addPopupMenuCellEditItems=function(e,t,n,i){var l=this.editorUi.editor.graph.view.getState(t);this.addMenuItems(e,["-","editStyle","editData","editLink"],i,n),this.editorUi.editor.graph.getModel().isVertex(t)&&null!=mxUtils.getValue(l.style,mxConstants.STYLE_IMAGE,null)&&(e.addSeparator(),this.addMenuItem(e,"image",i,n).firstChild.nextSibling.innerHTML=mxResources.get("editImage")+"...")},Menus.prototype.addPopupMenuSelectionItems=function(e,t,n){this.editorUi.editor.graph.isSelectionEmpty()&&this.addMenuItems(e,["-","selectVertices","selectEdges","selectAll"],null,n)},Menus.prototype.createMenubar=function(e){for(var t=new Menubar(this.editorUi,e),n=this.defaultMenuItems,i=0;i<n.length;i++)mxUtils.bind(this,(function(e){var l=t.addMenu(mxResources.get(n[i]),mxUtils.bind(this,(function(){e.funct.apply(this,arguments)})));this.menuCreated(e,l)}))(this.get(n[i]));return t},Menus.prototype.menuCreated=function(e,t,n){null!=t&&(n=null!=n?n:"geItem",e.addListener("stateChanged",(function(){t.enabled=e.enabled,e.enabled?(t.className=n,8==document.documentMode&&(t.style.color="")):(t.className=n+" mxDisabled",8==document.documentMode&&(t.style.color="#c3c3c3"))})))},Menubar.prototype.hideMenu=function(){this.editorUi.hideCurrentMenu()},Menubar.prototype.addMenu=function(e,t,n){var i=document.createElement("a");return i.className="geItem",mxUtils.write(i,e),this.addMenuHandler(i,t),null!=n?this.container.insertBefore(i,n):this.container.appendChild(i),i},Menubar.prototype.addMenuHandler=function(e,t){if(null!=t){var n=!0,i=mxUtils.bind(this,(function(i){if(n&&null==e.enabled||e.enabled){this.editorUi.editor.graph.popupMenuHandler.hideMenu();var l=new mxPopupMenu(t);l.div.className+=" geMenubarMenu",l.smartSeparators=!0,l.showDisabled=!0,l.autoExpand=!0,l.hideMenu=mxUtils.bind(this,(function(){mxPopupMenu.prototype.hideMenu.apply(l,arguments),this.editorUi.resetCurrentMenu(),l.destroy()}));var s=mxUtils.getOffset(e);l.popup(s.x,s.y+e.offsetHeight,null,i),this.editorUi.setCurrentMenu(l,e)}mxEvent.consume(i)}));mxEvent.addListener(e,"mousemove",mxUtils.bind(this,(function(t){null!=this.editorUi.currentMenu&&this.editorUi.currentMenuElt!=e&&(this.editorUi.hideCurrentMenu(),i(t))}))),mxEvent.addListener(e,mxClient.IS_POINTER?"pointerdown":"mousedown",mxUtils.bind(this,(function(t){n=this.currentElt!=e,t.preventDefault()}))),mxEvent.addListener(e,"click",mxUtils.bind(this,(function(e){i(e),n=!0})))}},Menubar.prototype.destroy=function(){},mxUtils.extend(Menu,mxEventSource),Menu.prototype.isEnabled=function(){return this.enabled},Menu.prototype.setEnabled=function(e){this.enabled!=e&&(this.enabled=e,this.fireEvent(new mxEventObject("stateChanged")))},Menu.prototype.execute=function(e,t){this.funct(e,t)},EditorUi.prototype.createMenus=function(){return new Menus(this)};