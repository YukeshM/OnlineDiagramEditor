function Toolbar(e,t){this.editorUi=e,this.container=t,this.staticElements=[],this.init(),this.gestureHandler=mxUtils.bind(this,(function(e){null!=this.editorUi.currentMenu&&mxEvent.getSource(e)!=this.editorUi.currentMenu.div&&this.hideMenu()})),mxEvent.addGestureListeners(document,this.gestureHandler)}Toolbar.prototype.dropDownImage=mxClient.IS_SVG?"data:image/gif;base64,R0lGODlhDQANAIABAHt7e////yH/C1hNUCBEYXRhWE1QPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS4wLWMwNjAgNjEuMTM0Nzc3LCAyMDEwLzAyLzEyLTE3OjMyOjAwICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdFJlZj0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlUmVmIyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDpCREM1NkJFMjE0NEMxMUU1ODk1Q0M5MjQ0MTA4QjNDMSIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDpCREM1NkJFMzE0NEMxMUU1ODk1Q0M5MjQ0MTA4QjNDMSI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkQzOUMzMjZCMTQ0QjExRTU4OTVDQzkyNDQxMDhCM0MxIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOkQzOUMzMjZDMTQ0QjExRTU4OTVDQzkyNDQxMDhCM0MxIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+Af/+/fz7+vn49/b19PPy8fDv7u3s6+rp6Ofm5eTj4uHg397d3Nva2djX1tXU09LR0M/OzczLysnIx8bFxMPCwcC/vr28u7q5uLe2tbSzsrGwr66trKuqqainpqWko6KhoJ+enZybmpmYl5aVlJOSkZCPjo2Mi4qJiIeGhYSDgoGAf359fHt6eXh3dnV0c3JxcG9ubWxramloZ2ZlZGNiYWBfXl1cW1pZWFdWVVRTUlFQT05NTEtKSUhHRkVEQ0JBQD8+PTw7Ojk4NzY1NDMyMTAvLi0sKyopKCcmJSQjIiEgHx4dHBsaGRgXFhUUExIREA8ODQwLCgkIBwYFBAMCAQAAIfkEAQAAAQAsAAAAAA0ADQAAAhGMj6nL3QAjVHIu6azbvPtWAAA7":IMAGE_PATH+"/dropdown.gif",Toolbar.prototype.selectedBackground="#d0d0d0",Toolbar.prototype.unselectedBackground="none",Toolbar.prototype.staticElements=null,Toolbar.prototype.init=function(){var e=screen.width;if((e-=screen.height>740?56:0)>=700){var t=this.addMenu("",mxResources.get("view")+" ("+mxResources.get("panTooltip")+")",!0,"viewPanels",null,!0);this.addDropDownArrow(t,"geSprite-formatpanel",38,50,-4,-3,36,-8),this.addSeparator()}var i,n=this.addMenu("",mxResources.get("zoom")+" (Alt+Mousewheel)",!0,"viewZoom",null,!0);n.showDisabled=!0,n.style.whiteSpace="nowrap",n.style.position="relative",n.style.overflow="hidden",EditorUi.compactUi?n.style.width="50px":n.style.width="36px",e>=420&&(this.addSeparator(),(i=this.addItems(["zoomIn","zoomOut"]))[0].setAttribute("title",mxResources.get("zoomIn")+" ("+this.editorUi.actions.get("zoomIn").shortcut+")"),i[1].setAttribute("title",mxResources.get("zoomOut")+" ("+this.editorUi.actions.get("zoomOut").shortcut+")")),this.updateZoom=mxUtils.bind(this,(function(){n.innerHTML=Math.round(100*this.editorUi.editor.graph.view.scale)+"%",this.appendDropDownImageHtml(n),EditorUi.compactUi&&(n.getElementsByTagName("img")[0].style.right="1px",n.getElementsByTagName("img")[0].style.top="5px")})),this.editorUi.editor.graph.view.addListener(mxEvent.EVENT_SCALE,this.updateZoom),this.editorUi.editor.addListener("resetGraphView",this.updateZoom),(i=this.addItems(["-","undo","redo"]))[1].setAttribute("title",mxResources.get("undo")+" ("+this.editorUi.actions.get("undo").shortcut+")"),i[2].setAttribute("title",mxResources.get("redo")+" ("+this.editorUi.actions.get("redo").shortcut+")"),e>=320&&(i=this.addItems(["-","delete"]))[1].setAttribute("title",mxResources.get("delete")+" ("+this.editorUi.actions.get("delete").shortcut+")"),e>=550&&this.addItems(["-","toFront","toBack"]),e>=740&&(this.addItems(["-","fillColor"]),e>=780&&(this.addItems(["strokeColor"]),e>=820&&this.addItems(["shadow"]))),e>=400&&(this.addSeparator(),e>=440&&(this.edgeShapeMenu=this.addMenuFunction("",mxResources.get("connection"),!1,mxUtils.bind(this,(function(e){this.editorUi.menus.edgeStyleChange(e,"",[mxConstants.STYLE_SHAPE,"width"],[null,null],"geIcon geSprite geSprite-connection",null,!0).setAttribute("title",mxResources.get("line")),this.editorUi.menus.edgeStyleChange(e,"",[mxConstants.STYLE_SHAPE,"width"],["link",null],"geIcon geSprite geSprite-linkedge",null,!0).setAttribute("title",mxResources.get("link")),this.editorUi.menus.edgeStyleChange(e,"",[mxConstants.STYLE_SHAPE,"width"],["flexArrow",null],"geIcon geSprite geSprite-arrow",null,!0).setAttribute("title",mxResources.get("arrow")),this.editorUi.menus.edgeStyleChange(e,"",[mxConstants.STYLE_SHAPE,"width"],["arrow",null],"geIcon geSprite geSprite-simplearrow",null,!0).setAttribute("title",mxResources.get("simpleArrow"))}))),this.addDropDownArrow(this.edgeShapeMenu,"geSprite-connection",44,50,0,0,22,-4)),this.edgeStyleMenu=this.addMenuFunction("geSprite-orthogonal",mxResources.get("waypoints"),!1,mxUtils.bind(this,(function(e){this.editorUi.menus.edgeStyleChange(e,"",[mxConstants.STYLE_EDGE,mxConstants.STYLE_CURVED,mxConstants.STYLE_NOEDGESTYLE],[null,null,null],"geIcon geSprite geSprite-straight",null,!0).setAttribute("title",mxResources.get("straight")),this.editorUi.menus.edgeStyleChange(e,"",[mxConstants.STYLE_EDGE,mxConstants.STYLE_CURVED,mxConstants.STYLE_NOEDGESTYLE],["orthogonalEdgeStyle",null,null],"geIcon geSprite geSprite-orthogonal",null,!0).setAttribute("title",mxResources.get("orthogonal")),this.editorUi.menus.edgeStyleChange(e,"",[mxConstants.STYLE_EDGE,mxConstants.STYLE_ELBOW,mxConstants.STYLE_CURVED,mxConstants.STYLE_NOEDGESTYLE],["elbowEdgeStyle",null,null,null],"geIcon geSprite geSprite-horizontalelbow",null,!0).setAttribute("title",mxResources.get("simple")),this.editorUi.menus.edgeStyleChange(e,"",[mxConstants.STYLE_EDGE,mxConstants.STYLE_ELBOW,mxConstants.STYLE_CURVED,mxConstants.STYLE_NOEDGESTYLE],["elbowEdgeStyle","vertical",null,null],"geIcon geSprite geSprite-verticalelbow",null,!0).setAttribute("title",mxResources.get("simple")),this.editorUi.menus.edgeStyleChange(e,"",[mxConstants.STYLE_EDGE,mxConstants.STYLE_ELBOW,mxConstants.STYLE_CURVED,mxConstants.STYLE_NOEDGESTYLE],["isometricEdgeStyle",null,null,null],"geIcon geSprite geSprite-horizontalisometric",null,!0).setAttribute("title",mxResources.get("isometric")),this.editorUi.menus.edgeStyleChange(e,"",[mxConstants.STYLE_EDGE,mxConstants.STYLE_ELBOW,mxConstants.STYLE_CURVED,mxConstants.STYLE_NOEDGESTYLE],["isometricEdgeStyle","vertical",null,null],"geIcon geSprite geSprite-verticalisometric",null,!0).setAttribute("title",mxResources.get("isometric")),this.editorUi.menus.edgeStyleChange(e,"",[mxConstants.STYLE_EDGE,mxConstants.STYLE_CURVED,mxConstants.STYLE_NOEDGESTYLE],["orthogonalEdgeStyle","1",null],"geIcon geSprite geSprite-curved",null,!0).setAttribute("title",mxResources.get("curved")),this.editorUi.menus.edgeStyleChange(e,"",[mxConstants.STYLE_EDGE,mxConstants.STYLE_CURVED,mxConstants.STYLE_NOEDGESTYLE],["entityRelationEdgeStyle",null,null],"geIcon geSprite geSprite-entity",null,!0).setAttribute("title",mxResources.get("entityRelation"))}))),this.addDropDownArrow(this.edgeStyleMenu,"geSprite-orthogonal",44,50,0,0,22,-4)),this.addSeparator();var o=this.addMenu("",mxResources.get("insert")+" ("+mxResources.get("doubleClickTooltip")+")",!0,"insert",null,!0);this.addDropDownArrow(o,"geSprite-plus",38,48,-4,-3,36,-8),this.addSeparator(),this.addTableDropDown()},Toolbar.prototype.appendDropDownImageHtml=function(e){var t=document.createElement("img");t.setAttribute("border","0"),t.setAttribute("valign","middle"),t.setAttribute("src",Toolbar.prototype.dropDownImage),e.appendChild(t),t.style.position="absolute",t.style.right="4px",t.style.top=(EditorUi.compactUi?6:8)+"px"},Toolbar.prototype.addTableDropDown=function(){var e=this.addMenuFunction("geIcon geSprite geSprite-table",mxResources.get("table"),!1,mxUtils.bind(this,(function(e){this.editorUi.menus.addInsertTableCellItem(e)})));e.style.position="relative",e.style.whiteSpace="nowrap",e.style.overflow="hidden",e.style.width="30px",e.innerHTML='<div class="geSprite geSprite-table"></div>',this.appendDropDownImageHtml(e),e.getElementsByTagName("div")[0].style.marginLeft="-2px",EditorUi.compactUi&&(e.getElementsByTagName("img")[0].style.left="22px",e.getElementsByTagName("img")[0].style.top="5px");var t=this.editorUi.menus.get("insert");return null!=t&&"function"==typeof e.setEnabled&&t.addListener("stateChanged",(function(){e.setEnabled(t.enabled)})),e},Toolbar.prototype.addDropDownArrow=function(e,t,i,n,o,s,l,r){l=null!=l?l:32,o=EditorUi.compactUi?o:r,e.style.whiteSpace="nowrap",e.style.overflow="hidden",e.style.position="relative",e.style.width=n-l+"px",e.innerHTML='<div class="geSprite '+t+'"></div>',this.appendDropDownImageHtml(e);var d=e.getElementsByTagName("div")[0];d.style.marginLeft=o+"px",d.style.marginTop=s+"px",EditorUi.compactUi&&(e.getElementsByTagName("img")[0].style.left="24px",e.getElementsByTagName("img")[0].style.top="5px",e.style.width=i-10+"px")},Toolbar.prototype.setFontName=function(e){if(null!=this.fontMenu){this.fontMenu.innerHTML="";var t=document.createElement("div");t.style.display="inline-block",t.style.overflow="hidden",t.style.textOverflow="ellipsis",t.style.maxWidth="66px",mxUtils.write(t,e),this.fontMenu.appendChild(t),this.appendDropDownImageHtml(this.fontMenu)}},Toolbar.prototype.setFontSize=function(e){if(null!=this.sizeMenu){this.sizeMenu.innerHTML="";var t=document.createElement("div");t.style.display="inline-block",t.style.overflow="hidden",t.style.textOverflow="ellipsis",t.style.maxWidth="24px",mxUtils.write(t,e),this.sizeMenu.appendChild(t),this.appendDropDownImageHtml(this.sizeMenu)}},Toolbar.prototype.createTextToolbar=function(){var e=this.editorUi,t=e.editor.graph,i=this.addMenu("",mxResources.get("style"),!0,"formatBlock");i.style.position="relative",i.style.whiteSpace="nowrap",i.style.overflow="hidden",i.innerHTML=mxResources.get("style"),this.appendDropDownImageHtml(i),EditorUi.compactUi&&(i.style.paddingRight="18px",i.getElementsByTagName("img")[0].style.right="1px",i.getElementsByTagName("img")[0].style.top="5px"),this.addSeparator(),this.fontMenu=this.addMenu("",mxResources.get("fontFamily"),!0,"fontFamily"),this.fontMenu.style.position="relative",this.fontMenu.style.whiteSpace="nowrap",this.fontMenu.style.overflow="hidden",this.fontMenu.style.width="68px",this.setFontName(Menus.prototype.defaultFont),EditorUi.compactUi&&(this.fontMenu.style.paddingRight="18px",this.fontMenu.getElementsByTagName("img")[0].style.right="1px",this.fontMenu.getElementsByTagName("img")[0].style.top="5px"),this.addSeparator(),this.sizeMenu=this.addMenu(Menus.prototype.defaultFontSize,mxResources.get("fontSize"),!0,"fontSize"),this.sizeMenu.style.position="relative",this.sizeMenu.style.whiteSpace="nowrap",this.sizeMenu.style.overflow="hidden",this.sizeMenu.style.width="24px",this.setFontSize(Menus.prototype.defaultFontSize),EditorUi.compactUi&&(this.sizeMenu.style.paddingRight="18px",this.sizeMenu.getElementsByTagName("img")[0].style.right="1px",this.sizeMenu.getElementsByTagName("img")[0].style.top="5px");var n=this.addItems(["-","undo","redo","-","bold","italic","underline"]);n[1].setAttribute("title",mxResources.get("undo")+" ("+e.actions.get("undo").shortcut+")"),n[2].setAttribute("title",mxResources.get("redo")+" ("+e.actions.get("redo").shortcut+")"),n[4].setAttribute("title",mxResources.get("bold")+" ("+e.actions.get("bold").shortcut+")"),n[5].setAttribute("title",mxResources.get("italic")+" ("+e.actions.get("italic").shortcut+")"),n[6].setAttribute("title",mxResources.get("underline")+" ("+e.actions.get("underline").shortcut+")");var o=this.addMenuFunction("",mxResources.get("align"),!1,mxUtils.bind(this,(function(i){(d=i.addItem("",null,mxUtils.bind(this,(function(i){t.cellEditor.alignText(mxConstants.ALIGN_LEFT,i),e.fireEvent(new mxEventObject("styleChanged","keys",[mxConstants.STYLE_ALIGN],"values",[mxConstants.ALIGN_LEFT],"cells",[t.cellEditor.getEditingCell()]))})),null,"geIcon geSprite geSprite-left")).setAttribute("title",mxResources.get("left")),(d=i.addItem("",null,mxUtils.bind(this,(function(i){t.cellEditor.alignText(mxConstants.ALIGN_CENTER,i),e.fireEvent(new mxEventObject("styleChanged","keys",[mxConstants.STYLE_ALIGN],"values",[mxConstants.ALIGN_CENTER],"cells",[t.cellEditor.getEditingCell()]))})),null,"geIcon geSprite geSprite-center")).setAttribute("title",mxResources.get("center")),(d=i.addItem("",null,mxUtils.bind(this,(function(i){t.cellEditor.alignText(mxConstants.ALIGN_RIGHT,i),e.fireEvent(new mxEventObject("styleChanged","keys",[mxConstants.STYLE_ALIGN],"values",[mxConstants.ALIGN_RIGHT],"cells",[t.cellEditor.getEditingCell()]))})),null,"geIcon geSprite geSprite-right")).setAttribute("title",mxResources.get("right")),(d=i.addItem("",null,mxUtils.bind(this,(function(){document.execCommand("justifyfull",!1,null)})),null,"geIcon geSprite geSprite-justifyfull")).setAttribute("title",mxResources.get("justifyfull")),(d=i.addItem("",null,mxUtils.bind(this,(function(){document.execCommand("insertorderedlist",!1,null)})),null,"geIcon geSprite geSprite-orderedlist")).setAttribute("title",mxResources.get("numberedList")),(d=i.addItem("",null,mxUtils.bind(this,(function(){document.execCommand("insertunorderedlist",!1,null)})),null,"geIcon geSprite geSprite-unorderedlist")).setAttribute("title",mxResources.get("bulletedList")),(d=i.addItem("",null,mxUtils.bind(this,(function(){document.execCommand("outdent",!1,null)})),null,"geIcon geSprite geSprite-outdent")).setAttribute("title",mxResources.get("decreaseIndent")),(d=i.addItem("",null,mxUtils.bind(this,(function(){document.execCommand("indent",!1,null)})),null,"geIcon geSprite geSprite-indent")).setAttribute("title",mxResources.get("increaseIndent"))})));o.style.position="relative",o.style.whiteSpace="nowrap",o.style.overflow="hidden",o.style.width="30px",o.innerHTML="",(r=document.createElement("div")).className="geSprite geSprite-left",r.style.marginLeft="-2px",o.appendChild(r),this.appendDropDownImageHtml(o),EditorUi.compactUi&&(o.getElementsByTagName("img")[0].style.left="22px",o.getElementsByTagName("img")[0].style.top="5px");var s=this.addMenuFunction("",mxResources.get("format"),!1,mxUtils.bind(this,(function(e){(d=e.addItem("",null,this.editorUi.actions.get("subscript").funct,null,"geIcon geSprite geSprite-subscript")).setAttribute("title",mxResources.get("subscript")+" ("+Editor.ctrlKey+"+,)"),(d=e.addItem("",null,this.editorUi.actions.get("superscript").funct,null,"geIcon geSprite geSprite-superscript")).setAttribute("title",mxResources.get("superscript")+" ("+Editor.ctrlKey+"+.)"),(d=e.addItem("",null,this.editorUi.actions.get("fontColor").funct,null,"geIcon geSprite geSprite-fontcolor")).setAttribute("title",mxResources.get("fontColor")),(d=e.addItem("",null,this.editorUi.actions.get("backgroundColor").funct,null,"geIcon geSprite geSprite-fontbackground")).setAttribute("title",mxResources.get("backgroundColor")),(d=e.addItem("",null,mxUtils.bind(this,(function(){document.execCommand("removeformat",!1,null)})),null,"geIcon geSprite geSprite-removeformat")).setAttribute("title",mxResources.get("removeFormat"))})));s.style.position="relative",s.style.whiteSpace="nowrap",s.style.overflow="hidden",s.style.width="30px",s.innerHTML="",(r=document.createElement("div")).className="geSprite geSprite-dots",r.style.marginLeft="-2px",s.appendChild(r),this.appendDropDownImageHtml(s),EditorUi.compactUi&&(s.getElementsByTagName("img")[0].style.left="22px",s.getElementsByTagName("img")[0].style.top="5px"),this.addSeparator(),this.addButton("geIcon geSprite geSprite-code",mxResources.get("html"),(function(){t.cellEditor.toggleViewMode(),t.cellEditor.textarea.innerHTML.length>0&&("&nbsp;"!=t.cellEditor.textarea.innerHTML||!t.cellEditor.clearOnChange)&&window.setTimeout((function(){document.execCommand("selectAll",!1,null)}))})),this.addSeparator();var l=this.addMenuFunction("",mxResources.get("insert"),!0,mxUtils.bind(this,(function(e){e.addItem(mxResources.get("insertLink"),null,mxUtils.bind(this,(function(){this.editorUi.actions.get("link").funct()}))),e.addItem(mxResources.get("insertImage"),null,mxUtils.bind(this,(function(){this.editorUi.actions.get("image").funct()}))),e.addItem(mxResources.get("insertHorizontalRule"),null,mxUtils.bind(this,(function(){document.execCommand("inserthorizontalrule",!1,null)})))})));l.style.whiteSpace="nowrap",l.style.overflow="hidden",l.style.position="relative",l.style.width="16px",l.innerHTML="",(r=document.createElement("div")).className="geSprite geSprite-plus",r.style.marginLeft="-4px",r.style.marginTop="-3px",l.appendChild(r),this.appendDropDownImageHtml(l),EditorUi.compactUi&&(l.getElementsByTagName("img")[0].style.left="24px",l.getElementsByTagName("img")[0].style.top="5px",l.style.width="30px"),this.addSeparator();var r,d=this.addMenuFunction("geIcon geSprite geSprite-table",mxResources.get("table"),!1,mxUtils.bind(this,(function(e){var i=t.getSelectedElement(),n=t.getParentByNames(i,["TD","TH"],t.cellEditor.text2),o=t.getParentByName(i,"TR",t.cellEditor.text2);if(null==o)this.editorUi.menus.addInsertTableItem(e);else{var s=t.getParentByName(o,"TABLE",t.cellEditor.text2);(i=e.addItem("",null,mxUtils.bind(this,(function(){try{t.selectNode(t.insertColumn(s,null!=n?n.cellIndex:0))}catch(e){this.editorUi.handleError(e)}})),null,"geIcon geSprite geSprite-insertcolumnbefore")).setAttribute("title",mxResources.get("insertColumnBefore")),(i=e.addItem("",null,mxUtils.bind(this,(function(){try{t.selectNode(t.insertColumn(s,null!=n?n.cellIndex+1:-1))}catch(e){this.editorUi.handleError(e)}})),null,"geIcon geSprite geSprite-insertcolumnafter")).setAttribute("title",mxResources.get("insertColumnAfter")),(i=e.addItem("Delete column",null,mxUtils.bind(this,(function(){if(null!=n)try{t.deleteColumn(s,n.cellIndex)}catch(e){this.editorUi.handleError(e)}})),null,"geIcon geSprite geSprite-deletecolumn")).setAttribute("title",mxResources.get("deleteColumn")),(i=e.addItem("",null,mxUtils.bind(this,(function(){try{t.selectNode(t.insertRow(s,o.sectionRowIndex))}catch(e){this.editorUi.handleError(e)}})),null,"geIcon geSprite geSprite-insertrowbefore")).setAttribute("title",mxResources.get("insertRowBefore")),(i=e.addItem("",null,mxUtils.bind(this,(function(){try{t.selectNode(t.insertRow(s,o.sectionRowIndex+1))}catch(e){this.editorUi.handleError(e)}})),null,"geIcon geSprite geSprite-insertrowafter")).setAttribute("title",mxResources.get("insertRowAfter")),(i=e.addItem("",null,mxUtils.bind(this,(function(){try{t.deleteRow(s,o.sectionRowIndex)}catch(e){this.editorUi.handleError(e)}})),null,"geIcon geSprite geSprite-deleterow")).setAttribute("title",mxResources.get("deleteRow")),(i=e.addItem("",null,mxUtils.bind(this,(function(){var e=s.style.borderColor.replace(/\brgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/g,(function(e,t,i,n){return"#"+("0"+Number(t).toString(16)).substr(-2)+("0"+Number(i).toString(16)).substr(-2)+("0"+Number(n).toString(16)).substr(-2)}));this.editorUi.pickColor(e,(function(e){null==e||e==mxConstants.NONE?(s.removeAttribute("border"),s.style.border="",s.style.borderCollapse=""):(s.setAttribute("border","1"),s.style.border="1px solid "+e,s.style.borderCollapse="collapse")}))})),null,"geIcon geSprite geSprite-strokecolor")).setAttribute("title",mxResources.get("borderColor")),(i=e.addItem("",null,mxUtils.bind(this,(function(){var e=s.style.backgroundColor.replace(/\brgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/g,(function(e,t,i,n){return"#"+("0"+Number(t).toString(16)).substr(-2)+("0"+Number(i).toString(16)).substr(-2)+("0"+Number(n).toString(16)).substr(-2)}));this.editorUi.pickColor(e,(function(e){null==e||e==mxConstants.NONE?s.style.backgroundColor="":s.style.backgroundColor=e}))})),null,"geIcon geSprite geSprite-fillcolor")).setAttribute("title",mxResources.get("backgroundColor")),(i=e.addItem("",null,mxUtils.bind(this,(function(){var e=s.getAttribute("cellPadding")||0,t=new FilenameDialog(this.editorUi,e,mxResources.get("apply"),mxUtils.bind(this,(function(e){null!=e&&e.length>0?s.setAttribute("cellPadding",e):s.removeAttribute("cellPadding")})),mxResources.get("spacing"));this.editorUi.showDialog(t.container,300,80,!0,!0),t.init()})),null,"geIcon geSprite geSprite-fit")).setAttribute("title",mxResources.get("spacing")),(i=e.addItem("",null,mxUtils.bind(this,(function(){s.setAttribute("align","left")})),null,"geIcon geSprite geSprite-left")).setAttribute("title",mxResources.get("left")),(i=e.addItem("",null,mxUtils.bind(this,(function(){s.setAttribute("align","center")})),null,"geIcon geSprite geSprite-center")).setAttribute("title",mxResources.get("center")),(i=e.addItem("",null,mxUtils.bind(this,(function(){s.setAttribute("align","right")})),null,"geIcon geSprite geSprite-right")).setAttribute("title",mxResources.get("right"))}})));d.style.position="relative",d.style.whiteSpace="nowrap",d.style.overflow="hidden",d.style.width="30px",d.innerHTML="",(r=document.createElement("div")).className="geSprite geSprite-table",r.style.marginLeft="-2px",d.appendChild(r),this.appendDropDownImageHtml(d),EditorUi.compactUi&&(d.getElementsByTagName("img")[0].style.left="22px",d.getElementsByTagName("img")[0].style.top="5px")},Toolbar.prototype.hideMenu=function(){this.editorUi.hideCurrentMenu()},Toolbar.prototype.addMenu=function(e,t,i,n,o,s,l){var r=this.editorUi.menus.get(n),d=this.addMenuFunction(e,t,i,(function(){r.funct.apply(r,arguments)}),o,s);return l||"function"!=typeof d.setEnabled||r.addListener("stateChanged",(function(){d.setEnabled(r.enabled)})),d},Toolbar.prototype.addMenuFunction=function(e,t,i,n,o,s){return this.addMenuFunctionInContainer(null!=o?o:this.container,e,t,i,n,s)},Toolbar.prototype.addMenuFunctionInContainer=function(e,t,i,n,o,s){var l=n?this.createLabel(t):this.createButton(t);return this.initElement(l,i),this.addMenuHandler(l,n,o,s),e.appendChild(l),l},Toolbar.prototype.addSeparator=function(e){e=null!=e?e:this.container;var t=document.createElement("div");return t.className="geSeparator",e.appendChild(t),t},Toolbar.prototype.addItems=function(e,t,i){for(var n=[],o=0;o<e.length;o++){var s=e[o];"-"==s?n.push(this.addSeparator(t)):n.push(this.addItem("geSprite-"+s.toLowerCase(),s,t,i))}return n},Toolbar.prototype.addItem=function(e,t,i,n){var o=this.editorUi.actions.get(t),s=null;if(null!=o){var l=o.label;null!=o.shortcut&&(l+=" ("+o.shortcut+")"),s=this.addButton(e,l,o.funct,i),n||"function"!=typeof s.setEnabled||(s.setEnabled(o.enabled),o.addListener("stateChanged",(function(){s.setEnabled(o.enabled)})))}return s},Toolbar.prototype.addButton=function(e,t,i,n){var o=this.createButton(e);return n=null!=n?n:this.container,this.initElement(o,t),this.addClickHandler(o,i),n.appendChild(o),o},Toolbar.prototype.initElement=function(e,t){null!=t&&e.setAttribute("title",t),this.addEnabledState(e)},Toolbar.prototype.addEnabledState=function(e){var t=e.className;e.setEnabled=function(i){e.enabled=i,e.className=i?t:t+" mxDisabled"},e.setEnabled(!0)},Toolbar.prototype.addClickHandler=function(e,t){null!=t&&(mxEvent.addListener(e,"click",(function(i){e.enabled&&t(i),mxEvent.consume(i)})),mxEvent.addListener(e,mxClient.IS_POINTER?"pointerdown":"mousedown",mxUtils.bind(this,(function(e){e.preventDefault()}))))},Toolbar.prototype.createButton=function(e){var t=document.createElement("a");t.className="geButton";var i=document.createElement("div");return null!=e&&(i.className="geSprite "+e),t.appendChild(i),t},Toolbar.prototype.createLabel=function(e,t){var i=document.createElement("a");return i.className="geLabel",mxUtils.write(i,e),i},Toolbar.prototype.addMenuHandler=function(e,t,i,n){if(null!=i){var o=this.editorUi.editor.graph,s=null,l=!0;mxEvent.addListener(e,"click",mxUtils.bind(this,(function(r){if(l&&(null==e.enabled||e.enabled)){o.popupMenuHandler.hideMenu(),(s=new mxPopupMenu(i)).div.className+=" geToolbarMenu",s.showDisabled=n,s.labels=t,s.autoExpand=!0;var d=mxUtils.getOffset(e);s.popup(d.x,d.y+e.offsetHeight,null,r),this.editorUi.setCurrentMenu(s,e),!t&&s.div.scrollHeight>s.div.clientHeight&&(s.div.style.width="40px"),s.hideMenu=mxUtils.bind(this,(function(){mxPopupMenu.prototype.hideMenu.apply(s,arguments),this.editorUi.resetCurrentMenu(),s.destroy()})),s.addListener(mxEvent.EVENT_HIDE,mxUtils.bind(this,(function(){this.currentElt=null})))}l=!0,mxEvent.consume(r)}))),mxEvent.addListener(e,mxClient.IS_POINTER?"pointerdown":"mousedown",mxUtils.bind(this,(function(t){l=this.currentElt!=e,t.preventDefault()})))}},Toolbar.prototype.destroy=function(){null!=this.gestureHandler&&(mxEvent.removeGestureListeners(document,this.gestureHandler),this.gestureHandler=null)};